var fairygui;!function(t){var e=function(e){function s(){e.call(this),this._selectedIndex=0,this._previousIndex=0,this._pageIds=[],this._pageNames=[],this._selectedIndex=-1,this._previousIndex=-1}__extends(s,e);var n=__define,r=s,a=r.prototype;return n(a,"name",function(){return this._name},function(t){this._name=t}),n(a,"parent",function(){return this._parent}),n(a,"selectedIndex",function(){return this._selectedIndex},function(e){if(this._selectedIndex!=e){if(e>this._pageIds.length-1)throw"index out of bounds: "+e;if(this._previousIndex=this._selectedIndex,this._selectedIndex=e,this._parent.applyController(this),this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED)),this._playingTransition&&(this._playingTransition.stop(),this._playingTransition=null),this._pageTransitions){for(var i=this._pageTransitions.length,s=0;i>s;s++){var n=this._pageTransitions[s];if(n.toIndex==this._selectedIndex&&(-1==n.fromIndex||n.fromIndex==this._previousIndex)){this._playingTransition=this.parent.getTransition(n.transitionName);break}}this._playingTransition&&this._playingTransition.play(function(){this._playingTransition=null},this)}}}),a.setSelectedIndex=function(t){if(void 0===t&&(t=0),this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this._previousIndex=this._selectedIndex,this._selectedIndex=t,this._parent.applyController(this),this._playingTransition&&(this._playingTransition.stop(),this._playingTransition=null)}},n(a,"previsousIndex",function(){return this._previousIndex}),n(a,"selectedPage",function(){return-1==this._selectedIndex?null:this._pageNames[this._selectedIndex]},function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.selectedIndex=e}),a.setSelectedPage=function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.setSelectedIndex(e)},n(a,"previousPage",function(){return-1==this._previousIndex?null:this._pageNames[this._previousIndex]}),n(a,"pageCount",function(){return this._pageIds.length}),a.getPageName=function(t){return void 0===t&&(t=0),this._pageNames[t]},a.addPage=function(t){void 0===t&&(t=""),this.addPageAt(t,this._pageIds.length)},a.addPageAt=function(t,e){void 0===e&&(e=0);var i=""+s._nextPageId++;e==this._pageIds.length?(this._pageIds.push(i),this._pageNames.push(t)):(this._pageIds.splice(e,0,i),this._pageNames.splice(e,0,t))},a.removePage=function(t){var e=this._pageNames.indexOf(t);-1!=e&&(this._pageIds.splice(e,1),this._pageNames.splice(e,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this._parent.applyController(this))},a.removePageAt=function(t){void 0===t&&(t=0),this._pageIds.splice(t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this._parent.applyController(this)},a.clearPages=function(){this._pageIds.length=0,this._pageNames.length=0,-1!=this._selectedIndex?this.selectedIndex=-1:this._parent.applyController(this)},a.hasPage=function(t){return-1!=this._pageNames.indexOf(t)},a.getPageIndexById=function(t){return this._pageIds.indexOf(t)},a.getPageIdByName=function(t){var e=this._pageNames.indexOf(t);return-1!=e?this._pageIds[e]:null},a.getPageNameById=function(t){var e=this._pageIds.indexOf(t);return-1!=e?this._pageNames[e]:null},a.getPageId=function(t){return void 0===t&&(t=0),this._pageIds[t]},n(a,"selectedPageId",function(){return-1==this._selectedIndex?null:this._pageIds[this._selectedIndex]},function(t){var e=this._pageIds.indexOf(t);this.selectedIndex=e}),n(a,"oppositePageId",void 0,function(t){var e=this._pageIds.indexOf(t);e>0?this.selectedIndex=0:this._pageIds.length>1&&(this.selectedIndex=1)}),n(a,"previousPageId",function(){return-1==this._previousIndex?null:this._pageIds[this._previousIndex]}),a.setup=function(t){this._name=t.attributes.name,this._autoRadioGroupDepth="true"==t.attributes.autoRadioGroupDepth;var e=0,s=0,n=t.attributes.pages;if(n){var r=n.split(","),a=r.length;for(e=0;a>e;e+=2)this._pageIds.push(r[e]),this._pageNames.push(r[e+1])}if(n=t.attributes.transitions)for(this._pageTransitions=new Array,r=n.split(","),a=r.length,e=0;a>e;e++)if(n=r[e]){var h=new i;s=n.indexOf("="),h.transitionName=n.substr(s+1),n=n.substring(0,s),s=n.indexOf("-"),h.toIndex=parseInt(n.substring(s+1)),n=n.substring(0,s),"*"==n?h.fromIndex=-1:h.fromIndex=parseInt(n),this._pageTransitions.push(h)}this._parent&&this._pageIds.length>0?this._selectedIndex=0:this._selectedIndex=-1},s._nextPageId=0,s}(egret.EventDispatcher);t.Controller=e,egret.registerClass(e,"fairygui.Controller");var i=function(){function t(){this.fromIndex=0,this.toIndex=0}var e=(__define,t);e.prototype;return t}();egret.registerClass(i,"PageTransition")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){this.addDelay=0,this.rect=new egret.Rectangle}var e=(__define,t);e.prototype;return t}();t.Frame=e,egret.registerClass(e,"fairygui.Frame")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this.interval=0,this.repeatDelay=0,this._frameCount=0,this._currentFrame=0,this._start=0,this._end=0,this._times=0,this._endAt=0,this._status=0,this.$renderNode=new egret.sys.BitmapNode,this.playState=new t.PlayState,this._playing=!0,this.touchEnabled=!1,this.setPlaySettings()}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"frames",function(){return this._frames},function(t){this._frames=t,null!=this._frames?this._frameCount=this._frames.length:this._frameCount=0,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),(-1==this._endAt||this._endAt>this._frameCount-1)&&(this._endAt=this._frameCount-1),(this._currentFrame<0||this._currentFrame>this._frameCount-1)&&(this._currentFrame=this._frameCount-1),this._frameCount>0?this.setFrame(this._frames[this._currentFrame]):this.setFrame(null),this.playState.rewind()}),s(r,"frameCount",function(){return this._frameCount}),s(r,"boundsRect",function(){return this._boundsRect},function(t){this._boundsRect=t}),s(r,"currentFrame",function(){return this._currentFrame},function(t){this._currentFrame!=t&&(this._currentFrame=t,this.playState.currentFrame=t,this.setFrame(this._currentFrame<this._frameCount?this._frames[this._currentFrame]:null))}),s(r,"playing",function(){return this._playing},function(e){this._playing=e,e&&null!=this.stage?t.GTimers.inst.add(0,0,this.update,this):t.GTimers.inst.remove(this.update,this)}),r.setPlaySettings=function(t,e,i,s,n,r){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=-1),void 0===n&&(n=null),void 0===r&&(r=null),this._start=t,this._end=e,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),this._times=i,this._endAt=s,-1==this._endAt&&(this._endAt=this._end),this._status=0,this._callback=n,this._callbackObj=r,this.currentFrame=t},r.update=function(){this._playing&&0!=this._frameCount&&3!=this._status&&(this.playState.update(this),this._currentFrame!=this.playState.currentFrame&&(1==this._status?(this._currentFrame=this._start,this.playState.currentFrame=this._currentFrame,this._status=0):2==this._status?(this._currentFrame=this._endAt,this.playState.currentFrame=this._currentFrame,this._status=3,null!=this._callback&&t.GTimers.inst.callLater(this.__playEnd,this)):(this._currentFrame=this.playState.currentFrame,this._currentFrame==this._end&&this._times>0&&(this._times--,0==this._times?this._status=2:this._status=1)),this.setFrame(this._frames[this._currentFrame])))},r.__playEnd=function(){if(null!=this._callback){var t=this._callback,e=this._callbackObj;this._callback=null,this._callbackObj=null,1==t.length?t.call(e,this):t.call(e)}},r.setFrame=function(t){null==t?this._texture=null:(this._texture=t.texture,this._frameRect=t.rect),this.$invalidateContentBounds()},r.$render=function(){var t=this._texture;if(t){var e=Math.round(t._offsetX)+this._frameRect.x,i=Math.round(t._offsetY)+this._frameRect.y,s=t._bitmapWidth,n=t._bitmapHeight,r=t.$getTextureWidth(),a=t.$getTextureHeight(),h=Math.round(t.$getScaleBitmapWidth()),o=Math.round(t.$getScaleBitmapHeight()),l=t._sourceWidth,_=t._sourceHeight;egret.sys.BitmapNode.$updateTextureData(this.$renderNode,t._bitmapData,t._bitmapX,t._bitmapY,s,n,e,i,r,a,h,o,l,_,null,egret.BitmapFillMode.SCALE,!0)}},r.$measureContentBounds=function(t){if(this._texture){var e=Math.round(this._texture._offsetX)+this._frameRect.x,i=Math.round(this._texture._offsetY)+this._frameRect.y,s=this._texture.$getTextureWidth(),n=this._texture.$getTextureHeight();t.setTo(e,i,s,n)}else t.setEmpty()},r.$onAddToStage=function(i,s){e.prototype.$onAddToStage.call(this,i,s),this._playing&&t.GTimers.inst.add(0,0,this.update,this)},r.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this._playing&&t.GTimers.inst.remove(this.update,this)},i}(egret.DisplayObject);t.MovieClip=e,egret.registerClass(e,"fairygui.MovieClip")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){this.repeatedCount=0,this._curFrame=0,this._lastTime=0,this._curFrameDelay=0,this._lastTime=egret.getTimer()}var e=__define,i=t,s=i.prototype;return s.update=function(t){var e=egret.getTimer(),i=e-this._lastTime;this._lastTime=e;var s=this._curFrame;s>=t.frameCount&&(s=t.frameCount-1),this.reachEnding=!1,this._curFrameDelay+=i;var n=t.interval+t.frames[s].addDelay+(0==s&&this.repeatedCount>0?t.repeatDelay:0);this._curFrameDelay<n||(this._curFrameDelay-=n,this._curFrameDelay>t.interval&&(this._curFrameDelay=t.interval),t.swing?this.reversed?(this._curFrame--,this._curFrame<0&&(this._curFrame=Math.min(1,t.frameCount-1),this.repeatedCount++,this.reversed=!this.reversed)):(this._curFrame++,this._curFrame>t.frameCount-1&&(this._curFrame=Math.max(0,t.frameCount-2),this.repeatedCount++,this.reachEnding=!0,this.reversed=!this.reversed)):(this._curFrame++,this._curFrame>t.frameCount-1&&(this._curFrame=0,this.repeatedCount++,this.reachEnding=!0)))},e(s,"currentFrame",function(){return this._curFrame},function(t){this._curFrame=t,this._curFrameDelay=0}),s.rewind=function(){this._curFrame=0,this._curFrameDelay=0,this.reversed=!1,this.reachEnding=!1},s.reset=function(){this._curFrame=0,this._curFrameDelay=0,this.repeatedCount=0,this.reachEnding=!1,this.reversed=!1},s.copy=function(t){this._curFrame=t._curFrame,this._curFrameDelay=t._curFrameDelay,this.repeatedCount=t.repeatedCount,this.reachEnding=t.reachEnding,this.reversed=t.reversed},t}();t.PlayState=e,egret.registerClass(e,"fairygui.PlayState")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(){t.call(this),this.touchEnabled=!0,this.touchChildren=!0}__extends(e,t);var i=__define,s=e,n=s.prototype;return i(n,"hitArea",function(){return this._hitArea},function(t){this._hitArea&&t?(this._hitArea.x=t.x,this._hitArea.y=t.y,this._hitArea.width=t.width,this._hitArea.height=t.height):this._hitArea=t?t.clone():null}),n.$hitTest=function(e,i){var s=t.prototype.$hitTest.call(this,e,i);if(s==this){if(!this.touchEnabled||null==this._hitArea)return null}else if(null==s&&this.touchEnabled&&null!=this._hitArea){var n=this.$getInvertedConcatenatedMatrix(),r=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty;this._hitArea.contains(r,a)&&(s=this)}return s},e}(egret.DisplayObjectContainer);t.UIContainer=e,egret.registerClass(e,"fairygui.UIContainer")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(){t.call(this),this.touchEnabled=!0,this.touchChildren=!0}__extends(e,t);var i=__define,s=e,n=s.prototype;return i(n,"hitArea",function(){return this._hitArea},function(t){this._hitArea&&t?(this._hitArea.x=t.x,this._hitArea.y=t.y,this._hitArea.width=t.width,this._hitArea.height=t.height):this._hitArea=t?t.clone():null}),n.$hitTest=function(e,i){var s=t.prototype.$hitTest.call(this,e,i);if(s==this){if(!this.touchEnabled||null==this._hitArea)return null}else if(null==s&&this.touchEnabled&&null!=this._hitArea){var n=this.$getInvertedConcatenatedMatrix(),r=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty;this._hitArea.contains(r,a)&&(s=this)}return s},e}(egret.Sprite);t.UISprite=e,egret.registerClass(e,"fairygui.UISprite")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){this.size=0,this.glyphs={}}var e=(__define,t);e.prototype;return t}();t.BitmapFont=e,egret.registerClass(e,"fairygui.BitmapFont")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.width=0,this.height=0,this.advance=0,this.lineHeight=0,this.channel=0}var e=(__define,t);e.prototype;return t}();t.BMGlyph=e,egret.registerClass(e,"fairygui.BMGlyph")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(e,i,s,n){void 0===i&&(i=0),void 0===s&&(s=0),void 0===n&&(n=-1),t.call(this,e,!1),this.touchPointID=0,this.stageX=i,this.stageY=s,this.touchPointID=n}__extends(e,t);var i=(__define,e),s=i.prototype;return s.preventDefault=function(){this._prevented=!0},s.isDefaultPrevented=function(){return this._prevented},e.DRAG_START="__dragStart",e.DRAG_END="__dragEnd",e.DRAG_MOVING="__dragMoving",e}(egret.Event);t.DragEvent=e,egret.registerClass(e,"fairygui.DragEvent")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=null),t.call(this,e,!1),this.source=i}__extends(e,t);var i=(__define,e);i.prototype;return e.DROP="__drop",e}(egret.Event);t.DropEvent=e,egret.registerClass(e,"fairygui.DropEvent")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(e,i,s,n){void 0===i&&(i=null),void 0===s&&(s=0),void 0===n&&(n=0),t.call(this,e,!1),this.itemObject=i,this.stageX=s,this.stageY=n}__extends(e,t);var i=(__define,e);i.prototype;return e.CLICK="___itemClick",e}(egret.Event);t.ItemEvent=e,egret.registerClass(e,"fairygui.ItemEvent")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(e){t.call(this,e,!1)}__extends(e,t);var i=(__define,e);i.prototype;return e.CHANGED="___stateChanged",e}(egret.Event);t.StateChangeEvent=e,egret.registerClass(e,"fairygui.StateChangeEvent")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){this._readPos=0,this.smallFontSize=12,this.normalFontSize=14,this.largeFontSize=16,this.defaultImgWidth=0,this.defaultImgHeight=0,this._handlers={},this._handlers.url=this.onTag_URL,this._handlers.img=this.onTag_IMG,this._handlers.b=this.onTag_Simple,this._handlers.i=this.onTag_Simple,this._handlers.u=this.onTag_Simple,this._handlers.sup=this.onTag_Simple,this._handlers.sub=this.onTag_Simple,this._handlers.color=this.onTag_COLOR,this._handlers.font=this.onTag_FONT,this._handlers.size=this.onTag_SIZE}var e=(__define,t),i=e.prototype;return i.onTag_URL=function(t,e,i){if(e)return"</a>";if(null!=i)return'<a href="'+i+'" target="_blank">';var s=this.getTagText();return'<a href="'+s+'" target="_blank">'},i.onTag_IMG=function(t,e,i){if(e)return null;var s=this.getTagText(!0);return s?this.defaultImgWidth?'<img src="'+s+'" width="'+this.defaultImgWidth+'" height="'+this.defaultImgHeight+'"/>':'<img src="'+s+'"/>':null},i.onTag_Simple=function(t,e,i){return e?"</"+t+">":"<"+t+">"},i.onTag_COLOR=function(t,e,i){return e?"</font>":'<font color="'+i+'">'},i.onTag_FONT=function(t,e,i){return e?"</font>":'<font face="'+i+'">'},i.onTag_SIZE=function(t,e,i){return e?"</font>":("normal"==i?i=""+this.normalFontSize:"small"==i?i=""+this.smallFontSize:"large"==i?i=""+this.largeFontSize:i.length&&"+"==i.charAt(0)?i=""+(this.smallFontSize+parseInt(i.substr(1))):i.length&&"-"==i.charAt(0)&&(i=""+(this.smallFontSize-parseInt(i.substr(1)))),'<font size="'+i+'">')},i.getTagText=function(t){void 0===t&&(t=!1);var e=this._text.indexOf("[",this._readPos);if(-1==e)return null;var i=this._text.substring(this._readPos,e);return t&&(this._readPos=e),i},i.parse=function(t){this._text=t;for(var e,i,s,n,r,a,h=0,o=0;-1!=(e=this._text.indexOf("[",h))&&(h=e,e=this._text.indexOf("]",h),-1!=e);)i="/"==this._text.charAt(h+1),s=this._text.substring(i?h+2:h+1,e),e++,this._readPos=e,n=null,r=null,o=s.indexOf("="),-1!=o&&(n=s.substring(o+1),s=s.substring(0,o)),s=s.toLowerCase(),a=this._handlers[s],null!=a?(r=a.call(this,s,i,n),null==r&&(r=""),this._text=this._text.substring(0,h)+r+this._text.substring(this._readPos)):h=e;return this._text},t.inst=new t,t}();t.UBBParser=e,egret.registerClass(e,"fairygui.UBBParser")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.getFileName=function(t){var e=t.lastIndexOf("/");return-1!=e&&(t=t.substr(e+1)),e=t.lastIndexOf("\\"),-1!=e&&(t=t.substr(e+1)),e=t.lastIndexOf("."),-1!=e?t.substring(0,e):t},e.startsWith=function(t,e,i){return void 0===i&&(i=!1),t?t.length<e.length?!1:(t=t.substring(0,e.length),i?t.toLowerCase()==e.toLowerCase():t==e):!1},e.endsWith=function(t,e,i){return void 0===i&&(i=!1),t?t.length<e.length?!1:(t=t.substring(t.length-e.length),i?t.toLowerCase()==e.toLowerCase():t==e):!1},e.trim=function(t){return e.trimLeft(e.trimRight(t))},e.trimLeft=function(t){for(var e="",i=0;i<t.length&&(e=t.charAt(i)," "==e||"\n"==e||"\r"==e);i++);return t.substr(i)},e.trimRight=function(t){for(var e="",i=t.length-1;i>=0&&(e=t.charAt(i)," "==e||"\n"==e||"\r"==e);i--);return t.substring(0,i+1)},e.convertToHtmlColor=function(t,e){void 0===e&&(e=!1);var i;i=e?(t>>24&255).toString(16):"";var s=(t>>16&255).toString(16),n=(t>>8&255).toString(16),r=(255&t).toString(16);return 1==i.length&&(i="0"+i),1==s.length&&(s="0"+s),1==n.length&&(n="0"+n),1==r.length&&(r="0"+r),"#"+i+s+n+r},e.convertFromHtmlColor=function(t,e){return void 0===e&&(e=!1),t.length<1?0:("#"==t.charAt(0)&&(t=t.substr(1)),8==t.length?(parseInt(t.substr(0,2),16)<<24)+parseInt(t.substr(2),16):e?4278190080+parseInt(t,16):parseInt(t,16))},e.displayObjectToGObject=function(t){for(;null!=t&&!(t instanceof egret.Stage);){if(t.$owner)return t.$owner;t=t.parent}return null},e.findChildNode=function(t,e){var i=t.children;if(i)for(var s=i.length,n=0;s>n;n++){var r=i[n];if(r.name==e)return r}return null},e.encodeHTML=function(t){return t?t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace("'","&apos;"):""},e.parseUBB=function(t){return e.defaultUBBParser.parse(t)},e.clamp=function(t,e,i){return e>t?t=e:t>i&&(t=i),t},e.clamp01=function(t){return t>1?t=1:0>t&&(t=0),t},e.defaultUBBParser=new t.UBBParser,e}();t.ToolSet=e,egret.registerClass(e,"fairygui.ToolSet")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){this.matrix=new Array(t.LENGTH),this.reset()}var e=(__define,t),i=e.prototype;return t.create=function(e,i,s,n){var r=new t;return r.adjustColor(e,i,s,n),r},i.reset=function(){for(var e=0;e<t.LENGTH;e++)this.matrix[e]=t.IDENTITY_MATRIX[e]},i.invert=function(){this.multiplyMatrix([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0])},i.adjustColor=function(t,e,i,s){this.adjustHue(s),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i)},i.adjustBrightness=function(t){t=255*this.cleanValue(t,1),this.multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0])},i.adjustContrast=function(t){t=this.cleanValue(t,1);var e=t+1,i=128*(1-e);this.multiplyMatrix([e,0,0,0,i,0,e,0,0,i,0,0,e,0,i,0,0,0,1,0])},i.adjustSaturation=function(e){e=this.cleanValue(e,1),e+=1;var i=1-e,s=i*t.LUMA_R,n=i*t.LUMA_G,r=i*t.LUMA_B;this.multiplyMatrix([s+e,n,r,0,0,s,n+e,r,0,0,s,n,r+e,0,0,0,0,0,1,0])},i.adjustHue=function(e){e=this.cleanValue(e,1),e*=Math.PI;var i=Math.cos(e),s=Math.sin(e);this.multiplyMatrix([t.LUMA_R+i*(1-t.LUMA_R)+s*-t.LUMA_R,t.LUMA_G+i*-t.LUMA_G+s*-t.LUMA_G,t.LUMA_B+i*-t.LUMA_B+s*(1-t.LUMA_B),0,0,t.LUMA_R+i*-t.LUMA_R+.143*s,t.LUMA_G+i*(1-t.LUMA_G)+.14*s,t.LUMA_B+i*-t.LUMA_B+s*-.283,0,0,t.LUMA_R+i*-t.LUMA_R+s*-(1-t.LUMA_R),t.LUMA_G+i*-t.LUMA_G+s*t.LUMA_G,t.LUMA_B+i*(1-t.LUMA_B)+s*t.LUMA_B,0,0,0,0,0,1,0])},i.concat=function(e){e.length==t.LENGTH&&this.multiplyMatrix(e)},i.clone=function(){var e=new t;return e.copyMatrix(this.matrix),e},i.copyMatrix=function(e){for(var i=t.LENGTH,s=0;i>s;s++)this.matrix[s]=e[s]},i.multiplyMatrix=function(t){for(var e=[],i=0,s=0;4>s;++s){for(var n=0;5>n;++n)e[i+n]=t[i]*this.matrix[n]+t[i+1]*this.matrix[n+5]+t[i+2]*this.matrix[n+10]+t[i+3]*this.matrix[n+15]+(4==n?t[i+4]:0);i+=5}this.copyMatrix(e)},i.cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},t.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],t.LENGTH=t.IDENTITY_MATRIX.length,t.LUMA_R=.299,t.LUMA_G=.587,t.LUMA_B=.114,t}();t.ColorMatrix=e,egret.registerClass(e,"fairygui.ColorMatrix")}(fairygui||(fairygui={}));var fairygui;!function(t){function e(t){switch(t){case"Common":return f.Common;case"Check":return f.Check;case"Radio":return f.Radio;default:return f.Common}}function i(t){switch(t){case"none":return v.None;case"both":return v.Both;case"height":return v.Height;default:return v.None}}function s(t){switch(t){case"left":return m.Left;case"center":return m.Center;case"right":return m.Right;default:return m.Left}}function n(t){return t==m.Left?egret.HorizontalAlign.LEFT:t==m.Center?egret.HorizontalAlign.CENTER:egret.HorizontalAlign.RIGHT}function r(t){switch(t){case"top":return y.Top;case"middle":return y.Middle;case"bottom":return y.Bottom;default:return y.Top}}function a(t){switch(t){case"none":return w.None;case"scale":return w.Scale;case"scaleMatchHeight":return w.ScaleMatchHeight;case"scaleMatchWidth":return w.ScaleMatchWidth;case"scaleFree":return w.ScaleFree;default:return w.None}}function h(t){switch(t){case"column":return b.SingleColumn;case"row":return b.SingleRow;case"flow_hz":return b.FlowHorizontal;case"flow_vt":return b.FlowVertical;case"pagination":return b.Pagination;default:return b.SingleColumn}}function o(t){switch(t){case"single":return C.Single;case"multiple":return C.Multiple;case"multipleSingleClick":return C.Multiple_SingleClick;case"none":return C.None;default:return C.Single}}function l(t){switch(t){case"visible":return x.Visible;case"hidden":return x.Hidden;case"scroll":return x.Scroll;case"scale":return x.Scale;case"scaleFree":return x.ScaleFree;default:return x.Visible}}function _(t){switch(t){case"image":return T.Image;case"movieclip":return T.MovieClip;case"sound":return T.Sound;case"component":return T.Component;case"swf":return T.Swf;case"font":return T.Font;case"atlas":return T.Atlas;default:return T.Misc}}function c(t){switch(t){case"percent":return I.Percent;case"valueAndmax":return I.ValueAndMax;case"value":return I.Value;case"max":return I.Max;default:return I.Percent}}function u(t){switch(t){case"default":return S.Default;case"visible":return S.Visible;case"auto":return S.Auto;case"hidden":return S.Hidden;default:return S.Default}}function d(t){switch(t){case"horizontal":return O.Horizontal;case"vertical":return O.Vertical;case"both":return O.Both;default:return O.Vertical}}function g(t){switch(t){case"hz":return P.Horizontal;case"vt":return P.Vertical;case"both":return P.Both;default:return P.None}}function p(t){var e=L[t];return e||(e=egret.Ease.quartOut),e}!function(t){t[t.Common=0]="Common",t[t.Check=1]="Check",t[t.Radio=2]="Radio"}(t.ButtonMode||(t.ButtonMode={}));var f=t.ButtonMode;!function(t){t[t.None=0]="None",t[t.Both=1]="Both",t[t.Height=2]="Height"}(t.AutoSizeType||(t.AutoSizeType={}));var v=t.AutoSizeType;!function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"}(t.AlignType||(t.AlignType={}));var m=t.AlignType;!function(t){t[t.Top=0]="Top",t[t.Middle=1]="Middle",t[t.Bottom=2]="Bottom"}(t.VertAlignType||(t.VertAlignType={}));var y=t.VertAlignType;!function(t){t[t.None=0]="None",t[t.Scale=1]="Scale",t[t.ScaleMatchHeight=2]="ScaleMatchHeight",t[t.ScaleMatchWidth=3]="ScaleMatchWidth",t[t.ScaleFree=4]="ScaleFree"}(t.LoaderFillType||(t.LoaderFillType={}));var w=t.LoaderFillType;!function(t){t[t.SingleColumn=0]="SingleColumn",t[t.SingleRow=1]="SingleRow",t[t.FlowHorizontal=2]="FlowHorizontal",t[t.FlowVertical=3]="FlowVertical",t[t.Pagination=4]="Pagination"}(t.ListLayoutType||(t.ListLayoutType={}));var b=t.ListLayoutType;!function(t){t[t.Single=0]="Single",t[t.Multiple=1]="Multiple",t[t.Multiple_SingleClick=2]="Multiple_SingleClick",t[t.None=3]="None"}(t.ListSelectionMode||(t.ListSelectionMode={}));var C=t.ListSelectionMode;!function(t){t[t.Visible=0]="Visible",t[t.Hidden=1]="Hidden",t[t.Scroll=2]="Scroll",t[t.Scale=3]="Scale",t[t.ScaleFree=4]="ScaleFree"}(t.OverflowType||(t.OverflowType={}));var x=t.OverflowType;!function(t){t[t.Image=0]="Image",t[t.Swf=1]="Swf",t[t.MovieClip=2]="MovieClip",t[t.Sound=3]="Sound",t[t.Component=4]="Component",t[t.Misc=5]="Misc",t[t.Font=6]="Font",t[t.Atlas=7]="Atlas"}(t.PackageItemType||(t.PackageItemType={}));var T=t.PackageItemType;!function(t){t[t.Percent=0]="Percent",t[t.ValueAndMax=1]="ValueAndMax",t[t.Value=2]="Value",t[t.Max=3]="Max"}(t.ProgressTitleType||(t.ProgressTitleType={}));var I=t.ProgressTitleType;!function(t){t[t.Default=0]="Default",t[t.Visible=1]="Visible",t[t.Auto=2]="Auto",t[t.Hidden=3]="Hidden"}(t.ScrollBarDisplayType||(t.ScrollBarDisplayType={}));var S=t.ScrollBarDisplayType;!function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical",t[t.Both=2]="Both"}(t.ScrollType||(t.ScrollType={}));var O=t.ScrollType;!function(t){t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Both=3]="Both"}(t.FlipType||(t.FlipType={}));var P=t.FlipType;!function(t){t[t.Left_Left=0]="Left_Left",t[t.Left_Center=1]="Left_Center",t[t.Left_Right=2]="Left_Right",t[t.Center_Center=3]="Center_Center",t[t.Right_Left=4]="Right_Left",t[t.Right_Center=5]="Right_Center",t[t.Right_Right=6]="Right_Right",t[t.Top_Top=7]="Top_Top",t[t.Top_Middle=8]="Top_Middle",t[t.Top_Bottom=9]="Top_Bottom",t[t.Middle_Middle=10]="Middle_Middle",t[t.Bottom_Top=11]="Bottom_Top",t[t.Bottom_Middle=12]="Bottom_Middle",t[t.Bottom_Bottom=13]="Bottom_Bottom",t[t.Width=14]="Width",t[t.Height=15]="Height",t[t.LeftExt_Left=16]="LeftExt_Left",t[t.LeftExt_Right=17]="LeftExt_Right",t[t.RightExt_Left=18]="RightExt_Left",t[t.RightExt_Right=19]="RightExt_Right",t[t.TopExt_Top=20]="TopExt_Top",t[t.TopExt_Bottom=21]="TopExt_Bottom",t[t.BottomExt_Top=22]="BottomExt_Top",t[t.BottomExt_Bottom=23]="BottomExt_Bottom",t[t.Size=24]="Size"}(t.RelationType||(t.RelationType={}));t.RelationType;t.parseButtonMode=e,t.parseAutoSizeType=i,t.parseAlignType=s,t.getAlignTypeString=n,t.parseVertAlignType=r,t.parseLoaderFillType=a,t.parseListLayoutType=h,t.parseListSelectionMode=o,t.parseOverflowType=l,t.parsePackageItemType=_,t.parseProgressTitleType=c,t.parseScrollBarDisplayType=u,t.parseScrollType=d,t.parseFlipType=g;var L={Linear:egret.Ease.getPowIn(1),"Elastic.In":egret.Ease.elasticIn,"Elastic.Out":egret.Ease.elasticOut,"Elastic.InOut":egret.Ease.elasticInOut,"Quad.In":egret.Ease.quadIn,"Quad.Out":egret.Ease.quadOut,"Quad.InOut":egret.Ease.quadInOut,"Cube.In":egret.Ease.cubicIn,"Cube.Out":egret.Ease.cubicOut,"Cube.InOut":egret.Ease.cubicInOut,"Quart.In":egret.Ease.quartIn,"Quart.Out":egret.Ease.quartOut,"Quart.InOut":egret.Ease.quartInOut,"Quint.In":egret.Ease.quintIn,"Quint.Out":egret.Ease.quintOut,"Quint.InOut":egret.Ease.quintInOut,"Sine.In":egret.Ease.sineIn,"Sine.Out":egret.Ease.sineOut,"Sine.InOut":egret.Ease.sineInOut,"Bounce.In":egret.Ease.bounceIn,"Bounce.Out":egret.Ease.bounceOut,"Bounce.InOut":egret.Ease.bounceInOut,"Circ.In":egret.Ease.circIn,"Circ.Out":egret.Ease.circOut,"Circ.InOut":egret.Ease.circInOut,"Expo.In":egret.Ease.quartIn,"Expo.Out":egret.Ease.quartOut,"Expo.InOut":egret.Ease.quartInOut,"Back.In":egret.Ease.backIn,"Back.Out":egret.Ease.backOut,"Back.InOut":egret.Ease.backInOut};t.ParseEaseType=p}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(t){this._owner=t,this._easeType=egret.Ease.quadOut,this._tweenTime=.3,this._tweenDelay=0}var i=__define,s=e,n=s.prototype;return i(n,"controller",function(){return this._controller},function(t){t!=this._controller&&(this._controller=t,this._controller&&this.init())}),i(n,"tween",function(){return this._tween},function(t){this._tween=t}),i(n,"tweenDelay",function(){return this._tweenDelay},function(t){this._tweenDelay=t}),i(n,"tweenTime",function(){return this._tweenTime},function(t){this._tweenTime=t}),i(n,"easeType",function(){return this._easeType},function(t){this._easeType=t}),n.setup=function(e){if(this._controller=this._owner.parent.getController(e.attributes.controller),null!=this._controller){this.init();var i;if(i=e.attributes.tween,i&&(this._tween=!0),i=e.attributes.ease,i&&(this._easeType=t.ParseEaseType(i)),i=e.attributes.duration,i&&(this._tweenTime=parseFloat(i)),i=e.attributes.delay,i&&(this._tweenDelay=parseFloat(i)),this instanceof t.GearDisplay)i=e.attributes.pages,i&&(this.pages=i.split(","));else{var s,n;if(i=e.attributes.pages,i&&(s=i.split(",")),i=e.attributes.values,i&&(n=i.split("|")),s&&n)for(var r=0;r<n.length;r++)this.addStatus(s[r],n[r]);i=e.attributes["default"],i&&this.addStatus(null,i)}}},n.updateFromRelations=function(t,e){},n.addStatus=function(t,e){},n.init=function(){},n.apply=function(){},n.updateState=function(){},e.disableAllTweenEffect=!1,e}();t.GearBase=e,egret.registerClass(e,"fairygui.GearBase")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function s(t){e.call(this,t)}__extends(s,e);var n=(__define,s),r=n.prototype;return r.init=function(){this._default=new i(this._owner.width,this._owner.height,this._owner.scaleX,this._owner.scaleY),this._storage={}},r.addStatus=function(t,e){if("-"!=e){var s,n=e.split(",");null==t?s=this._default:(s=new i,this._storage[t]=s),s.width=parseInt(n[0]),s.height=parseInt(n[1]),n.length>2&&(s.scaleX=parseFloat(n[2]),s.scaleY=parseFloat(n[3]))}},r.apply=function(){var e=this._storage[this._controller.selectedPageId];if(e||(e=this._default),!this._tween||t.UIPackage._constructing||t.GearBase.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.setSize(e.width,e.height,this._owner.gearXY.controller==this._controller),this._owner.setScale(e.scaleX,e.scaleY),this._owner._gearLocked=!1;else{if(null!=this.tweener){if(this._tweenTarget.width==e.width&&this._tweenTarget.height==e.height&&this._tweenTarget.scaleX==e.scaleX&&this._tweenTarget.scaleY==e.scaleY)return;this.tweener.tick?this.tweener.tick(1e8):this.tweener.$tick(1e8),this.tweener=null}var s=e.width!=this._owner.width||e.height!=this._owner.height,n=e.scaleX!=this._owner.scaleX||e.scaleY!=this._owner.scaleY;if(s||n){this._owner.internalVisible++,this._tweenTarget=e;var r={onChange:function(){this._owner._gearLocked=!0,s&&this._owner.setSize(this._tweenValue.width,this._tweenValue.height,this._owner.gearXY.controller==this._controller),n&&this._owner.setScale(this._tweenValue.scaleX,this._tweenValue.scaleY),this._owner._gearLocked=!1},onChangeObj:this};null==this._tweenValue&&(this._tweenValue=new i),this._tweenValue.width=this._owner.width,this._tweenValue.height=this._owner.height,this._tweenValue.scaleX=this._owner.scaleX,this._tweenValue.scaleY=this._owner.scaleY,this.tweener=egret.Tween.get(this._tweenValue,r).wait(1e3*this._tweenDelay).to({width:e.width,height:e.height,scaleX:e.scaleX,scaleY:e.scaleY},1e3*this._tweenTime,this._easeType).call(function(){this._owner.internalVisible--,this._tweener=null,this._owner.dispatchEventWith(t.GObject.GEAR_STOP,!1)},this)}}},r.updateState=function(){if(null!=this._controller&&!this._owner._gearLocked&&!this._owner._underConstruct){var t=this._storage[this._controller.selectedPageId];t||(t=new i,this._storage[this._controller.selectedPageId]=t),t.width=this._owner.width,t.height=this._owner.height,t.scaleX=this._owner.scaleX,t.scaleY=this._owner.scaleY}},r.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage){for(var i in this._storage){var s=this._storage[i];s.width+=t,s.height+=e}this._default.width+=t,this._default.height+=e,this.updateState()}},s}(t.GearBase);t.GearSize=e,egret.registerClass(e,"fairygui.GearSize");var i=function(){function t(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.width=t,this.height=e,this.scaleX=i,this.scaleY=s}var e=(__define,t);
e.prototype;return t}();egret.registerClass(i,"GearSizeValue")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(t){e.call(this,t)}__extends(i,e);var s=(__define,i),n=s.prototype;return n.init=function(){this._default=new egret.Point(this._owner.x,this._owner.y),this._storage={}},n.addStatus=function(t,e){if("-"!=e){var i,s=e.split(",");null==t?i=this._default:(i=new egret.Point,this._storage[t]=i),i.x=parseInt(s[0]),i.y=parseInt(s[1])}},n.apply=function(){var e=this._storage[this._controller.selectedPageId];if(e||(e=this._default),!this._tween||t.UIPackage._constructing||t.GearBase.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.setXY(e.x,e.y),this._owner._gearLocked=!1;else{if(this.tweener){if(this._tweenTarget.x==e.x&&this._tweenTarget.y==e.y)return;this.tweener.tick?this.tweener.tick(1e8):this.tweener.$tick(1e8),this.tweener=null}if(this._owner.x!=e.x||this._owner.y!=e.y){this._owner.internalVisible++,this._tweenTarget=e;var i={onChange:function(){this._owner._gearLocked=!0,this._owner.setXY(this._tweenValue.x,this._tweenValue.y),this._owner._gearLocked=!1},onChangeObj:this};null==this._tweenValue&&(this._tweenValue=new egret.Point),this._tweenValue.x=this._owner.x,this._tweenValue.y=this._owner.y,this.tweener=egret.Tween.get(this._tweenValue,i).wait(1e3*this._tweenDelay).to({x:e.x,y:e.y},1e3*this._tweenTime,this._easeType).call(function(){this._owner.internalVisible--,this._tweener=null,this._owner.dispatchEventWith(t.GObject.GEAR_STOP,!1)},this)}}},n.updateState=function(){if(null!=this._controller&&!this._owner._gearLocked&&!this._owner._underConstruct){var t=this._storage[this._controller.selectedPageId];t||(t=new egret.Point,this._storage[this._controller.selectedPageId]=t),t.x=this._owner.x,t.y=this._owner.y}},n.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage){for(var i in this._storage){var s=this._storage[i];s.x+=t,s.y+=e}this._default.x+=t,this._default.y+=e,this.updateState()}},i}(t.GearBase);t.GearXY=e,egret.registerClass(e,"fairygui.GearXY")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.init=function(){this._default=this._owner.text,this._storage={}},s.addStatus=function(t,e){null==t?this._default=e:this._storage[t]=e},s.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];void 0!=t?this._owner.text=t:this._owner.text=this._default,this._owner._gearLocked=!1},s.updateState=function(){null==this._controller||this._owner._gearLocked||this._owner._underConstruct||(this._storage[this._controller.selectedPageId]=this._owner.text)},e}(t.GearBase);t.GearText=e,egret.registerClass(e,"fairygui.GearText")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.init=function(){this._default=this._owner.icon,this._storage={}},s.addStatus=function(t,e){null==t?this._default=e:this._storage[t]=e},s.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];void 0!=t?this._owner.icon=t:this._owner.icon=this._default,this._owner._gearLocked=!1},s.updateState=function(){null==this._controller||this._owner._gearLocked||this._owner._underConstruct||(this._storage[this._controller.selectedPageId]=this._owner.icon)},e}(t.GearBase);t.GearIcon=e,egret.registerClass(e,"fairygui.GearIcon")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(t){this.autoPlayRepeat=1,this.autoPlayDelay=0,this._ownerBaseX=0,this._ownerBaseY=0,this._totalTimes=0,this._totalTasks=0,this._playing=!1,this._options=0,this._maxTime=0,this._owner=t,this._items=new Array}var n=__define,r=e,a=r.prototype;return n(a,"autoPlay",function(){return this._autoPlay},function(t){this._autoPlay!=t&&(this._autoPlay=t,this._autoPlay?this._owner.onStage&&this.play(null,null,this.autoPlayRepeat,this.autoPlayDelay):this._owner.onStage||this.stop(!1,!0))}),a.play=function(t,e,i,s,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s=1),void 0===n&&(n=0),this._play(t,e,i,s,n,!1)},a.playReverse=function(t,e,i,s,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s=1),void 0===n&&(n=0),this._play(t,e,i,s,n,!0)},a._play=function(t,i,s,n,r,a){if(void 0===t&&(t=null),void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=1),void 0===r&&(r=0),void 0===a&&(a=!1),this.stop(),0==n?n=1:-1==n&&(n=Number.MAX_VALUE),this._totalTimes=n,this._reversed=a,this.internalPlay(r),this._playing=this._totalTasks>0,this._playing){if(this._onComplete=t,this._onCompleteParam=s,this._onCompleteObj=i,this._owner.internalVisible++,0!=(this._options&e.OPTION_IGNORE_DISPLAY_CONTROLLER))for(var h=this._items.length,o=0;h>o;o++){var l=this._items[o];null!=l.target&&l.target!=this._owner&&l.target.internalVisible++}}else null!=t&&(t.length>0?t.call(this._onCompleteObj,s):t(this._onCompleteObj))},a.stop=function(t,e){if(void 0===t&&(t=!0),void 0===e&&(e=!1),this._playing){this._playing=!1,this._totalTasks=0,this._totalTimes=0;var i=this._onComplete,s=this._onCompleteParam,n=this._onCompleteObj;this._onComplete=null,this._onCompleteParam=null,this._onCompleteObj=null,this._owner.internalVisible--;var r,a,h=this._items.length;if(this._reversed)for(r=h-1;r>=0;r--)a=this._items[r],null!=a.target&&this.stopItem(a,t);else for(r=0;h>r;r++)a=this._items[r],null!=a.target&&this.stopItem(a,t);e&&null!=i&&(i.length>0?i.call(n,s):i.call(n))}},a.stopItem=function(s,n){if(0!=(this._options&e.OPTION_IGNORE_DISPLAY_CONTROLLER)&&s.target!=this._owner&&s.target.internalVisible--,s.type==i.ColorFilter&&s.filterCreated&&(s.target.filters=null),!s.completed)if(null!=s.tweener&&(s.tweener.setPaused(!0),s.tweener=null),s.type==i.Transition){var r=s.target.getTransition(s.value.s);null!=r&&r.stop(n,!1)}else s.type==i.Shake?t.GTimers.inst.exists(this.__shake,s)&&(t.GTimers.inst.remove(this.__shake,s),s.target._gearLocked=!0,s.target.setXY(s.target.x-s.startValue.f1,s.target.y-s.startValue.f2),s.target._gearLocked=!1):n&&(s.tween?s.yoyo&&s.repeat%2!=0?this.applyValue(s,this._reversed?s.endValue:s.startValue):this.applyValue(s,this._reversed?s.startValue:s.endValue):s.type!=i.Sound&&this.applyValue(s,s.value))},a.dispose=function(){if(this._playing){this._playing=!1;for(var e=this._items.length,s=0;e>s;s++){var n=this._items[s];if(null!=n.target&&!n.completed)if(null!=n.tweener&&(n.tweener.setPaused(!0),n.tweener=null),n.type==i.Transition){var r=n.target.getTransition(n.value.s);null!=r&&r.dispose()}else n.type==i.Shake&&t.GTimers.inst.remove(this.__shake,n)}}},n(a,"playing",function(){return this._playing}),a.setValue=function(t){for(var e=[],s=1;s<arguments.length;s++)e[s-1]=arguments[s];for(var n,r=this._items.length,a=0;r>a;a++){var h=this._items[a];if(null!=h.label||null!=h.label2){if(h.label==t)n=h.tween?h.startValue:h.value;else{if(h.label2!=t)continue;n=h.endValue}switch(h.type){case i.XY:case i.Size:case i.Pivot:case i.Scale:case i.Skew:n.b1=!0,n.b2=!0,n.f1=parseFloat(e[0]),n.f2=parseFloat(e[1]);break;case i.Alpha:n.f1=parseFloat(e[0]);break;case i.Rotation:n.i=parseInt(e[0]);break;case i.Color:n.c=parseFloat(e[0]);break;case i.Animation:n.i=parseInt(e[0]),e.length>1&&(n.b=e[1]);break;case i.Visible:n.b=e[0];break;case i.Sound:n.s=e[0],e.length>1&&(n.f1=parseFloat(e[1]));break;case i.Transition:n.s=e[0],e.length>1&&(n.i=parseInt(e[1]));break;case i.Shake:n.f1=parseFloat(e[0]),e.length>1&&(n.f2=parseFloat(e[1]));break;case i.ColorFilter:n.f1=parseFloat(e[0]),n.f2=parseFloat(e[1]),n.f3=parseFloat(e[2]),n.f4=parseFloat(e[3])}}}},a.setHook=function(t,e,i){for(var s=this._items.length,n=0;s>n;n++){var r=this._items[n];if(r.label==t){r.hook=e,r.hookObj=i;break}if(r.label2==t){r.hook2=e,r.hook2Obj=i;break}}},a.clearHooks=function(){for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.hook=null,i.hookObj=null,i.hook2=null,i.hook2Obj=null}},a.setTarget=function(t,e){for(var i=this._items.length,s=0;i>s;s++){var n=this._items[s];(null!=n.label||null!=n.label2)&&(n.targetId=e.id)}},a.setDuration=function(t,e){for(var i=this._items.length,s=0;i>s;s++){var n=this._items[s];n.tween&&n.label==t&&(n.duration=e)}},a.updateFromRelations=function(t,e,s){var n=this._items.length;if(0!=n)for(var r=0;n>r;r++){var a=this._items[r];a.type==i.XY&&a.targetId==t&&(a.tween?(a.startValue.f1+=e,a.startValue.f2+=s,a.endValue.f1+=e,a.endValue.f2+=s):(a.value.f1+=e,a.value.f2+=s))}},a.internalPlay=function(t){void 0===t&&(t=0),this._ownerBaseX=this._owner.x,this._ownerBaseY=this._owner.y,this._totalTasks=0;for(var e,s,n=this._items.length,r=0;n>r;r++)s=this._items[r],s.targetId?s.target=this._owner.getChildById(s.targetId):s.target=this._owner,null!=s.target&&(s.tween?(e=this._reversed?t+1e3*(this._maxTime-s.time-s.duration):t+1e3*s.time,e>0&&(s.type==i.XY||s.type==i.Size)?(this._totalTasks++,s.completed=!1,s.tweener=egret.Tween.get(s.value).wait(e).call(this.__delayCall,this,[s])):this.startTween(s,e)):(e=this._reversed?t+1e3*(this._maxTime-s.time):t+1e3*s.time,0==e?this.applyValue(s,s.value):(this._totalTasks++,s.completed=!1,s.tweener=egret.Tween.get(s.value).wait(e).call(this.__delayCall2,this,[s]))))},a.prepareValue=function(t,e,s){void 0===s&&(s=!1);var n,r;switch(s?(n=t.endValue,r=t.startValue):(n=t.startValue,r=t.endValue),t.type){case i.XY:case i.Size:t.type==i.XY?t.target==this._owner?(n.b1||(n.f1=0),n.b2||(n.f2=0)):(n.b1||(n.f1=t.target.x),n.b2||(n.f2=t.target.y)):(n.b1||(n.f1=t.target.width),n.b2||(n.f2=t.target.height)),t.value.f1=n.f1,t.value.f2=n.f2,r.b1||(r.f1=t.value.f1),r.b2||(r.f2=t.value.f2),t.value.b1=n.b1||r.b1,t.value.b2=n.b2||r.b2,e.f1=r.f1,e.f2=r.f2;break;case i.Scale:case i.Skew:t.value.f1=n.f1,t.value.f2=n.f2,e.f1=r.f1,e.f2=r.f2;break;case i.Alpha:t.value.f1=n.f1,e.f1=r.f1;break;case i.Rotation:t.value.i=n.i,e.i=r.i;break;case i.ColorFilter:t.value.f1=n.f1,t.value.f2=n.f2,t.value.f3=n.f3,t.value.f4=n.f4,e.f1=r.f1,e.f2=r.f2,e.f3=r.f3,e.f4=r.f4}},a.startTween=function(t,e){var i,s;i={},s={},this._totalTasks++,t.completed=!1,this.prepareValue(t,s,this._reversed),t.tweener=egret.Tween.get(t.value,i),0!=e?t.tweener.wait(e):this.applyValue(t,t.value),t.tweener.call(this.__tweenStart,this,[t]),t.tweener.to(s,1e3*t.duration,t.easeType),0!=t.repeat?(t.tweenTimes=0,t.tweener.call(this.__tweenRepeatComplete,this,[t])):t.tweener.call(this.__tweenComplete,this,[t])},a.__delayCall=function(t){t.tweener=null,this._totalTasks--,this.startTween(t,0)},a.__delayCall2=function(t){t.tweener=null,this._totalTasks--,t.completed=!0,this.applyValue(t,t.value),null!=t.hook&&t.hook.call(t.hookObj),this.checkAllComplete()},a.__tweenStart=function(t){null!=t.tweener&&(null!=t.hook&&t.hook.call(t.hookObj),t.tweener.addEventListener("change",this.__tweenUpdate,[this,t]))},a.__tweenUpdate=function(){var t=this,e=t[0],i=t[1];e.applyValue(i,i.value)},a.__tweenComplete=function(t){t.tweener=null,this._totalTasks--,t.completed=!0,null!=t.hook2&&t.hook2.call(t.hook2Obj),this.checkAllComplete()},a.__tweenRepeatComplete=function(t){if(t.tweenTimes++,-1==t.repeat||t.tweenTimes<t.repeat+1){var e,i;e={},i={},e.onChange=this.__tweenUpdate,e.onChangeObj=[this,t];var s;s=t.yoyo?this._reversed?t.tweenTimes%2==0:t.tweenTimes%2==1:this._reversed,this.prepareValue(t,i,s),t.tweener=egret.Tween.get(t.value,e),t.tweener.to(i,1e3*t.duration,t.easeType).call(this.__tweenRepeatComplete,this,[t])}else this.__tweenComplete(t)},a.__playTransComplete=function(t){this._totalTasks--,t.completed=!0,this.checkAllComplete()},a.checkAllComplete=function(){if(this._playing&&0==this._totalTasks)if(this._totalTimes<0)egret.callLater(this.internalPlay,this,0);else if(this._totalTimes--,this._totalTimes>0)egret.callLater(this.internalPlay,this,0);else{this._playing=!1,this._owner.internalVisible--;for(var t=this._items.length,i=0;t>i;i++){var s=this._items[i];null!=s.target&&0!=(this._options&e.OPTION_IGNORE_DISPLAY_CONTROLLER)&&s.target!=this._owner&&s.target.internalVisible--,s.filterCreated&&(s.filterCreated=!1,s.target.filters=null)}if(null!=this._onComplete){var n=this._onComplete,r=this._onCompleteParam,a=this._onCompleteObj;this._onComplete=null,this._onCompleteParam=null,this._onCompleteObj=null,n.length>0?n.call(a,r):n.call(a)}}},a.applyValue=function(e,s){switch(e.target._gearLocked=!0,e.type){case i.XY:if(e.target==this._owner){var n=0,r=0;n=s.b1?s.f1+this._ownerBaseX:e.target.x,r=s.b2?s.f2+this._ownerBaseY:e.target.y,e.target.setXY(n,r)}else s.b1||(s.f1=e.target.x),s.b2||(s.f2=e.target.y),e.target.setXY(s.f1,s.f2);break;case i.Size:s.b1||(s.f1=e.target.width),s.b2||(s.f2=e.target.height),e.target.setSize(s.f1,s.f2);break;case i.Pivot:e.target.setPivot(s.f1,s.f2);break;case i.Alpha:e.target.alpha=s.f1;break;case i.Rotation:e.target.rotation=s.i;break;case i.Scale:e.target.setScale(s.f1,s.f2);break;case i.Skew:e.target.setSkew(s.f1,s.f2);break;case i.Color:e.target.color=s.c;break;case i.Animation:s.b1||(s.i=e.target.frame),e.target.frame=s.i,e.target.playing=s.b;break;case i.Visible:e.target.visible=s.b;break;case i.Transition:var a=e.target.getTransition(s.s);null!=a&&(0==s.i?a.stop(!1,!0):a.playing?a._totalTimes=-1==s.i?Number.MAX_VALUE:s.i:(e.completed=!1,this._totalTasks++,this._reversed?a.playReverse(this.__playTransComplete,this,e,e.value.i):a.play(this.__playTransComplete,this,e,e.value.i)));break;case i.Sound:var h=t.UIPackage.getItemByURL(s.s);if(h){var o=h.owner.getItemAsset(h);o&&t.GRoot.inst.playOneShotSound(o,s.f1)}break;case i.Shake:e.startValue.f1=0,e.startValue.f2=0,e.startValue.f3=e.value.f2,e.startValue.i=egret.getTimer(),t.GTimers.inst.add(1,0,this.__shake,e,this),this._totalTasks++,e.completed=!1;break;case i.ColorFilter:var l,_=e.target.filters;_&&_[0]instanceof egret.ColorMatrixFilter?l=_[0]:(l=new egret.ColorMatrixFilter,_=[l],e.filterCreated=!0);var c=new t.ColorMatrix;c.adjustBrightness(s.f1),c.adjustContrast(s.f2),c.adjustSaturation(s.f3),c.adjustHue(s.f4),l.matrix=c.matrix,e.target.filters=_}e.target._gearLocked=!1},a.__shake=function(t){var e=this;t.__shakeItem(e)},a.__shakeItem=function(e){var i=Math.ceil(e.value.f1*e.startValue.f3/e.value.f2),s=(2*Math.random()-1)*i,n=(2*Math.random()-1)*i;s=s>0?Math.ceil(s):Math.floor(s),n=n>0?Math.ceil(n):Math.floor(n),e.target._gearLocked=!0,e.target.setXY(e.target.x-e.startValue.f1+s,e.target.y-e.startValue.f2+n),e.target._gearLocked=!1,e.startValue.f1=s,e.startValue.f2=n;var r=egret.getTimer();e.startValue.f3-=(r-e.startValue.i)/1e3,e.startValue.i=r,e.startValue.f3<=0&&(e.target._gearLocked=!0,e.target.setXY(e.target.x-e.startValue.f1,e.target.y-e.startValue.f2),e.target._gearLocked=!1,e.completed=!0,this._totalTasks--,t.GTimers.inst.remove(this.__shake,e),this.checkAllComplete())},a.setup=function(n){this.name=n.attributes.name;var r=n.attributes.options;r&&(this._options=parseInt(r)),this._autoPlay="true"==n.attributes.autoPlay,this._autoPlay&&(r=n.attributes.autoPlayRepeat,r&&(this.autoPlayRepeat=parseInt(r)),r=n.attributes.autoPlayDelay,r&&(this.autoPlayDelay=parseFloat(r)));for(var a=n.children,h=a.length,o=0;h>o;o++){var l=a[o];if("item"==l.name){var _=new s;switch(this._items.push(_),_.time=parseInt(l.attributes.time)/e.FRAME_RATE,_.targetId=l.attributes.target,r=l.attributes.type){case"XY":_.type=i.XY;break;case"Size":_.type=i.Size;break;case"Scale":_.type=i.Scale;break;case"Pivot":_.type=i.Pivot;break;case"Alpha":_.type=i.Alpha;break;case"Rotation":_.type=i.Rotation;break;case"Color":_.type=i.Color;break;case"Animation":_.type=i.Animation;break;case"Visible":_.type=i.Visible;break;case"Sound":_.type=i.Sound;break;case"Transition":_.type=i.Transition;break;case"Shake":_.type=i.Shake;break;case"ColorFilter":_.type=i.ColorFilter;break;case"Skew":_.type=i.Skew;break;default:_.type=i.Unknown}if(_.tween="true"==l.attributes.tween,_.label=l.attributes.label,_.tween){_.duration=parseInt(l.attributes.duration)/e.FRAME_RATE,_.time+_.duration>this._maxTime&&(this._maxTime=_.time+_.duration),r=l.attributes.ease,r&&(_.easeType=t.ParseEaseType(r)),r=l.attributes.repeat,r&&(_.repeat=parseInt(r)),_.yoyo="true"==l.attributes.yoyo,_.label2=l.attributes.label2;var c=l.attributes.endValue;c?(this.decodeValue(_.type,l.attributes.startValue,_.startValue),this.decodeValue(_.type,c,_.endValue)):(_.tween=!1,this.decodeValue(_.type,l.attributes.startValue,_.value))}else _.time>this._maxTime&&(this._maxTime=_.time),this.decodeValue(_.type,l.attributes.value,_.value)}}},a.decodeValue=function(e,s,n){var r;switch(e){case i.XY:case i.Size:case i.Pivot:case i.Skew:r=s.split(","),"-"==r[0]?n.b1=!1:(n.f1=parseFloat(r[0]),n.b1=!0),"-"==r[1]?n.b2=!1:(n.f2=parseFloat(r[1]),n.b2=!0);break;case i.Alpha:n.f1=parseFloat(s);break;case i.Rotation:n.i=parseInt(s);break;case i.Scale:r=s.split(","),n.f1=parseFloat(r[0]),n.f2=parseFloat(r[1]);break;case i.Color:n.c=t.ToolSet.convertFromHtmlColor(s);break;case i.Animation:r=s.split(","),"-"==r[0]?n.b1=!1:(n.i=parseInt(r[0]),n.b1=!0),n.b="p"==r[1];break;case i.Visible:n.b="true"==s;break;case i.Sound:if(r=s.split(","),n.s=r[0],r.length>1){var a=parseInt(r[1]);0==a||100==a?n.f1=1:n.f1=a/100}else n.f1=1;break;case i.Transition:r=s.split(","),n.s=r[0],r.length>1?n.i=parseInt(r[1]):n.i=1;break;case i.Shake:r=s.split(","),n.f1=parseFloat(r[0]),n.f2=parseFloat(r[1]);break;case i.ColorFilter:r=s.split(","),n.f1=parseFloat(r[0]),n.f2=parseFloat(r[1]),n.f3=parseFloat(r[2]),n.f4=parseFloat(r[3])}},e.OPTION_IGNORE_DISPLAY_CONTROLLER=1,e.FRAME_RATE=24,e}();t.Transition=e,egret.registerClass(e,"fairygui.Transition");var i=function(){function t(){}var e=(__define,t);e.prototype;return t.XY=0,t.Size=1,t.Scale=2,t.Pivot=3,t.Alpha=4,t.Rotation=5,t.Color=6,t.Animation=7,t.Visible=8,t.Sound=9,t.Transition=10,t.Shake=11,t.ColorFilter=12,t.Skew=13,t.Unknown=14,t}();egret.registerClass(i,"TransitionActionType");var s=function(){function t(){this.time=0,this.type=0,this.duration=0,this.repeat=0,this.yoyo=!1,this.tween=!1,this.tweenTimes=0,this.completed=!1,this.easeType=egret.Ease.quadOut,this.value=new n,this.startValue=new n,this.endValue=new n}var e=(__define,t);e.prototype;return t}();egret.registerClass(s,"TransitionItem");var n=function(){function t(){this.f1=0,this.f2=0,this.f3=0,this.f4=0,this.i=0,this.c=0,this.b=!1,this.b1=!0,this.b2=!0}var e=(__define,t);e.prototype;return t}();egret.registerClass(n,"TransitionValue")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._x=0,this._y=0,this._width=0,this._height=0,this._alpha=1,this._rotation=0,this._visible=!0,this._touchable=!0,this._grayed=!1,this._draggable=!1,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._pivotX=0,this._pivotY=0,this._pivotAsAnchor=!1,this._pivotOffsetX=0,this._pivotOffsetY=0,this._sortingOrder=0,this._internalVisible=1,this._focusable=!1,this._pixelSnapping=!1,this._rawWidth=0,this._rawHeight=0,this._sourceWidth=0,this._sourceHeight=0,this._initWidth=0,this._initHeight=0,this._yOffset=0,this._sizeImplType=0,this._id=""+i._gInstanceCounter++,this._name="",this.createDisplayObject(),this._relations=new t.Relations(this),this._gears=[]}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"id",function(){return this._id}),s(r,"name",function(){return this._name},function(t){this._name=t}),s(r,"x",function(){return this._x},function(t){this.setXY(t,this._y)}),s(r,"y",function(){return this._y},function(t){this.setXY(this._x,t)}),r.setXY=function(e,s){if(this._x!=e||this._y!=s){var n=e-this._x,r=s-this._y;this._x=e,this._y=s,this.handleXYChanged(),this instanceof t.GGroup&&this.moveChildren(n,r),this.updateGear(1),!this._parent||this._parent instanceof t.GList||(this._parent.setBoundsChangedFlag(),this.dispatchEventWith(i.XY_CHANGED)),i.draggingObject!=this||i.sUpdateInDragging||this.localToGlobalRect(0,0,this.width,this.height,i.sGlobalRect)}},s(r,"pixelSnapping",function(){return this._pixelSnapping},function(t){this._pixelSnapping!=t&&(this._pixelSnapping=t,this.handleXYChanged())}),r.center=function(e){void 0===e&&(e=!1);var i;i=null!=this._parent?this.parent:this.root,this.setXY((i.width-this.width)/2,(i.height-this.height)/2),e&&(this.addRelation(i,t.RelationType.Center_Center),this.addRelation(i,t.RelationType.Middle_Middle))},s(r,"width",function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._width},function(t){this.setSize(t,this._rawHeight)}),s(r,"height",function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._height},function(t){this.setSize(this._rawWidth,t)}),r.setSize=function(t,e,s){if(void 0===s&&(s=!1),this._rawWidth!=t||this._rawHeight!=e){this._rawWidth=t,this._rawHeight=e,0>t&&(t=0),0>e&&(e=0);var n=t-this._width,r=e-this._height;this._width=t,this._height=e,this.handleSizeChanged(),(0!=this._pivotX||0!=this._pivotY)&&(this._pivotAsAnchor?(s||this.setXY(this.x-this._pivotX*n,this.y-this._pivotY*r),this.updatePivotOffset()):this.applyPivot()),this.updateGear(2),this._parent&&(this._relations.onOwnerSizeChanged(n,r),this._parent.setBoundsChangedFlag()),this.dispatchEventWith(i.SIZE_CHANGED)}},r.ensureSizeCorrect=function(){},s(r,"sourceHeight",function(){return this._sourceHeight}),s(r,"sourceWidth",function(){return this._sourceWidth}),s(r,"initHeight",function(){return this._initHeight}),s(r,"initWidth",function(){return this._initWidth}),s(r,"actualWidth",function(){return this.width*Math.abs(this._scaleX)}),s(r,"actualHeight",function(){return this.height*Math.abs(this._scaleY)}),s(r,"scaleX",function(){return this._scaleX},function(t){this.setScale(t,this._scaleY)}),s(r,"scaleY",function(){return this._scaleY},function(t){this.setScale(this._scaleX,t)}),r.setScale=function(t,e){(this._scaleX!=t||this._scaleY!=e)&&(this._scaleX=t,this._scaleY=e,this.handleScaleChanged(),this.applyPivot(),this.updateGear(2))},s(r,"skewX",function(){return this._skewX},function(t){this.setSkew(t,this._skewY)}),s(r,"skewY",function(){return this._skewY},function(t){this.setSkew(this._skewX,t)}),r.setSkew=function(t,e){(this._skewX!=t||this._skewY!=e)&&(this._skewX=t,this._skewY=e,null!=this._displayObject&&(this._displayObject.skewX=t,this._displayObject.skewY=e),this.applyPivot())},s(r,"pivotX",function(){return this._pivotX},function(t){this.setPivot(t,this._pivotY)}),s(r,"pivotY",function(){return this._pivotY},function(t){this.setPivot(this._pivotX,t)}),r.setPivot=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),(this._pivotX!=t||this._pivotY!=e||this._pivotAsAnchor!=i)&&(this._pivotX=t,this._pivotY=e,this._pivotAsAnchor=i,this.updatePivotOffset(),this.handleXYChanged())},r.internalSetPivot=function(t,e,i){void 0===e&&(e=0),this._pivotX=t,this._pivotY=e,this._pivotAsAnchor=i,i&&this.handleXYChanged()},r.updatePivotOffset=function(){if(null!=this._displayObject)if(0!=this._pivotX||0!=this._pivotY){var t,e;0==this._sizeImplType?(t=this._pivotX*this._width,e=this._pivotY*this._height):(t=this._pivotX*this._sourceWidth,e=this._pivotY*this._sourceHeight);var s=this._displayObject.matrix.transformPoint(t,e,i.sHelperPoint);this._pivotOffsetX=this._pivotX*this._width-(s.x-this._displayObject.x),this._pivotOffsetY=this._pivotY*this._height-(s.y-this._displayObject.y)}else this._pivotOffsetX=0,this._pivotOffsetY=0},r.applyPivot=function(){(0!=this._pivotX||0!=this._pivotY)&&(this.updatePivotOffset(),this.handleXYChanged())},s(r,"touchable",function(){return this._touchable},function(e){this._touchable=e,this instanceof t.GImage||this instanceof t.GMovieClip||!(!(this instanceof t.GTextField)||this instanceof t.GTextInput||this instanceof t.GRichTextField)||null!=this._displayObject&&(this._displayObject.touchEnabled=this._touchable,this._displayObject instanceof egret.DisplayObjectContainer&&(this._displayObject.touchChildren=this._touchable))}),s(r,"grayed",function(){return this._grayed},function(t){this._grayed!=t&&(this._grayed=t,this.handleGrayedChanged(),this.updateGear(3))}),s(r,"enabled",function(){return!this._grayed&&this._touchable},function(t){this.grayed=!t,this.touchable=t}),s(r,"rotation",function(){return this._rotation},function(t){this._rotation!=t&&(this._rotation=t,this._displayObject&&(this._displayObject.rotation=this.normalizeRotation),this.applyPivot(),this.updateGear(3))}),s(r,"normalizeRotation",function(){var t=this._rotation%360;return t>180?t-=360:-180>t&&(t+=360),t}),s(r,"alpha",function(){return this._alpha},function(t){this._alpha!=t&&(this._alpha=t,this.updateAlpha())}),r.updateAlpha=function(){this._displayObject&&(this._displayObject.alpha=this._alpha),this.updateGear(3)},s(r,"visible",function(){return this._visible},function(t){this._visible!=t&&(this._visible=t,this._displayObject&&(this._displayObject.visible=this._visible),this._parent&&(this._parent.childStateChanged(this),this._parent.setBoundsChangedFlag()))}),s(r,"internalVisible",function(){return this._internalVisible},function(t){0>t&&(t=0);var e=this._internalVisible>0,i=t>0;this._internalVisible=t,e!=i&&this._parent&&this._parent.childStateChanged(this)}),s(r,"finalVisible",function(){return this._visible&&this._internalVisible>0&&(!this._group||this._group.finalVisible)}),s(r,"sortingOrder",function(){return this._sortingOrder},function(t){if(0>t&&(t=0),this._sortingOrder!=t){var e=this._sortingOrder;this._sortingOrder=t,null!=this._parent&&this._parent.childSortingOrderChanged(this,e,this._sortingOrder)}}),s(r,"focusable",function(){return this._focusable},function(t){this._focusable=t}),s(r,"focused",function(){return this.root.focus==this}),r.requestFocus=function(){for(var t=this;t&&!t._focusable;)t=t.parent;null!=t&&(this.root.focus=t)},s(r,"tooltips",function(){return this._tooltips},function(t){this._tooltips=t}),s(r,"blendMode",function(){return this._displayObject.blendMode},function(t){this._displayObject.blendMode=t}),s(r,"filters",function(){return this._displayObject.filters},function(t){this._displayObject.filters=t}),s(r,"inContainer",function(){return null!=this._displayObject&&null!=this._displayObject.parent}),s(r,"onStage",function(){return null!=this._displayObject&&null!=this._displayObject.stage}),s(r,"resourceURL",function(){return null!=this.packageItem?"ui://"+this.packageItem.owner.id+this.packageItem.id:null}),s(r,"group",function(){return this._group},function(t){this._group=t}),r.getGear=function(e){var i=this._gears[e];if(null==i){switch(e){case 0:i=new t.GearDisplay(this);break;case 1:i=new t.GearXY(this);break;case 2:i=new t.GearSize(this);break;case 3:i=new t.GearLook(this);break;case 4:i=new t.GearColor(this);break;case 5:i=new t.GearAnimation(this);break;case 6:i=new t.GearText(this);break;case 7:i=new t.GearIcon(this);break;default:throw"FairyGUI: invalid gear index!"}this._gears[e]=i}return i},r.updateGear=function(t){null!=this._gears[t]&&this._gears[t].updateState()},r.updateGearFromRelations=function(t,e,i){null!=this._gears[t]&&this._gears[t].updateFromRelations(e,i)},s(r,"gearXY",function(){return this.getGear(1)}),s(r,"gearSize",function(){return this.getGear(2)}),s(r,"gearLook",function(){return this.getGear(3)}),s(r,"relations",function(){return this._relations}),r.addRelation=function(t,e,i){void 0===i&&(i=!1),this._relations.add(t,e,i)},r.removeRelation=function(t,e){void 0===e&&(e=0),this._relations.remove(t,e)},s(r,"displayObject",function(){return this._displayObject}),r.setDisplayObject=function(t){this._displayObject=t},s(r,"parent",function(){return this._parent},function(t){this._parent=t}),r.removeFromParent=function(){this._parent&&this._parent.removeChild(this)},s(r,"root",function(){if(this instanceof t.GRoot)return this;for(var e=this._parent;e;){if(e instanceof t.GRoot)return e;e=e.parent}return t.GRoot.inst}),s(r,"asCom",function(){return this instanceof t.GComponent?this:null}),s(r,"asButton",function(){return this instanceof t.GButton?this:null}),s(r,"asLabel",function(){return this instanceof t.GLabel?this:null}),s(r,"asProgress",function(){return this instanceof t.GProgressBar?this:null}),s(r,"asTextField",function(){return this instanceof t.GTextField?this:null}),s(r,"asRichTextField",function(){return this instanceof t.GRichTextField?this:null}),s(r,"asTextInput",function(){return this instanceof t.GTextInput?this:null}),s(r,"asLoader",function(){return this instanceof t.GLoader?this:null}),s(r,"asList",function(){return this instanceof t.GList?this:null}),s(r,"asGraph",function(){return this instanceof t.GGraph?this:null}),s(r,"asGroup",function(){return this instanceof t.GGroup?this:null}),s(r,"asSlider",function(){return this instanceof t.GSlider?this:null}),s(r,"asComboBox",function(){return this instanceof t.GComboBox?this:null}),s(r,"asImage",function(){return this instanceof t.GImage?this:null}),s(r,"asMovieClip",function(){return this instanceof t.GMovieClip?this:null}),i.cast=function(t){return t.$owner},s(r,"text",function(){return null},function(t){}),s(r,"icon",function(){return null},function(t){}),r.dispose=function(){this.removeFromParent(),this._relations.dispose()},r.addClickListener=function(t,e){this.addEventListener(egret.TouchEvent.TOUCH_TAP,t,e)},r.removeClickListener=function(t,e){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,t,e)},r.hasClickListener=function(){return this.hasEventListener(egret.TouchEvent.TOUCH_TAP)},r.addEventListener=function(t,i,s){e.prototype.addEventListener.call(this,t,i,s),null!=this._displayObject&&this._displayObject.addEventListener(t,this._reDispatch,this)},r.removeEventListener=function(t,i,s){e.prototype.removeEventListener.call(this,t,i,s),null==this._displayObject||this.hasEventListener(t)||this._displayObject.removeEventListener(t,this._reDispatch,this)},r._reDispatch=function(t){this.dispatchEvent(t)},s(r,"draggable",function(){return this._draggable},function(t){this._draggable!=t&&(this._draggable=t,this.initDrag())}),s(r,"dragBounds",function(){return this._dragBounds},function(t){this._dragBounds=t}),r.startDrag=function(t){void 0===t&&(t=-1),null!=this._displayObject.stage&&this.dragBegin(null)},r.stopDrag=function(){this.dragEnd()},s(r,"dragging",function(){return i.draggingObject==this}),r.localToGlobal=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),this._pivotAsAnchor&&(t+=this._pivotX*this._width,e+=this._pivotY*this._height),this._displayObject.localToGlobal(t,e,i)},r.globalToLocal=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0);var s=this._displayObject.globalToLocal(t,e,i);return this._pivotAsAnchor&&(s.x-=this._pivotX*this._width,s.y-=this._pivotY*this._height),s},r.localToRoot=function(e,i,s){void 0===e&&(e=0),void 0===i&&(i=0);var n=this._displayObject.localToGlobal(e,i,s);return n.x/=t.GRoot.contentScaleFactor,n.y/=t.GRoot.contentScaleFactor,n},r.rootToLocal=function(e,i,s){return void 0===e&&(e=0),void 0===i&&(i=0),e*=t.GRoot.contentScaleFactor,i*=t.GRoot.contentScaleFactor,this._displayObject.globalToLocal(e,i,s)},r.localToGlobalRect=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),null==n&&(n=new egret.Rectangle);var r=this.localToGlobal(t,e);return n.x=r.x,n.y=r.y,r=this.localToGlobal(t+i,e+s),n.right=r.x,n.bottom=r.y,n},r.globalToLocalRect=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),null==n&&(n=new egret.Rectangle);var r=this.globalToLocal(t,e);return n.x=r.x,n.y=r.y,r=this.globalToLocal(t+i,e+s),n.right=r.x,n.bottom=r.y,n},r.handleControllerChanged=function(t){for(var e=0;8>e;e++){var i=this._gears[e];null!=i&&i.controller==t&&i.apply()}},r.createDisplayObject=function(){},r.switchDisplayObject=function(t){if(t!=this._displayObject){var e=this._displayObject;if(null!=this._displayObject.parent){var i=this._displayObject.parent.getChildIndex(this._displayObject);this._displayObject.parent.addChildAt(t,i),this._displayObject.parent.removeChild(this._displayObject)}this._displayObject=t,this._displayObject.x=e.x,this._displayObject.y=e.y,this._displayObject.rotation=e.rotation,this._displayObject.alpha=e.alpha,this._displayObject.visible=e.visible,this._displayObject.touchEnabled=e.touchEnabled,this._displayObject.scaleX=e.scaleX,this._displayObject.scaleY=e.scaleY,this._displayObject instanceof egret.DisplayObjectContainer&&(this._displayObject.touchChildren=this._touchable)
}},r.handleXYChanged=function(){if(this._displayObject){var t=this._x,e=this._y+this._yOffset;this._pivotAsAnchor&&(t-=this._pivotX*this._width,e-=this._pivotY*this._height),this._pixelSnapping&&(t=Math.round(t),e=Math.round(e)),this._displayObject.x=t+this._pivotOffsetX,this._displayObject.y=e+this._pivotOffsetY}},r.handleSizeChanged=function(){null!=this._displayObject&&1==this._sizeImplType&&0!=this._sourceWidth&&0!=this._sourceHeight&&(this._displayObject.scaleX=this._width/this._sourceWidth*this._scaleX,this._displayObject.scaleY=this._height/this._sourceHeight*this._scaleY)},r.handleScaleChanged=function(){null!=this._displayObject&&(0==this._sizeImplType||0==this._sourceWidth||0==this._sourceHeight?(this._displayObject.scaleX=this._scaleX,this._displayObject.scaleY=this._scaleY):(this._displayObject.scaleX=this._width/this._sourceWidth*this._scaleX,this._displayObject.scaleY=this._height/this._sourceHeight*this._scaleY))},r.handleGrayedChanged=function(){if(this._displayObject)if(this._grayed){var t=new egret.ColorMatrixFilter(i.colorMatrix);this._displayObject.filters=[t]}else this._displayObject.filters=null},r.constructFromResource=function(){},r.setup_beforeAdd=function(e){var i,s;if(this._id=e.attributes.id,this._name=e.attributes.name,i=e.attributes.xy,s=i.split(","),this.setXY(parseInt(s[0]),parseInt(s[1])),i=e.attributes.size,i&&(s=i.split(","),this._initWidth=parseInt(s[0]),this._initHeight=parseInt(s[1]),this.setSize(this._initWidth,this._initHeight,!0)),i=e.attributes.scale,i&&(s=i.split(","),this.setScale(parseFloat(s[0]),parseFloat(s[1]))),i=e.attributes.rotation,i&&(this.rotation=parseInt(i)),i=e.attributes.skew,i&&(s=i.split(","),this.setSkew(parseFloat(s[0]),parseFloat(s[1]))),i=e.attributes.pivot){s=i.split(",");var n=parseFloat(s[0]),r=parseFloat(s[1]);n>2&&(0!=this._sourceWidth?n/=this._sourceWidth:n=0),r>2&&(0!=this._sourceHeight?r/=this._sourceHeight:r=0),i=e.attributes.anchor,this.setPivot(n,r,"true"==i)}else this.setPivot(0,0,!1);if(i=e.attributes.alpha,i&&(this.alpha=parseFloat(i)),"false"==e.attributes.touchable&&(this.touchable=!1),"false"==e.attributes.visible&&(this.visible=!1),"true"==e.attributes.grayed&&(this.grayed=!0),this.tooltips=e.attributes.tooltips,i=e.attributes.blend,i&&(this.blendMode=i),i=e.attributes.filter)switch(i){case"color":i=e.attributes.filterData,s=i.split(",");var a=new t.ColorMatrix;a.adjustBrightness(parseFloat(s[0])),a.adjustContrast(parseFloat(s[1])),a.adjustSaturation(parseFloat(s[2])),a.adjustHue(parseFloat(s[3]));var h=new egret.ColorMatrixFilter(a.matrix);this.filters=[h]}},r.setup_afterAdd=function(t){var e,s=t.attributes.group;s&&(this._group=this._parent.getChildById(s));var n=t.children;if(n)for(var r=n.length,a=0;r>a;a++){var e=n[a],h=i.GearXMLKeys[e.name];void 0!=h&&this.getGear(h).setup(e)}},r.initDrag=function(){this._draggable?this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__begin,this):this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__begin,this)},r.dragBegin=function(e){null!=i.draggingObject&&i.draggingObject.stopDrag(),null!=e?(i.sGlobalDragStart.x=e.stageX,i.sGlobalDragStart.y=e.stageY):(i.sGlobalDragStart.x=t.GRoot.mouseX,i.sGlobalDragStart.y=t.GRoot.mouseY),this.localToGlobalRect(0,0,this.width,this.height,i.sGlobalRect),i.draggingObject=this,t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving2,this),t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__end2,this)},r.dragEnd=function(){i.draggingObject==this&&(t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving2,this),t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__end2,this),i.draggingObject=null)},r.reset=function(){t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving,this),t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__end,this)},r.__begin=function(e){null==this._touchDownPoint&&(this._touchDownPoint=new egret.Point),this._touchDownPoint.x=e.stageX,this._touchDownPoint.y=e.stageY,t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving,this),t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__end,this)},r.__end=function(t){this.reset()},r.__moving=function(e){var i=t.UIConfig.touchDragSensitivity;if(!(null!=this._touchDownPoint&&Math.abs(this._touchDownPoint.x-e.stageX)<i&&Math.abs(this._touchDownPoint.y-e.stageY)<i)){this.reset();var s=new t.DragEvent(t.DragEvent.DRAG_START);s.stageX=e.stageX,s.stageY=e.stageY,s.touchPointID=e.touchPointID,this.dispatchEvent(s),s.isDefaultPrevented()||this.dragBegin(e)}},r.__moving2=function(e){var s=e.stageX-i.sGlobalDragStart.x+i.sGlobalRect.x,n=e.stageY-i.sGlobalDragStart.y+i.sGlobalRect.y;if(null!=this._dragBounds){var r=t.GRoot.inst.localToGlobalRect(this._dragBounds.x,this._dragBounds.y,this._dragBounds.width,this._dragBounds.height,i.sDragHelperRect);s<r.x?s=r.x:s+i.sGlobalRect.width>r.right&&(s=r.right-i.sGlobalRect.width,s<r.x&&(s=r.x)),n<r.y?n=r.y:n+i.sGlobalRect.height>r.bottom&&(n=r.bottom-i.sGlobalRect.height,n<r.y&&(n=r.y))}i.sUpdateInDragging=!0;var a=this.parent.globalToLocal(s,n,i.sHelperPoint);this.setXY(Math.round(a.x),Math.round(a.y)),i.sUpdateInDragging=!1;var h=new t.DragEvent(t.DragEvent.DRAG_MOVING);h.stageX=e.stageX,h.stageY=e.stageY,h.touchPointID=e.touchPointID,this.dispatchEvent(h)},r.__end2=function(e){if(i.draggingObject==this){this.stopDrag();var s=new t.DragEvent(t.DragEvent.DRAG_END);s.stageX=e.stageX,s.stageY=e.stageY,s.touchPointID=e.touchPointID,this.dispatchEvent(s)}},i._gInstanceCounter=0,i.XY_CHANGED="__xyChanged",i.SIZE_CHANGED="__sizeChanged",i.SIZE_DELAY_CHANGE="__sizeDelayChange",i.GEAR_STOP="gearStop",i.colorMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i.GearXMLKeys={gearDisplay:0,gearXY:1,gearSize:2,gearLook:3,gearColor:4,gearAni:5,gearText:6,gearIcon:7},i.sGlobalDragStart=new egret.Point,i.sGlobalRect=new egret.Rectangle,i.sHelperPoint=new egret.Point,i.sDragHelperRect=new egret.Rectangle,i}(egret.EventDispatcher);t.GObject=e,egret.registerClass(e,"fairygui.GObject")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(t,e){this.packageItem=t,this.type=e}var e=(__define,t);e.prototype;return t}();t.DisplayListItem=e,egret.registerClass(e,"fairygui.DisplayListItem")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){this.width=0,this.height=0,this.tileGridIndice=0,this.interval=0,this.repeatDelay=0}var e=(__define,t),i=e.prototype;return i.load=function(){return this.owner.getItemAsset(this)},i.toString=function(){return this.name},t}();t.PackageItem=e,egret.registerClass(e,"fairygui.PackageItem")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._sortingChildCount=0,this._children=new Array,this._controllers=new Array,this._transitions=new Array,this._margin=new t.Margin,this._alignOffset=new egret.Point}__extends(i,e);var s=__define,n=i,r=n.prototype;return r.createDisplayObject=function(){this._rootContainer=new t.UIContainer,this._rootContainer.$owner=this,this.setDisplayObject(this._rootContainer),this._container=this._rootContainer},r.dispose=function(){var t,i=this._transitions.length;for(t=0;i>t;++t){var s=this._transitions[t];s.dispose()}var n=this._children.length;for(t=n-1;t>=0;--t){var r=this._children[t];r.parent=null,r.dispose()}this._boundsChanged=!1,e.prototype.dispose.call(this)},s(r,"displayListContainer",function(){return this._container}),r.addChild=function(t){return this.addChildAt(t,this._children.length),t},r.addChildAt=function(t,e){if(void 0===e&&(e=0),!t)throw"child is null";var i=this._children.length;if(e>=0&&i>=e){if(t.parent==this)this.setChildIndex(t,e);else{t.removeFromParent(),t.parent=this;var s=this._children.length;0!=t.sortingOrder?(this._sortingChildCount++,e=this.getInsertPosForSortingChild(t)):this._sortingChildCount>0&&e>s-this._sortingChildCount&&(e=s-this._sortingChildCount),e==s?this._children.push(t):this._children.splice(e,0,t),this.childStateChanged(t),this.setBoundsChangedFlag()}return t}throw"Invalid child index"},r.getInsertPosForSortingChild=function(t){var e=this._children.length,i=0;for(i=0;e>i;i++){var s=this._children[i];if(s!=t&&t.sortingOrder<s.sortingOrder)break}return i},r.removeChild=function(t,e){void 0===e&&(e=!1);var i=this._children.indexOf(t);return-1!=i&&this.removeChildAt(i,e),t},r.removeChildAt=function(t,e){if(void 0===e&&(e=!1),t>=0&&t<this.numChildren){var i=this._children[t];return i.parent=null,0!=i.sortingOrder&&this._sortingChildCount--,this._children.splice(t,1),i.inContainer&&this._container.removeChild(i.displayObject),e&&i.dispose(),this.setBoundsChangedFlag(),i}throw"Invalid child index"},r.removeChildren=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=!1),(0>e||e>=this.numChildren)&&(e=this.numChildren-1);for(var s=t;e>=s;++s)this.removeChildAt(t,i)},r.getChildAt=function(t){if(void 0===t&&(t=0),t>=0&&t<this.numChildren)return this._children[t];throw"Invalid child index"},r.getChild=function(t){for(var e=this._children.length,i=0;e>i;++i)if(this._children[i].name==t)return this._children[i];return null},r.getVisibleChild=function(t){for(var e=this._children.length,i=0;e>i;++i){var s=this._children[i];if(s.finalVisible&&s.name==t)return s}return null},r.getChildInGroup=function(t,e){for(var i=this._children.length,s=0;i>s;++s){var n=this._children[s];if(n.group==e&&n.name==t)return n}return null},r.getChildById=function(t){for(var e=this._children.length,i=0;e>i;++i)if(this._children[i]._id==t)return this._children[i];return null},r.getChildIndex=function(t){return this._children.indexOf(t)},r.setChildIndex=function(t,e){void 0===e&&(e=0);var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0==t.sortingOrder){var s=this._children.length;this._sortingChildCount>0&&e>s-this._sortingChildCount-1&&(e=s-this._sortingChildCount-1),this._setChildIndex(t,i,e)}},r.setChildIndexBefore=function(t,e){var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0!=t.sortingOrder)return i;var s=this._children.length;return this._sortingChildCount>0&&e>s-this._sortingChildCount-1&&(e=s-this._sortingChildCount-1),e>i?this._setChildIndex(t,i,e-1):this._setChildIndex(t,i,e)},r._setChildIndex=function(t,e,i){void 0===i&&(i=0);var s=this._children.length;if(i>s&&(i=s),e==i)return e;if(this._children.splice(e,1),this._children.splice(i,0,t),t.inContainer){for(var n=0,r=0;i>r;r++){var a=this._children[r];a.inContainer&&n++}n==this._container.numChildren&&n--,this._container.setChildIndex(t.displayObject,n),this.setBoundsChangedFlag()}return i},r.swapChildren=function(t,e){var i=this._children.indexOf(t),s=this._children.indexOf(e);if(-1==i||-1==s)throw"Not a child of this container";this.swapChildrenAt(i,s)},r.swapChildrenAt=function(t,e){void 0===e&&(e=0);var i=this._children[t],s=this._children[e];this.setChildIndex(i,e),this.setChildIndex(s,t)},s(r,"numChildren",function(){return this._children.length}),r.isAncestorOf=function(t){if(null==t)return!1;for(var e=t.parent;e;){if(e==this)return!0;e=e.parent}return!1},r.addController=function(t){this._controllers.push(t),t._parent=this,this.applyController(t)},r.getControllerAt=function(t){return this._controllers[t]},r.getController=function(t){for(var e=this._controllers.length,i=0;e>i;++i){var s=this._controllers[i];if(s.name==t)return s}return null},r.removeController=function(t){var e=this._controllers.indexOf(t);if(-1==e)throw"controller not exists";t._parent=null,this._controllers.splice(e,1);for(var i=this._children.length,s=0;i>s;s++){var n=this._children[s];n.handleControllerChanged(t)}},s(r,"controllers",function(){return this._controllers}),r.childStateChanged=function(e){if(!this._buildingDisplayList)if(e instanceof t.GGroup)for(var i=this._children.length,s=0;i>s;s++){var n=this._children[s];n.group==e&&this.childStateChanged(n)}else if(e.displayObject)if(e.finalVisible){if(!e.displayObject.parent){for(var r=0,a=this._children.length,h=0;a>h&&(n=this._children[h],n!=e);h++)n.displayObject&&n.displayObject.parent&&r++;this._container.addChildAt(e.displayObject,r)}}else e.displayObject.parent&&this._container.removeChild(e.displayObject)},r.applyController=function(t){for(var e,i=this._children.length,s=0;i>s;s++)e=this._children[s],e.handleControllerChanged(t)},r.applyAllControllers=function(){for(var t=this._controllers.length,e=0;t>e;++e)this.applyController(this._controllers[e])},r.adjustRadioGroupDepth=function(e,i){var s,n,r=this._children.length,a=-1,h=-1;for(s=0;r>s;s++)n=this._children[s],n==e?a=s:n instanceof t.GButton&&n.relatedController==i&&s>h&&(h=s);h>a&&this.swapChildrenAt(a,h)},r.getTransitionAt=function(t){return this._transitions[t]},r.getTransition=function(t){for(var e=this._transitions.length,i=0;e>i;++i){var s=this._transitions[i];if(s.name==t)return s}return null},r.isChildInView=function(t){return null!=this._rootContainer.scrollRect?t.x+t.width>=0&&t.x<=this.width&&t.y+t.height>=0&&t.y<=this.height:null!=this._scrollPane?this._scrollPane.isChildInView(t):!0},r.getFirstChildInView=function(){for(var t=this._children.length,e=0;t>e;++e){var i=this._children[e];if(this.isChildInView(i))return e}return-1},s(r,"scrollPane",function(){return this._scrollPane}),s(r,"opaque",function(){return this._opaque},function(t){this._opaque!=t&&(this._opaque=t,this._opaque?this.updateOpaque():this._rootContainer.hitArea=null)}),s(r,"margin",function(){return this._margin},function(t){this._margin.copy(t),null!=this._rootContainer.scrollRect&&(this._container.x=this._margin.left+this._alignOffset.x,this._container.y=this._margin.top+this._alignOffset.y),this.handleSizeChanged()}),s(r,"mask",function(){return this._rootContainer.mask},function(t){this._rootContainer.mask=t}),r.updateOpaque=function(){this._rootContainer.hitArea||(this._rootContainer.hitArea=new egret.Rectangle),this._rootContainer.hitArea.setTo(0,0,this.width,this.height)},r.updateScrollRect=function(){var t=this._rootContainer.scrollRect;null==t&&(t=new egret.Rectangle);var e=this.width-this._margin.right,i=this.height-this._margin.bottom;t.setTo(0,0,e,i),this._rootContainer.scrollRect=t},r.setupScroll=function(e,i,s,n,r,a){this._rootContainer==this._container&&(this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)),this._scrollPane=new t.ScrollPane(this,i,e,s,n,r,a),this.setBoundsChangedFlag()},r.setupOverflow=function(e){e==t.OverflowType.Hidden?(this._rootContainer==this._container&&(this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)),this.updateScrollRect(),this._container.x=this._margin.left,this._container.y=this._margin.top):(0!=this._margin.left||0!=this._margin.top)&&(this._rootContainer==this._container&&(this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)),this._container.x=this._margin.left,this._container.y=this._margin.top),this.setBoundsChangedFlag()},r.handleSizeChanged=function(){this._scrollPane?this._scrollPane.onOwnerSizeChanged():null!=this._rootContainer.scrollRect&&this.updateScrollRect(),this._opaque&&this.updateOpaque()},r.handleGrayedChanged=function(){var t=this.getController("grayed");if(null!=t)return void(t.selectedIndex=this.grayed?1:0);for(var e=this.grayed,i=this._children.length,s=0;i>s;++s)this._children[s].grayed=e},r.setBoundsChangedFlag=function(){(this._scrollPane||this._trackBounds)&&(this._boundsChanged||(this._boundsChanged=!0,egret.callLater(this.__render,this)))},r.__render=function(){this._boundsChanged&&this.updateBounds()},r.ensureBoundsCorrect=function(){this._boundsChanged&&this.updateBounds()},r.updateBounds=function(){var t=0,e=0,i=0,s=0,n=this._children.length;if(n>0){t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY;var r=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,h=0,o=0;for(o=0;n>o;o++)l=this._children[o],l.ensureSizeCorrect();for(var o=0;n>o;o++){var l=this._children[o];h=l.x,t>h&&(t=h),h=l.y,e>h&&(e=h),h=l.x+l.actualWidth,h>r&&(r=h),h=l.y+l.actualHeight,h>a&&(a=h)}i=r-t,s=a-e}this.setBounds(t,e,i,s)},r.setBounds=function(t,e,i,s){void 0===s&&(s=0),this._boundsChanged=!1,this._scrollPane&&this._scrollPane.setContentSize(Math.round(t+i),Math.round(e+s))},s(r,"viewWidth",function(){return null!=this._scrollPane?this._scrollPane.viewWidth:this.width-this._margin.left-this._margin.right},function(t){null!=this._scrollPane?this._scrollPane.viewWidth=t:this.width=t+this._margin.left+this._margin.right}),s(r,"viewHeight",function(){return null!=this._scrollPane?this._scrollPane.viewHeight:this.height-this._margin.top-this._margin.bottom},function(t){null!=this._scrollPane?this._scrollPane.viewHeight=t:this.height=t+this._margin.top+this._margin.bottom}),r.getSnappingPosition=function(t,e,i){i||(i=new egret.Point);var s=this._children.length;if(0==s)return i.x=0,i.y=0,i;this.ensureBoundsCorrect();var n=null,r=null,a=0;if(0!=e){for(;s>a;a++)if(n=this._children[a],e<n.y){if(0==a){e=0;break}r=this._children[a-1],e=e<r.y+r.actualHeight/2?r.y:n.y;break}a==s&&(e=n.y)}if(0!=t){for(a>0&&a--;s>a;a++)if(n=this._children[a],t<n.x){if(0==a){t=0;break}r=this._children[a-1],t=t<r.x+r.actualWidth/2?r.x:n.x;break}a==s&&(t=n.x)}return i.x=t,i.y=e,i},r.childSortingOrderChanged=function(t,e,i){if(void 0===i&&(i=0),0==i)this._sortingChildCount--,this.setChildIndex(t,this._children.length);else{0==e&&this._sortingChildCount++;var s=this._children.indexOf(t),n=this.getInsertPosForSortingChild(t);n>s?this._setChildIndex(t,s,n-1):this._setChildIndex(t,s,n)}},r.constructFromResource=function(){this.constructFromResource2(null,0)},r.constructFromResource2=function(e,i){var s=this.packageItem.owner.getItemAsset(this.packageItem);this._underConstruct=!0;var n,r;n=s.attributes.size,r=n.split(","),this._sourceWidth=parseInt(r[0]),this._sourceHeight=parseInt(r[1]),this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this.setSize(this._sourceWidth,this._sourceHeight),n=s.attributes.pivot,n&&(r=n.split(","),n=s.attributes.anchor,this.internalSetPivot(parseFloat(r[0]),parseFloat(r[1]),"true"==n)),n=s.attributes.opaque,this.opaque="false"!=n;var a;if(n=s.attributes.overflow,a=n?t.parseOverflowType(n):t.OverflowType.Visible,n=s.attributes.margin,n&&this._margin.parse(n),a==t.OverflowType.Scroll){var h;n=s.attributes.scroll,h=n?t.parseScrollType(n):t.ScrollType.Vertical;var o;n=s.attributes.scrollBar,o=n?t.parseScrollBarDisplayType(n):t.ScrollBarDisplayType.Default;var l;n=s.attributes.scrollBarFlags,l=n?parseInt(n):0;var _=new t.Margin;n=s.attributes.scrollBarMargin,n&&_.parse(n);var c,u;n=s.attributes.scrollBarRes,n&&(r=n.split(","),c=r[0],u=r[1]),this.setupScroll(_,h,o,l,c,u)}else this.setupOverflow(a);this._buildingDisplayList=!0;var d=s.children,g=0;d&&(g=d.length);var p,f;for(p=0;g>p;p++){var v=d[p];"controller"==v.name&&(f=new t.Controller,this._controllers.push(f),f._parent=this,f.setup(v))}var m,y=this.packageItem.displayList,w=y.length;for(p=0;w>p;p++){var b=y[p];null!=e?m=e[i+p]:b.packageItem?(m=t.UIObjectFactory.newObject(b.packageItem),m.packageItem=b.packageItem,m.constructFromResource()):m=t.UIObjectFactory.newObject2(b.type),m._underConstruct=!0,m.setup_beforeAdd(b.desc),m.parent=this,this._children.push(m)}for(this.relations.setup(s),p=0;w>p;p++)this._children[p].relations.setup(y[p].desc);for(p=0;w>p;p++)m=this._children[p],m.setup_afterAdd(y[p].desc),m._underConstruct=!1;n=s.attributes.mask,n&&(this.mask=this.getChildById(n).displayObject);var C;for(p=0;g>p;p++){var v=d[p];"transition"==v.name&&(C=new t.Transition(this),this._transitions.push(C),C.setup(v))}for(this._transitions.length>0&&(this.displayObject.addEventListener(egret.Event.ADDED_TO_STAGE,this.___added,this),this.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.___removed,this)),this.applyAllControllers(),this._buildingDisplayList=!1,this._underConstruct=!1,g=this._children.length,p=0;g>p;p++){var m=this._children[p];null!=m.displayObject&&m.finalVisible&&this._container.addChild(m.displayObject)}this.setBoundsChangedFlag(),this.constructFromXML(s)},r.constructFromXML=function(t){},r.___added=function(t){for(var e=this._transitions.length,i=0;e>i;++i){var s=this._transitions[i];s.autoPlay&&s.play(null,null,null,s.autoPlayRepeat,s.autoPlayDelay)}},r.___removed=function(t){for(var e=this._transitions.length,i=0;e>i;++i){var s=this._transitions[i];s.stop(!1,!1)}},i}(t.GObject);t.GComponent=e,egret.registerClass(e,"fairygui.GComponent")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._mode=t.ButtonMode.Common,this._title="",this._icon="",this._sound=t.UIConfig.buttonSound,this._soundVolumeScale=t.UIConfig.buttonSoundVolumeScale,this._pageOption=new t.PageOption,this._changeStateOnClick=!0,this._downEffect=0,this._downEffectValue=.8}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"icon",function(){return this._icon},function(t){this._icon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,null!=this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}),s(r,"selectedIcon",function(){return this._selectedIcon},function(t){this._selectedIcon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,null!=this._iconObject&&(this._iconObject.icon=t)}),s(r,"title",function(){return this._title},function(t){this._title=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title),this.updateGear(6)}),s(r,"text",function(){return this.title},function(t){this.title=t}),s(r,"selectedTitle",function(){return this._selectedTitle},function(t){this._selectedTitle=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title)}),s(r,"titleColor",function(){return this._titleObject instanceof t.GTextField?this._titleObject.color:this._titleObject instanceof t.GLabel?this._titleObject.titleColor:this._titleObject instanceof i?this._titleObject.titleColor:0},function(e){this._titleObject instanceof t.GTextField?this._titleObject.color=e:this._titleObject instanceof t.GLabel?this._titleObject.titleColor=e:this._titleObject instanceof i&&(this._titleObject.titleColor=e)}),s(r,"sound",function(){return this._sound},function(t){this._sound=t}),s(r,"soundVolumeScale",function(){return this._soundVolumeScale},function(t){this._soundVolumeScale=t}),s(r,"selected",function(){return this._selected},function(e){if(this._mode!=t.ButtonMode.Common&&this._selected!=e){if(this._selected=e,this.grayed&&this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this._selected?this.setState(i.SELECTED_DISABLED):this.setState(i.DISABLED):this._selected?this.setState(this._over?i.SELECTED_OVER:i.DOWN):this.setState(this._over?i.OVER:i.UP),this._selectedTitle&&this._titleObject&&(this._titleObject.text=this._selected?this._selectedTitle:this._title),this._selectedIcon){var s=this._selected?this._selectedIcon:this._icon;null!=this._iconObject&&(this._iconObject.icon=s)}this._relatedController&&this._parent&&!this._parent._buildingDisplayList&&(this._selected?(this._relatedController.selectedPageId=this._pageOption.id,this._relatedController._autoRadioGroupDepth&&this._parent.adjustRadioGroupDepth(this,this._relatedController)):this._mode==t.ButtonMode.Check&&this._relatedController.selectedPageId==this._pageOption.id&&(this._relatedController.oppositePageId=this._pageOption.id))}}),s(r,"mode",function(){return this._mode},function(e){this._mode!=e&&(e==t.ButtonMode.Common&&(this.selected=!1),this._mode=e)}),s(r,"relatedController",function(){return this._relatedController},function(t){t!=this._relatedController&&(this._relatedController=t,this._pageOption.controller=t,this._pageOption.clear())}),s(r,"pageOption",function(){return this._pageOption}),s(r,"changeStateOnClick",function(){return this._changeStateOnClick},function(t){this._changeStateOnClick=t}),s(r,"linkedPopup",function(){return this._linkedPopup},function(t){this._linkedPopup=t}),r.addStateListener=function(e,i){this.addEventListener(t.StateChangeEvent.CHANGED,e,i)},r.removeStateListener=function(e,i){this.removeEventListener(t.StateChangeEvent.CHANGED,e,i)},r.fireClick=function(e){void 0===e&&(e=!0),e&&this._mode==t.ButtonMode.Common&&(this.setState(i.OVER),t.GTimers.inst.add(100,1,this.setState,this,i.DOWN),t.GTimers.inst.add(200,1,this.setState,this,i.UP)),this.__click(null)},r.setState=function(e){if(this._buttonController&&(this._buttonController.selectedPage=e),1==this._downEffect){var s=this.numChildren;if(e==i.DOWN||e==i.SELECTED_OVER||e==i.SELECTED_DISABLED)for(var n=255*this._downEffectValue,r=(n<<16)+(n<<8)+n,a=0;s>a;a++){var h=this.getChildAt(a);(h instanceof t.GImage||h instanceof t.GLoader||h instanceof t.GMovieClip)&&(h.color=r)}else for(var a=0;s>a;a++){var h=this.getChildAt(a);(h instanceof t.GImage||h instanceof t.GLoader||h instanceof t.GMovieClip)&&(h.color=16777215)}}else 2==this._downEffect&&(e==i.DOWN||e==i.SELECTED_OVER||e==i.SELECTED_DISABLED?this.setScale(this._downEffectValue,this._downEffectValue):this.setScale(1,1))},r.handleControllerChanged=function(t){e.prototype.handleControllerChanged.call(this,t),this._relatedController==t&&(this.selected=this._pageOption.id==t.selectedPageId)},r.handleGrayedChanged=function(){this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this.grayed?this._selected&&this._buttonController.hasPage(i.SELECTED_DISABLED)?this.setState(i.SELECTED_DISABLED):this.setState(i.DISABLED):this._selected?this.setState(i.DOWN):this.setState(i.UP):e.prototype.handleGrayedChanged.call(this)},r.constructFromXML=function(s){e.prototype.constructFromXML.call(this,s),s=t.ToolSet.findChildNode(s,"Button");var n;n=s.attributes.mode,n&&(this._mode=t.parseButtonMode(n)),n=s.attributes.sound,null!=n&&(this._sound=n),n=s.attributes.volume,n&&(this._soundVolumeScale=parseInt(n)/100),n=s.attributes.downEffect,n&&(this._downEffect="dark"==n?1:"scale"==n?2:0,n=s.attributes.downEffectValue,this._downEffectValue=parseFloat(n)),this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),null!=this._titleObject&&(this._title=this._titleObject.text),null!=this._iconObject&&(this._icon=this._iconObject.icon),this._mode==t.ButtonMode.Common&&this.setState(i.UP),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__mousedown,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__click,this)},r.setup_afterAdd=function(i){if(e.prototype.setup_afterAdd.call(this,i),2==this._downEffect&&this.setPivot(.5,.5),i=t.ToolSet.findChildNode(i,"Button")){var s;s=i.attributes.title,s&&(this.title=s),s=i.attributes.icon,s&&(this.icon=s),s=i.attributes.selectedTitle,s&&(this.selectedTitle=s),s=i.attributes.selectedIcon,s&&(this.selectedIcon=s),s=i.attributes.titleColor,s&&(this.titleColor=t.ToolSet.convertFromHtmlColor(s)),s=i.attributes.controller,s?this._relatedController=this._parent.getController(s):this._relatedController=null,this._pageOption.id=i.attributes.page,this.selected="true"==i.attributes.checked}},r.__rollover=function(t){this._buttonController&&this._buttonController.hasPage(i.OVER)&&(this._over=!0,this._down||this.setState(this._selected?i.SELECTED_OVER:i.OVER))},r.__rollout=function(t){this._buttonController&&this._buttonController.hasPage(i.OVER)&&(this._over=!1,this._down||this.setState(this._selected?i.DOWN:i.UP))},r.__mousedown=function(e){this._down=!0,t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this._mode==t.ButtonMode.Common&&(this.grayed&&this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this.setState(i.SELECTED_DISABLED):this.setState(i.DOWN)),null!=this._linkedPopup&&(this._linkedPopup instanceof t.Window?this._linkedPopup.toggleStatus():this.root.togglePopup(this._linkedPopup,this))},r.__mouseup=function(e){this._down&&(t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this._down=!1,this._mode==t.ButtonMode.Common&&(this.grayed&&this._buttonController&&this._buttonController.hasPage(i.DISABLED)?this.setState(i.DISABLED):this._over?this.setState(i.OVER):this.setState(i.UP)))},r.__click=function(e){if(this._sound){var i=t.UIPackage.getItemByURL(this._sound);if(i){var s=i.owner.getItemAsset(i);s&&t.GRoot.inst.playOneShotSound(s,this._soundVolumeScale)}}this._changeStateOnClick&&(this._mode==t.ButtonMode.Check?(this.selected=!this._selected,this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED))):this._mode==t.ButtonMode.Radio&&(this._selected||(this.selected=!0,this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED)))))},i.UP="up",i.DOWN="down",i.OVER="over",i.SELECTED_OVER="selectedOver",i.DISABLED="disabled",i.SELECTED_DISABLED="selectedDisabled",i}(t.GComponent);t.GButton=e,egret.registerClass(e,"fairygui.GButton")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._visibleItemCount=0,this._selectedIndex=0,this._popupDownward=!0,this._visibleItemCount=t.UIConfig.defaultComboBoxVisibleItemCount,this._itemsUpdated=!0,this._selectedIndex=-1,this._items=[],this._values=[]}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"text",function(){return this._titleObject?this._titleObject.text:null},function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)}),s(r,"icon",function(){return this._iconObject?this._iconObject.icon:null},function(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}),s(r,"titleColor",function(){return this._titleObject instanceof t.GTextField?this._titleObject.color:this._titleObject instanceof t.GLabel?this._titleObject.titleColor:this._titleObject instanceof t.GButton?this._titleObject.titleColor:0},function(e){this._titleObject instanceof t.GTextField?this._titleObject.color=e:this._titleObject instanceof t.GLabel?this._titleObject.titleColor=e:this._titleObject instanceof t.GButton&&(this._titleObject.titleColor=e)}),s(r,"visibleItemCount",function(){return this._visibleItemCount},function(t){this._visibleItemCount=t}),s(r,"popupDownward",function(){return this._popupDownward},function(t){this._popupDownward=t}),s(r,"items",function(){return this._items},function(t){t?this._items=t.concat():this._items.length=0,this._items.length>0?(this._selectedIndex>=this._items.length?this._selectedIndex=this._items.length-1:-1==this._selectedIndex&&(this._selectedIndex=0),this.text=this._items[this._selectedIndex],null!=this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",null!=this._icons&&(this.icon=null),this._selectedIndex=-1),this._itemsUpdated=!0}),s(r,"icons",function(){return this._icons},function(t){this._icons=t,null!=this._icons&&-1!=this._selectedIndex&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])}),s(r,"values",function(){return this._values},function(t){t?this._values=t.concat():this._values.length=0}),s(r,"selectedIndex",function(){return this._selectedIndex},function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this.selectedIndex>=0&&this.selectedIndex<this._items.length?(this.text=this._items[this._selectedIndex],null!=this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",null!=this._icons&&(this.icon=null)))}),s(r,"value",function(){return this._values[this._selectedIndex]},function(t){this.selectedIndex=this._values.indexOf(t)}),r.setState=function(t){this._buttonController&&(this._buttonController.selectedPage=t)},r.constructFromXML=function(i){e.prototype.constructFromXML.call(this,i),i=t.ToolSet.findChildNode(i,"ComboBox");var s;if(this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),s=i.attributes.dropdown){if(this.dropdown=t.UIPackage.createObjectFromURL(s),!this.dropdown)return void console.error("");
if(this.dropdown.name="this.dropdown",this._list=this.dropdown.getChild("list").asList,null==this._list)return void console.error(this.resourceURL+": list");this._list.addEventListener(t.ItemEvent.CLICK,this.__clickItem,this),this._list.addRelation(this.dropdown,t.RelationType.Width),this._list.removeRelation(this.dropdown,t.RelationType.Height),this.dropdown.addRelation(this._list,t.RelationType.Height),this.dropdown.removeRelation(this._list,t.RelationType.Width),this.dropdown.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.__popupWinClosed,this)}this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__mousedown,this)},r.dispose=function(){this.dropdown&&(this.dropdown.dispose(),this.dropdown=null),e.prototype.dispose.call(this)},r.setup_afterAdd=function(i){if(e.prototype.setup_afterAdd.call(this,i),i=t.ToolSet.findChildNode(i,"ComboBox")){var s;s=i.attributes.titleColor,s&&(this.titleColor=t.ToolSet.convertFromHtmlColor(s)),s=i.attributes.visibleItemCount,s&&(this._visibleItemCount=parseInt(s));var n=i.children;if(n)for(var r=n.length,a=0;r>a;a++){var h=n[a];"item"==h.name&&(this._items.push(h.attributes.title),this._values.push(h.attributes.value),s=h.attributes.icon,s&&(this._icons||(this._icons=new Array(r)),this._icons[a]=s))}s=i.attributes.title,s?(this.text=s,this._selectedIndex=this._items.indexOf(s)):this._items.length>0?(this._selectedIndex=0,this.text=this._items[0]):this._selectedIndex=-1,s=i.attributes.icon,s&&(this.icon=s),s=i.attributes.direction,s&&("up"==s?this._popupDownward=!1:"auto"==s&&(this._popupDownward=null))}},r.showDropdown=function(){if(this._itemsUpdated){this._itemsUpdated=!1,this._list.removeChildrenToPool();for(var e=this._items.length,i=0;e>i;i++){var s=this._list.addItemFromPool();s.name=i<this._values.length?this._values[i]:"",s.text=this._items[i],s.icon=null!=this._icons&&i<this._icons.length?this._icons[i]:null}this._list.resizeToFit(this._visibleItemCount)}this._list.selectedIndex=-1,this.dropdown.width=this.width,this.root.togglePopup(this.dropdown,this,this._popupDownward),this.dropdown.parent&&this.setState(t.GButton.DOWN)},r.__popupWinClosed=function(e){this._over?this.setState(t.GButton.OVER):this.setState(t.GButton.UP)},r.__clickItem=function(e){t.GTimers.inst.add(100,1,this.__clickItem2,this,this._list.getChildIndex(e.itemObject))},r.__clickItem2=function(e){this.dropdown.parent instanceof t.GRoot&&this.dropdown.parent.hidePopup(),this._selectedIndex=e,this._selectedIndex>=0?this.text=this._items[this._selectedIndex]:this.text="",this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED))},r.__rollover=function(e){this._over=!0,this._down||this.dropdown&&this.dropdown.parent||this.setState(t.GButton.OVER)},r.__rollout=function(e){this._over=!1,this._down||this.dropdown&&this.dropdown.parent||this.setState(t.GButton.UP)},r.__mousedown=function(e){e.target instanceof egret.TextField&&e.target.type==egret.TextFieldType.INPUT||(this._down=!0,t.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this.dropdown&&this.showDropdown())},r.__mouseup=function(e){this._down&&(this._down=!1,t.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this.dropdown&&!this.dropdown.parent&&(this._over?this.setState(t.GButton.OVER):this.setState(t.GButton.UP)))},i}(t.GComponent);t.GComboBox=e,egret.registerClass(e,"fairygui.GComboBox")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(e){t.call(this,e)}__extends(e,t);var s=(__define,e),n=s.prototype;return n.init=function(){this._default=new i(this._owner.playing,this._owner.frame),this._storage={}},n.addStatus=function(t,e){if("-"!=e){var s;null==t?s=this._default:(s=new i,this._storage[t]=s);var n=e.split(",");s.frame=parseInt(n[0]),s.playing="p"==n[1]}},n.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];t||(t=this._default),this._owner.frame=t.frame,this._owner.playing=t.playing,this._owner._gearLocked=!1},n.updateState=function(){if(null!=this._controller&&!this._owner._gearLocked&&!this._owner._underConstruct){var t=this._owner,e=this._storage[this._controller.selectedPageId];e||(e=new i,this._storage[this._controller.selectedPageId]=e),e.frame=t.frame,e.playing=t.playing}},e}(t.GearBase);t.GearAnimation=e,egret.registerClass(e,"fairygui.GearAnimation");var i=function(){function t(t,e){void 0===t&&(t=!0),void 0===e&&(e=0),this.playing=t,this.frame=e}var e=(__define,t);e.prototype;return t}();egret.registerClass(i,"GearAnimationValue")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(t){e.call(this,t),this._default=0}__extends(i,e);var s=(__define,i),n=s.prototype;return n.init=function(){this._default=this._owner.color,this._storage={}},n.addStatus=function(e,i){if("-"!=i){var s=t.ToolSet.convertFromHtmlColor(i);null==e?this._default=s:this._storage[e]=s}},n.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];void 0!=t?this._owner.color=Math.floor(t):this._owner.color=Math.floor(this._default),this._owner._gearLocked=!1},n.updateState=function(){null==this._controller||this._owner._gearLocked||this._owner._underConstruct||(this._storage[this._controller.selectedPageId]=this._owner.color)},i}(t.GearBase);t.GearColor=e,egret.registerClass(e,"fairygui.GearColor")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.init=function(){this.pages=null},s.apply=function(){this._controller&&null!=this.pages&&0!=this.pages.length&&-1==this.pages.indexOf(this._controller.selectedPageId)?this._owner.internalVisible=0:this._owner.internalVisible++},e}(t.GearBase);t.GearDisplay=e,egret.registerClass(e,"fairygui.GearDisplay")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function s(t){e.call(this,t)}__extends(s,e);var n=(__define,s),r=n.prototype;return r.init=function(){this._default=new i(this._owner.alpha,this._owner.rotation,this._owner.grayed),this._storage={}},r.addStatus=function(t,e){if("-"!=e){var s,n=e.split(",");null==t?s=this._default:(s=new i,this._storage[t]=s),s.alpha=parseFloat(n[0]),s.rotation=parseInt(n[1]),s.grayed="1"==n[2]?!0:!1}},r.apply=function(){var e=this._storage[this._controller.selectedPageId];if(e||(e=this._default),!this._tween||t.UIPackage._constructing||t.GearBase.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.grayed=e.grayed,this._owner.alpha=e.alpha,this._owner.rotation=e.rotation,this._owner._gearLocked=!1;else{if(this._owner._gearLocked=!0,this._owner.grayed=e.grayed,this._owner._gearLocked=!1,null!=this.tweener){if(this._tweenTarget.alpha==e.alpha&&this._tweenTarget.rotation==e.rotation)return;this.tweener.tick?this.tweener.tick(1e8):this.tweener.$tick(1e8),this.tweener=null}var i=e.alpha!=this._owner.alpha,s=e.rotation!=this._owner.rotation;if(i||s){this._owner.internalVisible++,this._tweenTarget=e;var n={onChange:function(){this._owner._gearLocked=!0,i&&(this._owner.alpha=this._tweenValue.x),s&&(this._owner.rotation=this._tweenValue.y),this._owner._gearLocked=!1},onChangeObj:this};null==this._tweenValue&&(this._tweenValue=new egret.Point),this._tweenValue.x=this._owner.alpha,this._tweenValue.y=this._owner.rotation,this.tweener=egret.Tween.get(this._tweenValue,n).wait(1e3*this._tweenDelay).to({x:e.alpha,y:e.rotation},1e3*this._tweenTime,this._easeType).call(function(){this._owner.internalVisible--,this._tweener=null,this._owner.dispatchEventWith(t.GObject.GEAR_STOP,!1)},this)}}},r.updateState=function(){if(null!=this._controller&&!this._owner._gearLocked&&!this._owner._underConstruct){var t=this._storage[this._controller.selectedPageId];t||(t=new i,this._storage[this._controller.selectedPageId]=t),t.alpha=this._owner.alpha,t.rotation=this._owner.rotation,t.grayed=this._owner.grayed}},s}(t.GearBase);t.GearLook=e,egret.registerClass(e,"fairygui.GearLook");var i=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=!1),this.alpha=t,this.rotation=e,this.grayed=i}var e=(__define,t);e.prototype;return t}();egret.registerClass(i,"GearLookValue")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._type=0,this._lineSize=0,this._lineColor=0,this._fillColor=0,this._lineSize=1,this._lineAlpha=1,this._fillAlpha=1,this._fillColor=16777215}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"graphics",function(){return this._graphics?this._graphics:(this.delayCreateDisplayObject(),this._graphics=this.displayObject.graphics,this._graphics)}),r.drawRect=function(t,e,i,s,n,r){void 0===r&&(r=null),this._type=1,this._lineSize=t,this._lineColor=e,this._lineAlpha=i,this._fillColor=s,this._fillAlpha=n,this._corner=r,this.drawCommon()},r.drawEllipse=function(t,e,i,s,n){this._type=2,this._lineSize=t,this._lineColor=e,this._lineAlpha=i,this._fillColor=s,this._fillAlpha=n,this._corner=null,this.drawCommon()},r.clearGraphics=function(){this._graphics&&(this._type=0,this._graphics.clear())},r.drawCommon=function(){this.graphics,this._graphics.clear();var t=this.width,e=this.height;0!=t&&0!=e&&(0==this._lineSize?this._graphics.lineStyle(0,0,0):this._graphics.lineStyle(this._lineSize,this._lineColor,this._lineAlpha),this._graphics.beginFill(this._fillColor,this._fillAlpha),1==this._type?this._corner?1==this._corner.length?this._graphics.drawRoundRect(0,0,t,e,this._corner[0],this._corner[0]):this._graphics.drawRoundRect(0,0,t,e,this._corner[0],this._corner[1]):this._graphics.drawRect(0,0,t,e):this._graphics.drawEllipse(0,0,t,e),this._graphics.endFill())},r.replaceMe=function(t){if(!this._parent)throw"parent not set";t.name=this.name,t.alpha=this.alpha,t.rotation=this.rotation,t.visible=this.visible,t.touchable=this.touchable,t.grayed=this.grayed,t.setXY(this.x,this.y),t.setSize(this.width,this.height);var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e),t.relations.copyFrom(this.relations),this._parent.removeChild(this,!0)},r.addBeforeMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e)},r.addAfterMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);e++,this._parent.addChildAt(t,e)},r.setNativeObject=function(t){this.delayCreateDisplayObject(),this.displayObject.addChild(t)},r.delayCreateDisplayObject=function(){if(this.displayObject)this.displayObject.graphics.clear(),this.displayObject.removeChildren(),this._graphics=null;else{var e=new t.UISprite;e.$owner=this,this.setDisplayObject(e),this._parent&&this._parent.childStateChanged(this),this.handleXYChanged(),e.alpha=this.alpha,e.rotation=this.rotation,e.visible=this.visible,e.touchEnabled=this.touchable,e.touchChildren=this.touchable,e.hitArea=new egret.Rectangle(0,0,this.width,this.height)}},r.handleSizeChanged=function(){this._graphics&&0!=this._type&&this.drawCommon(),this.displayObject instanceof t.UISprite&&(null==this.displayObject.hitArea?this.displayObject.hitArea=new egret.Rectangle(0,0,this.width,this.height):(this.displayObject.hitArea.width=this.width,this.displayObject.hitArea.height=this.height))},r.setup_beforeAdd=function(i){var s,n=i.attributes.type;if(n&&"empty"!=n){var r=new t.UISprite;r.$owner=this,this.setDisplayObject(r)}if(e.prototype.setup_beforeAdd.call(this,i),null!=this.displayObject){if(this._graphics=this.displayObject.graphics,s=i.attributes.lineSize,s&&(this._lineSize=parseInt(s)),s=i.attributes.lineColor){var a=t.ToolSet.convertFromHtmlColor(s,!0);this._lineColor=16777215&a,this._lineAlpha=(a>>24&255)/255}s=i.attributes.fillColor,s&&(a=t.ToolSet.convertFromHtmlColor(s,!0),this._fillColor=16777215&a,this._fillAlpha=(a>>24&255)/255);var h;s=i.attributes.corner,s&&(h=s.split(","),h.length>1?this._corner=[parseInt(h[0]),parseInt(h[1])]:this._corner=[parseInt(h[0])]),"rect"==n?this._type=1:this._type=2,this.drawCommon()}},i}(t.GObject);t.GGraph=e,egret.registerClass(e,"fairygui.GGraph")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.updateBounds=function(){if(!this._updating&&this.parent){var t,e=this._parent.numChildren,i=0,s=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,h=0;for(this._empty=!0,i=0;e>i;i++)t=this._parent.getChildAt(i),t.group==this&&(h=t.x,s>h&&(s=h),h=t.y,n>h&&(n=h),h=t.x+t.width,h>r&&(r=h),h=t.y+t.height,h>a&&(a=h),this._empty=!1);this._updating=!0,this._empty?this.setSize(0,0):(this.setXY(s,n),this.setSize(r-s,a-n)),this._updating=!1}},s.moveChildren=function(t,e){if(!this._updating&&this.parent){this._updating=!0;var i,s=this._parent.numChildren,n=0;for(n=0;s>n;n++)i=this._parent.getChildAt(n),i.group==this&&i.setXY(i.x+t,i.y+e);this._updating=!1}},s.updateAlpha=function(){if(t.prototype.updateAlpha.call(this),!this._underConstruct){var e,i,s=this._parent.numChildren;for(e=0;s>e;e++)i=this._parent.getChildAt(e),i.group==this&&(i.alpha=this.alpha)}},e}(t.GObject);t.GGroup=e,egret.registerClass(e,"fairygui.GGroup")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._color=16777215}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this.updateGear(4),this.applyColor())}),r.applyColor=function(){},s(r,"flip",function(){return this._flip},function(e){this._flip!=e&&(this._flip=e,this._content.scaleX=this._content.scaleY=1,(this._flip==t.FlipType.Horizontal||this._flip==t.FlipType.Both)&&(this._content.scaleX=-1),(this._flip==t.FlipType.Vertical||this._flip==t.FlipType.Both)&&(this._content.scaleY=-1),this.handleXYChanged())}),s(r,"texture",function(){return this._content.texture},function(t){null!=t?(this._sourceWidth=t.textureWidth,this._sourceHeight=t.textureHeight):(this._sourceWidth=0,this._sourceHeight=0),this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this._content.scale9Grid=null,this._content.fillMode=egret.BitmapFillMode.SCALE,this._content.texture=t}),r.createDisplayObject=function(){this._content=new egret.Bitmap,this._content.$owner=this,this._content.touchEnabled=!1,this.setDisplayObject(this._content)},r.dispose=function(){e.prototype.dispose.call(this)},r.constructFromResource=function(){this._sourceWidth=this.packageItem.width,this._sourceHeight=this.packageItem.height,this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this._content.scale9Grid=this.packageItem.scale9Grid,this._content.smoothing=this.packageItem.smoothing,this.packageItem.scaleByTile&&(this._content.fillMode=egret.BitmapFillMode.REPEAT),this.setSize(this._sourceWidth,this._sourceHeight),this.packageItem.load(),this._content.texture=this.packageItem.texture},r.handleXYChanged=function(){e.prototype.handleXYChanged.call(this),this._flip!=t.FlipType.None&&(-1==this._content.scaleX&&(this._content.x+=this.width),-1==this._content.scaleY&&(this._content.y+=this.height))},r.handleSizeChanged=function(){this._content.width=this.width,this._content.height=this.height},r.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var s;s=i.attributes.color,s&&(this.color=t.ToolSet.convertFromHtmlColor(s)),s=i.attributes.flip,s&&(this.flip=t.parseFlipType(s))},i}(t.GObject);t.GImage=e,egret.registerClass(e,"fairygui.GImage",["fairygui.IColorGear"])}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this)}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"icon",function(){return null!=this._iconObject?this._iconObject.icon:void 0},function(t){null!=this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}),s(r,"title",function(){return this._titleObject?this._titleObject.text:null},function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)}),s(r,"text",function(){return this.title},function(t){this.title=t}),s(r,"titleColor",function(){return this._titleObject instanceof t.GTextField?this._titleObject.color:this._titleObject instanceof i?this._titleObject.titleColor:this._titleObject instanceof t.GButton?this._titleObject.titleColor:0},function(e){this._titleObject instanceof t.GTextField?this._titleObject.color=e:this._titleObject instanceof i?this._titleObject.titleColor=e:this._titleObject instanceof t.GButton&&(this._titleObject.titleColor=e)}),s(r,"editable",function(){return this._titleObject&&this._titleObject instanceof t.GTextInput?this._titleObject.asTextInput.editable:!1},function(t){this._titleObject&&(this._titleObject.asTextInput.editable=t)}),r.constructFromXML=function(t){e.prototype.constructFromXML.call(this,t),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon")},r.setup_afterAdd=function(i){if(e.prototype.setup_afterAdd.call(this,i),i=t.ToolSet.findChildNode(i,"Label")){var s;s=i.attributes.title,s&&(this.text=s),s=i.attributes.icon,s&&(this.icon=s),s=i.attributes.titleColor,s&&(this.titleColor=t.ToolSet.convertFromHtmlColor(s)),this._titleObject instanceof t.GTextInput&&(s=i.attributes.prompt,s&&(this._titleObject.promptText=s),s=i.attributes.maxLength,s&&(this._titleObject.maxLength=parseInt(s)),s=i.attributes.restrict,s&&(this._titleObject.restrict=s),s=i.attributes.password,s&&(this._titleObject.password="true"==s))}},i}(t.GComponent);t.GLabel=e,egret.registerClass(e,"fairygui.GLabel")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function s(){e.call(this),this.scrollItemToViewOnClick=!0,this.foldInvisibleItems=!1,this._lineItemCount=0,this._lineGap=0,this._columnGap=0,this._lastSelectedIndex=0,this._numItems=0,this._realNumItems=0,this._firstIndex=0,this._curLineItemCount=0,this._curLineItemCount2=0,this._virtualListChanged=0,this._trackBounds=!0,this._pool=new t.GObjectPool,this._layout=t.ListLayoutType.SingleColumn,this._autoResizeItem=!0,this._lastSelectedIndex=-1,this._selectionMode=t.ListSelectionMode.Single,this.opaque=!0,this._align=t.AlignType.Left,this._verticalAlign=t.VertAlignType.Top,this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)}__extends(s,e);var n=__define,r=s,a=r.prototype;return a.dispose=function(){this._pool.clear(),e.prototype.dispose.call(this)},n(a,"layout",function(){return this._layout},function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),n(a,"lineGap",function(){return this._lineGap},function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),n(a,"lineItemCount",function(){return this._lineItemCount},function(t){this._lineItemCount!=t&&(this._lineItemCount=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),n(a,"columnGap",function(){return this._columnGap},function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),n(a,"align",function(){return this._align},function(t){this._align!=t&&(this._align=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),n(a,"verticalAlign",function(){return this._verticalAlign},function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),n(a,"virtualItemSize",function(){return this._itemSize},function(t){this._virtual&&(null==this._itemSize&&(this._itemSize=new egret.Point),this._itemSize.copyFrom(t),this.setVirtualListChangedFlag(!0))}),n(a,"defaultItem",function(){return this._defaultItem},function(t){this._defaultItem=t}),n(a,"autoResizeItem",function(){return this._autoResizeItem},function(t){this._autoResizeItem=t}),n(a,"selectionMode",function(){return this._selectionMode},function(t){this._selectionMode=t}),n(a,"itemPool",function(){return this._pool}),a.getFromPool=function(t){void 0===t&&(t=null),t||(t=this._defaultItem);var e=this._pool.getObject(t);return null!=e&&(e.visible=!0),e},a.returnToPool=function(t){t.displayObject.cacheAsBitmap=!1,this._pool.returnObject(t)},a.addChildAt=function(i,s){if(void 0===s&&(s=0),this._autoResizeItem&&(this._layout==t.ListLayoutType.SingleColumn?i.width=this.viewWidth:this._layout==t.ListLayoutType.SingleRow&&(i.height=this.viewHeight)),e.prototype.addChildAt.call(this,i,s),i instanceof t.GButton){var n=i;n.selected=!1,n.changeStateOnClick=!1}return i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__clickItem,this),i},a.addItem=function(e){return void 0===e&&(e=null),e||(e=this._defaultItem),this.addChild(t.UIPackage.createObjectFromURL(e))},a.addItemFromPool=function(t){return void 0===t&&(t=null),this.addChild(this.getFromPool(t))},a.removeChildAt=function(t,i){void 0===i&&(i=!1);var s=e.prototype.removeChildAt.call(this,t,i);return s.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__clickItem,this),s},a.removeChildToPoolAt=function(t){void 0===t&&(t=0);var i=e.prototype.removeChildAt.call(this,t);this.returnToPool(i)},a.removeChildToPool=function(t){e.prototype.removeChild.call(this,t),this.returnToPool(t)},a.removeChildrenToPool=function(t,e){void 0===t&&(t=0),void 0===e&&(e=-1),(0>e||e>=this._children.length)&&(e=this._children.length-1);for(var i=t;e>=i;++i)this.removeChildToPoolAt(t)},n(a,"selectedIndex",function(){for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;if(null!=i&&i.selected)return this.childIndexToItemIndex(e)}return-1},function(t){this.clearSelection(),t>=0&&t<this.numItems&&this.addSelection(t)}),a.getSelection=function(){for(var t=new Array,e=this._children.length,i=0;e>i;i++){var s=this._children[i].asButton;null!=s&&s.selected&&t.push(this.childIndexToItemIndex(i))}return t},a.addSelection=function(e,i){if(void 0===i&&(i=!1),this._selectionMode!=t.ListSelectionMode.None&&(this.checkVirtualList(),this._selectionMode==t.ListSelectionMode.Single&&this.clearSelection(),i&&this.scrollToView(e),e=this.itemIndexToChildIndex(e),!(0>e||e>=this._children.length))){var s=this.getChildAt(e).asButton;null==s||s.selected||(s.selected=!0)}},a.removeSelection=function(e){if(void 0===e&&(e=0),this._selectionMode!=t.ListSelectionMode.None&&(e=this.itemIndexToChildIndex(e),!(e>=this._children.length))){var i=this.getChildAt(e).asButton;null!=i&&i.selected&&(i.selected=!1)}},a.clearSelection=function(){for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;null!=i&&(i.selected=!1)}},a.selectAll=function(){this.checkVirtualList();for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;null!=i&&(i.selected=!0)}},a.selectNone=function(){for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;null!=i&&(i.selected=!1)}},a.selectReverse=function(){this.checkVirtualList();for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;null!=i&&(i.selected=!i.selected)}},a.handleArrowKey=function(e){void 0===e&&(e=0);var i=this.selectedIndex;if(-1!=i)switch(e){case 1:if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowVertical)i--,i>=0&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination){for(var s=this._children[i],n=0,r=i-1;r>=0;r--){var a=this._children[r];if(a.y!=s.y){s=a;break}n++}for(;r>=0;r--)if(a=this._children[r],a.y!=s.y){this.clearSelection(),this.addSelection(r+n+1,!0);break}}break;case 3:if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination)i++,i<this._children.length&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowVertical){s=this._children[i],n=0;var h=this._children.length;for(r=i+1;h>r;r++){if(a=this._children[r],a.x!=s.x){s=a;break}n++}for(;h>r;r++)if(a=this._children[r],a.x!=s.x){this.clearSelection(),this.addSelection(r-n-1,!0);break}}break;case 5:if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowVertical)i++,i<this._children.length&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination){for(s=this._children[i],n=0,h=this._children.length,r=i+1;h>r;r++){if(a=this._children[r],a.y!=s.y){s=a;break}n++}for(;h>r;r++)if(a=this._children[r],a.y!=s.y){this.clearSelection(),this.addSelection(r-n-1,!0);break}}break;case 7:if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination)i--,i>=0&&(this.clearSelection(),this.addSelection(i,!0));else if(this._layout==t.ListLayoutType.FlowVertical){for(s=this._children[i],n=0,r=i-1;r>=0;r--){if(a=this._children[r],a.x!=s.x){s=a;break}n++}for(;r>=0;r--)if(a=this._children[r],a.x!=s.x){this.clearSelection(),this.addSelection(r+n+1,!0);break}}}},a.__clickItem=function(e){if(null==this._scrollPane||!this._scrollPane.isDragged){var i=e.currentTarget;this.setSelectionOnEvent(i),this._scrollPane&&this.scrollItemToViewOnClick&&this._scrollPane.scrollToView(i,!0);var s=new t.ItemEvent(t.ItemEvent.CLICK,i);s.stageX=e.stageX,s.stageY=e.stageY,this.dispatchEvent(s)}},a.setSelectionOnEvent=function(e){if(e instanceof t.GButton&&this._selectionMode!=t.ListSelectionMode.None){var i=!1,s=e,n=this.getChildIndex(e);if(this._selectionMode==t.ListSelectionMode.Single)s.selected||(this.clearSelectionExcept(s),s.selected=!0);else if(t.GRoot.shiftKeyDown){if(!s.selected)if(-1!=this._lastSelectedIndex){var r=Math.min(this._lastSelectedIndex,n),a=Math.max(this._lastSelectedIndex,n);a=Math.min(a,this._children.length-1);for(var h=r;a>=h;h++){var o=this.getChildAt(h).asButton;null==o||o.selected||(o.selected=!0)}i=!0}else s.selected=!0}else t.GRoot.ctrlKeyDown||this._selectionMode==t.ListSelectionMode.Multiple_SingleClick?s.selected=!s.selected:s.selected?this.clearSelectionExcept(s):(this.clearSelectionExcept(s),s.selected=!0);i||(this._lastSelectedIndex=n)}},a.clearSelectionExcept=function(t){for(var e=this._children.length,i=0;e>i;i++){var s=this._children[i].asButton;null!=s&&s!=t&&s.selected&&(s.selected=!1)}},a.resizeToFit=function(e,i){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===i&&(i=0),this.ensureBoundsCorrect();var s=this.numItems;if(e>s&&(e=s),this._virtual){var n=Math.ceil(e/this._curLineItemCount);this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this.viewHeight=n*this._itemSize.y+Math.max(0,n-1)*this._lineGap:this.viewWidth=n*this._itemSize.x+Math.max(0,n-1)*this._columnGap}else if(0==e)this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this.viewHeight=i:this.viewWidth=i;else{for(var r=e-1,a=null;r>=0&&(a=this.getChildAt(r),this.foldInvisibleItems&&!a.visible);)r--;if(0>r)this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this.viewHeight=i:this.viewWidth=i;else{var h=0;this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?(h=a.y+a.height,i>h&&(h=i),this.viewHeight=h):(h=a.x+a.width,i>h&&(h=i),this.viewWidth=h)}}},a.getMaxItemWidth=function(){for(var t=this._children.length,e=0,i=0;t>i;i++){var s=this.getChildAt(i);s.width>e&&(e=s.width)}return e},a.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._autoResizeItem&&this.adjustItemsSize(),(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.FlowVertical)&&(this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},a.adjustItemsSize=function(){if(this._layout==t.ListLayoutType.SingleColumn)for(var e=this._children.length,i=this.viewWidth,s=0;e>s;s++){var n=this.getChildAt(s);n.width=i}else if(this._layout==t.ListLayoutType.SingleRow){e=this._children.length;var r=this.viewHeight;for(s=0;e>s;s++)n=this.getChildAt(s),n.height=r}},a.getSnappingPosition=function(i,n,r){if(this._virtual){r||(r=new egret.Point);var a,h;return this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?(a=n,s.pos_param=n,h=this.getIndexOnPos1(!1),n=s.pos_param,h<this._virtualItems.length&&a-n>this._virtualItems[h].height/2&&h<this._realNumItems&&(n+=this._virtualItems[h].height+this._lineGap)):this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical?(a=i,s.pos_param=i,h=this.getIndexOnPos2(!1),i=s.pos_param,h<this._virtualItems.length&&a-i>this._virtualItems[h].width/2&&h<this._realNumItems&&(i+=this._virtualItems[h].width+this._columnGap)):(a=i,s.pos_param=i,h=this.getIndexOnPos3(!1),i=s.pos_param,h<this._virtualItems.length&&a-i>this._virtualItems[h].width/2&&h<this._realNumItems&&(i+=this._virtualItems[h].width+this._columnGap)),r.x=i,r.y=n,r}return e.prototype.getSnappingPosition.call(this,i,n,r)},a.scrollToView=function(e,i,s){if(void 0===i&&(i=!1),void 0===s&&(s=!1),this._virtual){if(0==this._numItems)return;if(this.checkVirtualList(),e>=this._virtualItems.length)throw"Invalid child index: "+e+">"+this._virtualItems.length;this._loop&&(e=Math.floor(this._firstIndex/this._numItems)*this._numItems+e);var n,r,a=this._virtualItems[e],h=0;if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal){for(r=0;e>r;r+=this._curLineItemCount)h+=this._virtualItems[r].height+this._lineGap;n=new egret.Rectangle(0,h,this._itemSize.x,a.height)}else if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical){for(r=0;e>r;r+=this._curLineItemCount)h+=this._virtualItems[r].width+this._columnGap;n=new egret.Rectangle(h,0,a.width,this._itemSize.y)}else{var o=e/(this._curLineItemCount*this._curLineItemCount2);n=new egret.Rectangle(o*this.viewWidth+e%this._curLineItemCount*(a.width+this._columnGap),e/this._curLineItemCount%this._curLineItemCount2*(a.height+this._lineGap),a.width,a.height)}s=!0,null!=this._scrollPane&&this._scrollPane.scrollToView(n,i,s)}else{var l=this.getChildAt(e).asButton;null!=l&&(null!=this._scrollPane?this._scrollPane.scrollToView(l,i,s):null!=this.parent&&null!=this.parent.scrollPane&&this.parent.scrollPane.scrollToView(l,i,s))}},a.getFirstChildInView=function(){return this.childIndexToItemIndex(e.prototype.getFirstChildInView.call(this))},a.childIndexToItemIndex=function(e){if(!this._virtual)return e;if(this._layout==t.ListLayoutType.Pagination){for(var i=this._firstIndex;i<this._realNumItems;i++)if(null!=this._virtualItems[i].obj&&(e--,0>e))return i;return e}return e+=this._firstIndex,this._loop&&this._numItems>0&&(e%=this._numItems),e},a.itemIndexToChildIndex=function(e){if(!this._virtual)return e;if(this._layout==t.ListLayoutType.Pagination)return this.getChildIndex(this._virtualItems[e].obj);if(this._loop&&this._numItems>0){var i=this._firstIndex%this._numItems;e=e>=i?this._firstIndex+(e-i):this._firstIndex+this._numItems+(i-e)}else e-=this._firstIndex;return e},a.setVirtual=function(){this._setVirtual(!1)},a.setVirtualAndLoop=function(){this._setVirtual(!0)},a._setVirtual=function(e){if(!this._virtual){if(null==this._scrollPane)throw"Virtual list must be scrollable!";if(e){if(this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.FlowVertical)throw"Loop list is not supported for FlowHorizontal or FlowVertical layout!";this._scrollPane.bouncebackEffect=!1}if(this._virtual=!0,this._loop=e,this._virtualItems=new Array,this.removeChildrenToPool(),null==this._itemSize){this._itemSize=new egret.Point;var i=this.getFromPool(null);if(null==i)throw"Virtual List must have a default list item resource.";this._itemSize.x=i.width,this._itemSize.y=i.height,this.returnToPool(i)}this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?this._scrollPane.scrollSpeed=this._itemSize.y:this._scrollPane.scrollSpeed=this._itemSize.x,this._scrollPane.addEventListener(t.ScrollPane.SCROLL,this.__scrolled,this),this.setVirtualListChangedFlag(!0)
}},n(a,"numItems",function(){return this._virtual?this._numItems:this._children.length},function(e){if(this._virtual){if(null==this.itemRenderer)throw"Set itemRenderer first!";this._numItems=e,this._loop?this._realNumItems=5*this._numItems:this._realNumItems=this._numItems;var s=this._virtualItems.length;if(this._realNumItems>s)for(a=s;a<this._realNumItems;a++){var n=new i;n.width=this._itemSize.x,n.height=this._itemSize.y,this._virtualItems.push(n)}0!=this._virtualListChanged&&t.GTimers.inst.remove(this._refreshVirtualList,this),this._refreshVirtualList()}else{var r=this._children.length;if(e>r)for(var a=r;e>a;a++)null==this.itemProvider?this.addItemFromPool():this.addItemFromPool(this.itemProvider.call(this.callbackThisObj,a));else this.removeChildrenToPool(e,r);if(null!=this.itemRenderer)for(a=0;e>a;a++)this.itemRenderer.call(this.callbackThisObj,a,this.getChildAt(a))}}),a.refreshVirtualList=function(){this.setVirtualListChangedFlag(!1)},a.checkVirtualList=function(){0!=this._virtualListChanged&&(this._refreshVirtualList(),t.GTimers.inst.remove(this._refreshVirtualList,this))},a.setVirtualListChangedFlag=function(e){void 0===e&&(e=!1),e?this._virtualListChanged=2:0==this._virtualListChanged&&(this._virtualListChanged=1),t.GTimers.inst.callLater(this._refreshVirtualList,this)},a._refreshVirtualList=function(){var e=2==this._virtualListChanged;this._virtualListChanged=0,this._eventLocked=!0,e&&(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.SingleRow?this._curLineItemCount=1:0!=this._lineItemCount?this._curLineItemCount=this._lineItemCount:this._layout==t.ListLayoutType.FlowHorizontal?(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):this._layout==t.ListLayoutType.FlowVertical?(this._curLineItemCount=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)),this._layout==t.ListLayoutType.Pagination&&(this._curLineItemCount2=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount2<=0&&(this._curLineItemCount2=1)));var i=0,s=0;if(this._realNumItems>0){var n,r=Math.ceil(this._realNumItems/this._curLineItemCount)*this._curLineItemCount;if(this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal){for(n=0;r>n;n+=this._curLineItemCount)i+=this._virtualItems[n].height+this._lineGap;i>0&&(i-=this._lineGap),s=this._scrollPane.contentWidth}else if(this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical){for(n=0;r>n;n+=this._curLineItemCount)s+=this._virtualItems[n].width+this._columnGap;s>0&&(s-=this._columnGap),i=this._scrollPane.contentHeight}else{var a=Math.ceil(r/(this._curLineItemCount*this._curLineItemCount2));s=a*this.viewWidth,i=this.viewHeight}}this.handleAlign(s,i),this._scrollPane.setContentSize(s,i),this._eventLocked=!1,this.handleScroll(!0)},a.__scrolled=function(t){this.handleScroll(!1)},a.getIndexOnPos1=function(t){if(this._realNumItems<this._curLineItemCount)return s.pos_param=0,0;var e,i,n;if(this.numChildren>0&&!t){if(i=this.getChildAt(0).y,i>s.pos_param){for(e=this._firstIndex-this._curLineItemCount;e>=0;e-=this._curLineItemCount)if(i-=this._virtualItems[e].height+this._lineGap,i<=s.pos_param)return s.pos_param=i,e;return s.pos_param=0,0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if(n=i+this._virtualItems[e].height+this._lineGap,n>s.pos_param)return s.pos_param=i,e;i=n}return s.pos_param=i,this._realNumItems-this._curLineItemCount}for(i=0,e=0;e<this._realNumItems;e+=this._curLineItemCount){if(n=i+this._virtualItems[e].height+this._lineGap,n>s.pos_param)return s.pos_param=i,e;i=n}return s.pos_param=i,this._realNumItems-this._curLineItemCount},a.getIndexOnPos2=function(t){if(this._realNumItems<this._curLineItemCount)return s.pos_param=0,0;var e,i,n;if(this.numChildren>0&&!t){if(i=this.getChildAt(0).x,i>s.pos_param){for(e=this._firstIndex-this._curLineItemCount;e>=0;e-=this._curLineItemCount)if(i-=this._virtualItems[e].width+this._columnGap,i<=s.pos_param)return s.pos_param=i,e;return s.pos_param=0,0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if(n=i+this._virtualItems[e].width+this._columnGap,n>s.pos_param)return s.pos_param=i,e;i=n}return s.pos_param=i,this._realNumItems-this._curLineItemCount}for(i=0,e=0;e<this._realNumItems;e+=this._curLineItemCount){if(n=i+this._virtualItems[e].width+this._columnGap,n>s.pos_param)return s.pos_param=i,e;i=n}return s.pos_param=i,this._realNumItems-this._curLineItemCount},a.getIndexOnPos3=function(t){if(this._realNumItems<this._curLineItemCount)return s.pos_param=0,0;var e,i,n=this.viewWidth,r=Math.floor(s.pos_param/n),a=r*(this._curLineItemCount*this._curLineItemCount2),h=r*n;for(e=0;e<this._curLineItemCount;e++){if(i=h+this._virtualItems[a+e].width+this._columnGap,i>s.pos_param)return s.pos_param=h,a+e;h=i}return s.pos_param=h,a+this._curLineItemCount-1},a.handleScroll=function(e){if(!this._eventLocked){var i,s;this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal?(this._loop&&(i=this._scrollPane.scrollingPosY,s=this._numItems*(this._itemSize.y+this._lineGap),0==i?this._scrollPane.posY=s:i==this._scrollPane.contentHeight-this._scrollPane.viewHeight&&(this._scrollPane.posY=this._scrollPane.contentHeight-s-this.viewHeight)),this.handleScroll1(e)):this._layout==t.ListLayoutType.SingleRow||this._layout==t.ListLayoutType.FlowVertical?(this._loop&&(i=this._scrollPane.scrollingPosX,s=this._numItems*(this._itemSize.x+this._columnGap),0==i?this._scrollPane.posX=s:i==this._scrollPane.contentWidth-this._scrollPane.viewWidth&&(this._scrollPane.posX=this._scrollPane.contentWidth-s-this.viewWidth)),this.handleScroll2(e)):(this._loop&&(i=this._scrollPane.scrollingPosX,s=Math.floor(this._numItems/(this._curLineItemCount*this._curLineItemCount2))*this.viewWidth,0==i?this._scrollPane.posX=s:i==this._scrollPane.contentWidth-this._scrollPane.viewWidth&&(this._scrollPane.posX=this._scrollPane.contentWidth-s-this.viewWidth)),this.handleScroll3(e)),this._boundsChanged=!1}},a.handleScroll1=function(e){if(s.enterCounter++,!(s.enterCounter>3)){var i=this._scrollPane.scrollingPosY,n=i+this._scrollPane.viewHeight,r=n==this._scrollPane.contentHeight;s.pos_param=i;var a=this.getIndexOnPos1(e);if(i=s.pos_param,a==this._firstIndex&&!e)return void s.enterCounter--;var h=this._firstIndex;this._firstIndex=a;var o,l,_,c,u,d=a,g=h>a,p=this.numChildren,f=h+p-1,v=g?f:h,m=0,y=i,w=0,b=0,C=this.defaultItem;for(s.itemInfoVer++;d<this._realNumItems&&(r||n>y);){if(l=this._virtualItems[d],(null==l.obj||e)&&(null!=this.itemProvider&&(C=this.itemProvider.call(this.callbackThisObj,d%this._numItems),null==C&&(C=this.defaultItem)),null!=l.obj&&l.obj.resourceURL!=C&&(this.removeChildToPool(l.obj),l.obj=null)),null==l.obj){if(g){for(u=v;u>=h;u--)if(_=this._virtualItems[u],null!=_.obj&&_.updateFlag!=s.itemInfoVer&&_.obj.resourceURL==C){l.obj=_.obj,_.obj=null,u==v&&v--;break}}else for(u=v;f>=u;u++)if(_=this._virtualItems[u],null!=_.obj&&_.updateFlag!=s.itemInfoVer&&_.obj.resourceURL==C){l.obj=_.obj,_.obj=null,u==v&&v++;break}null!=l.obj?this.setChildIndex(l.obj,g?d-a:this.numChildren):(l.obj=this._pool.getObject(C),g?this.addChildAt(l.obj,d-a):this.addChild(l.obj)),l.obj instanceof t.GButton&&(l.obj.selected=!1),o=!0}else o=e;o&&(this.itemRenderer.call(this.callbackThisObj,d%this._numItems,l.obj),d%this._curLineItemCount==0&&(w+=Math.ceil(l.obj.height)-l.height,d==a&&h>a&&(b=Math.ceil(l.obj.height)-l.height)),l.width=Math.ceil(l.obj.width),l.height=Math.ceil(l.obj.height)),l.updateFlag=s.itemInfoVer,l.obj.setXY(m,y),d==a&&(n+=l.height),m+=l.width+this._columnGap,d%this._curLineItemCount==this._curLineItemCount-1&&(m=0,y+=l.height+this._lineGap),d++}for(c=0;p>c;c++)l=this._virtualItems[h+c],l.updateFlag!=s.itemInfoVer&&null!=l.obj&&(this.removeChildToPool(l.obj),l.obj=null);(0!=w||0!=b)&&this._scrollPane.changeContentSizeOnScrolling(0,w,0,b),d>0&&this.numChildren>0&&this._container.y<0&&this.getChildAt(0).y>-this._container.y&&this.handleScroll1(!1),s.enterCounter--}},a.handleScroll2=function(e){if(s.enterCounter++,!(s.enterCounter>3)){var i=this._scrollPane.scrollingPosX,n=i+this._scrollPane.viewWidth,r=i==this._scrollPane.contentWidth;s.pos_param=i;var a=this.getIndexOnPos2(e);if(i=s.pos_param,a==this._firstIndex&&!e)return void s.enterCounter--;var h=this._firstIndex;this._firstIndex=a;var o,l,_,c,u,d=a,g=h>a,p=this.numChildren,f=h+p-1,v=g?f:h,m=i,y=0,w=0,b=0,C=this.defaultItem;for(s.itemInfoVer++;d<this._realNumItems&&(r||n>m);){if(l=this._virtualItems[d],(null==l.obj||e)&&(null!=this.itemProvider&&(C=this.itemProvider.call(this.callbackThisObj,d%this._numItems),null==C&&(C=this.defaultItem)),null!=l.obj&&l.obj.resourceURL!=C&&(this.removeChildToPool(l.obj),l.obj=null)),null==l.obj){if(g){for(u=v;u>=h;u--)if(_=this._virtualItems[u],null!=_.obj&&_.updateFlag!=s.itemInfoVer&&_.obj.resourceURL==C){l.obj=_.obj,_.obj=null,u==v&&v--;break}}else for(u=v;f>=u;u++)if(_=this._virtualItems[u],null!=_.obj&&_.updateFlag!=s.itemInfoVer&&_.obj.resourceURL==C){l.obj=_.obj,_.obj=null,u==v&&v++;break}null!=l.obj?this.setChildIndex(l.obj,g?d-a:this.numChildren):(l.obj=this._pool.getObject(C),g?this.addChildAt(l.obj,d-a):this.addChild(l.obj)),l.obj instanceof t.GButton&&(l.obj.selected=!1),o=!0}else o=e;o&&(this.itemRenderer.call(this.callbackThisObj,d%this._numItems,l.obj),d%this._curLineItemCount==0&&(w+=Math.ceil(l.obj.width)-l.width,d==a&&h>a&&(b=Math.ceil(l.obj.width)-l.width)),l.width=Math.ceil(l.obj.width),l.height=Math.ceil(l.obj.height)),l.updateFlag=s.itemInfoVer,l.obj.setXY(m,y),d==a&&(n+=l.width),y+=l.height+this._lineGap,d%this._curLineItemCount==this._curLineItemCount-1&&(y=0,m+=l.width+this._columnGap),d++}for(c=0;p>c;c++)l=this._virtualItems[h+c],l.updateFlag!=s.itemInfoVer&&null!=l.obj&&(this.removeChildToPool(l.obj),l.obj=null);(0!=w||0!=b)&&this._scrollPane.changeContentSizeOnScrolling(w,0,b,0),d>0&&this.numChildren>0&&this._container.x<0&&this.getChildAt(0).x>-this._container.x&&this.handleScroll2(!1),s.enterCounter--}},a.handleScroll3=function(e){var i=this._scrollPane.scrollingPosX;s.pos_param=i;var n=this.getIndexOnPos3(e);if(i=s.pos_param,n!=this._firstIndex||e){var r=this._firstIndex;this._firstIndex=n;var a,h,o,l,_,c=r,u=this._virtualItems.length,d=this._curLineItemCount*this._curLineItemCount2,g=n%this._curLineItemCount,p=this.viewWidth,f=Math.floor(n/d),v=f*d,m=v+2*d;for(s.itemInfoVer++,h=v;m>h;h++)if(!(h>=this._realNumItems)){if(_=h%this._curLineItemCount,d>h-v){if(g>_)continue}else if(_>g)continue;o=this._virtualItems[h],o.updateFlag=s.itemInfoVer}var y=null,w=0;for(h=v;m>h;h++)if(!(h>=this._realNumItems)){if(_=h%this._curLineItemCount,d>h-v){if(g>_)continue}else if(_>g)continue;if(o=this._virtualItems[h],null==o.obj){for(;u>c;){if(l=this._virtualItems[c],null!=l.obj&&l.updateFlag!=s.itemInfoVer){o.obj=l.obj,l.obj=null;break}c++}-1==w&&(w=this.getChildIndex(y)+1),null==o.obj?(o.obj=this._pool.getObject(this.defaultItem),this.addChildAt(o.obj,w)):w=this.setChildIndexBefore(o.obj,w),w++,o.obj instanceof t.GButton&&(o.obj.selected=!1),a=!0}else a=e,w=-1,y=o.obj;a&&this.itemRenderer.call(this.callbackThisObj,h%this._numItems,o.obj),o.obj.setXY(Math.floor(h/d)*p+_*(o.width+this._columnGap),Math.floor(h/this._curLineItemCount)%this._curLineItemCount2*(o.height+this._lineGap))}for(h=c;u>h;h++)o=this._virtualItems[h],o.updateFlag!=s.itemInfoVer&&null!=o.obj&&(this.removeChildToPool(o.obj),o.obj=null)}},a.handleAlign=function(e,i){var s=0,n=0;this._layout==t.ListLayoutType.SingleColumn||this._layout==t.ListLayoutType.FlowHorizontal||this._layout==t.ListLayoutType.Pagination?i<this.viewHeight&&(this._verticalAlign==t.VertAlignType.Middle?n=Math.floor((this.viewHeight-i)/2):this._verticalAlign==t.VertAlignType.Bottom&&(n=this.viewHeight-i)):e<this.viewWidth&&(this._align==t.AlignType.Center?s=Math.floor((this.viewWidth-e)/2):this._align==t.AlignType.Right&&(s=this.viewWidth-e)),(s!=this._alignOffset.x||n!=this._alignOffset.y)&&(this._alignOffset.setTo(s,n),null!=this._scrollPane?this._scrollPane.adjustMaskContainer():(this._container.x=this._margin.left+this._alignOffset.x,this._container.y=this._margin.top+this._alignOffset.y))},a.updateBounds=function(){if(!this._virtual){var e,i,s,n,r,a=this._children.length,h=0,o=0,l=0,_=0,c=0,u=0,a=this._children.length,d=this.viewWidth,g=this.viewHeight;for(h=0;a>h;h++)e=this.getChildAt(h),e.ensureSizeCorrect();if(this._layout==t.ListLayoutType.SingleColumn){for(h=0;a>h;h++)e=this.getChildAt(h),(!this.foldInvisibleItems||e.visible)&&(s=Math.ceil(e.width),n=Math.ceil(e.height),0!=l&&(l+=this._lineGap),e.y=l,l+=n,s>_&&(_=s));i=o+_,u=l}else if(this._layout==t.ListLayoutType.SingleRow){for(h=0;a>h;h++)e=this.getChildAt(h),e.visible&&(s=Math.ceil(e.width),n=Math.ceil(e.height),0!=o&&(o+=this._columnGap),e.x=o,o+=s,n>c&&(c=n));i=o,u=l+c}else if(this._layout==t.ListLayoutType.FlowHorizontal){var p=0;for(h=0;a>h;h++)e=this.getChildAt(h),(!this.foldInvisibleItems||e.visible)&&(s=Math.ceil(e.width),n=Math.ceil(e.height),0!=o&&(o+=this._columnGap),(0!=this._lineItemCount&&p>=this._lineItemCount||0==this._lineItemCount&&o+s>d&&0!=c)&&(o-=this._columnGap,o>_&&(_=o),o=0,l+=c+this._lineGap,c=0,p=0),e.setXY(o,l),o+=s,n>c&&(c=n),p++);u=l+c,i=_}else if(this._layout==t.ListLayoutType.FlowVertical){for(p=0,h=0;a>h;h++)e=this.getChildAt(h),(!this.foldInvisibleItems||e.visible)&&(s=Math.ceil(e.width),n=Math.ceil(e.height),0!=l&&(l+=this._lineGap),(0!=this._lineItemCount&&p>=this._lineItemCount||0==this._lineItemCount&&l+n>g&&0!=_)&&(l-=this._lineGap,l>c&&(c=l),l=0,o+=_+this._columnGap,_=0,p=0),e.setXY(o,l),l+=n,s>_&&(_=s),p++);i=o+_,u=c}else{for(h=0;a>h;h++)e=this.getChildAt(h),(!this.foldInvisibleItems||e.visible)&&(s=Math.ceil(e.width),n=Math.ceil(e.height),0!=o&&(o+=this._columnGap),(0!=this._lineItemCount&&p>=this._lineItemCount||0==this._lineItemCount&&o+s>d&&0!=c)&&(o-=this._columnGap,o>_&&(_=o),o=0,l+=c+this._lineGap,c=0,p=0,l+n>g&&0!=_&&(r++,l=0)),e.setXY(r*d+o,l),o+=s,n>c&&(c=n),p++);u=l+c,i=(r+1)*d}this.handleAlign(i,u),this.setBounds(0,0,i,u)}},a.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var s,n;s=i.attributes.layout,s&&(this._layout=t.parseListLayoutType(s));var r;if(s=i.attributes.overflow,r=s?t.parseOverflowType(s):t.OverflowType.Visible,s=i.attributes.margin,s&&this._margin.parse(s),s=i.attributes.align,s&&(this._align=t.parseAlignType(s)),s=i.attributes.vAlign,s&&(this._verticalAlign=t.parseVertAlignType(s)),r==t.OverflowType.Scroll){var a;s=i.attributes.scroll,a=s?t.parseScrollType(s):t.ScrollType.Vertical;var h;s=i.attributes.scrollBar,h=s?t.parseScrollBarDisplayType(s):t.ScrollBarDisplayType.Default;var o;s=i.attributes.scrollBarFlags,o=s?parseInt(s):0;var l=new t.Margin;s=i.attributes.scrollBarMargin,s&&l.parse(s);var _,c;s=i.attributes.scrollBarRes,s&&(n=s.split(","),_=n[0],c=n[1]),this.setupScroll(l,a,h,o,_,c)}else this.setupOverflow(r);s=i.attributes.lineGap,s&&(this._lineGap=parseInt(s)),s=i.attributes.colGap,s&&(this._columnGap=parseInt(s)),s=i.attributes.lineItemCount,s&&(this._lineItemCount=parseInt(s)),s=i.attributes.selectionMode,s&&(this._selectionMode=t.parseListSelectionMode(s)),s=i.attributes.defaultItem,s&&(this._defaultItem=s),s=i.attributes.autoItemSize,this._autoResizeItem="false"!=s;var u=i.children;if(u)for(var d=u.length,g=0;d>g;g++){var p=u[g];if("item"==p.name){var f=p.attributes.url;if(f||(f=this._defaultItem),f){var v=this.getFromPool(f);null!=v&&(this.addChild(v),s=p.attributes.title,s&&(v.text=s),s=p.attributes.icon,s&&(v.icon=s),s=p.attributes.name,s&&(v.name=s))}}}},s.itemInfoVer=0,s.enterCounter=0,s}(t.GComponent);t.GList=e,egret.registerClass(e,"fairygui.GList");var i=function(){function t(){this.width=0,this.height=0}var e=(__define,t);e.prototype;return t}();egret.registerClass(i,"ItemInfo")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(){this._count=0,this._pool={}}var i=__define,s=e,n=s.prototype;return n.clear=function(){for(var t=this._pool.length,e=0;t>e;e++)for(var i=this._pool[e],s=i.length,n=0;s>n;n++)i[n].dispose();this._pool={},this._count=0},i(n,"count",function(){return this._count}),n.getObject=function(e){var i=this._pool[e];if(null==i&&(i=new Array,this._pool[e]=i),i.length)return this._count--,i.shift();var s=t.UIPackage.createObjectFromURL(e);return s},n.returnObject=function(t){var e=t.resourceURL;if(e){var i=this._pool[e];null==i&&(i=new Array,this._pool[e]=i),this._count++,i.push(t)}},e}();t.GObjectPool=e,egret.registerClass(e,"fairygui.GObjectPool")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._frame=0,this._color=0,this._contentSourceWidth=0,this._contentSourceHeight=0,this._contentWidth=0,this._contentHeight=0,this._playing=!0,this._url="",this._fill=t.LoaderFillType.None,this._align=t.AlignType.Left,this._verticalAlign=t.VertAlignType.Top,this._showErrorSign=!0,this._color=16777215,this._gearAnimation=new t.GearAnimation(this),this._gearColor=new t.GearColor(this)}__extends(i,e);var s=__define,n=i,r=n.prototype;return r.createDisplayObject=function(){this._container=new t.UIContainer,this._container.$owner=this,this._container.hitArea=new egret.Rectangle,this.setDisplayObject(this._container)},r.dispose=function(){if(null==this._contentItem&&this._content instanceof egret.Bitmap){var t=this._content.texture;null!=t&&this.freeExternal(t)}e.prototype.dispose.call(this)},s(r,"url",function(){return this._url},function(t){this._url!=t&&(this._url=t,this.loadContent(),this.updateGear(7))}),s(r,"icon",function(){return this._url},function(t){this.url=t}),s(r,"align",function(){return this._align},function(t){this._align!=t&&(this._align=t,this.updateLayout())}),s(r,"verticalAlign",function(){return this._verticalAlign},function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateLayout())}),s(r,"fill",function(){return this._fill},function(t){this._fill!=t&&(this._fill=t,this.updateLayout())}),s(r,"autoSize",function(){return this._autoSize},function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())}),s(r,"playing",function(){return this._playing},function(e){this._playing!=e&&(this._playing=e,this._content instanceof t.MovieClip&&(this._content.playing=e),this.updateGear(5))}),s(r,"frame",function(){return this._frame},function(e){this._frame!=e&&(this._frame=e,this._content instanceof t.MovieClip&&(this._content.currentFrame=e),this.updateGear(5))}),s(r,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this.updateGear(4),this.applyColor())}),r.applyColor=function(){},s(r,"showErrorSign",function(){return this._showErrorSign},function(t){this._showErrorSign=t}),s(r,"content",function(){return this._content}),s(r,"texture",function(){return this._content instanceof egret.Bitmap?this._content.texture:null},function(t){this.url=null,this.switchToMovieMode(!1),this._content.texture=t,null!=t?(this._contentSourceWidth=t.textureWidth,this._contentSourceHeight=t.textureHeight):this._contentSourceWidth=this._contentHeight=0,this.updateLayout()}),r.loadContent=function(){this.clearContent(),this._url&&(t.ToolSet.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())},r.loadFromPackage=function(e){if(this._contentItem=t.UIPackage.getItemByURL(e),null!=this._contentItem)if(this._contentItem.load(),this._contentItem.type==t.PackageItemType.Image)if(null==this._contentItem.texture)this.setErrorState();else{this.switchToMovieMode(!1);var i=this._content;i.texture=this._contentItem.texture,i.scale9Grid=this._contentItem.scale9Grid,this._contentItem.scaleByTile?i.fillMode=egret.BitmapFillMode.REPEAT:i.fillMode=egret.BitmapFillMode.SCALE,this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height,this.updateLayout()}else if(this._contentItem.type==t.PackageItemType.MovieClip){this.switchToMovieMode(!0),this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height;var s=this._content;s.interval=this._contentItem.interval,s.swing=this._contentItem.swing,s.repeatDelay=this._contentItem.repeatDelay,s.frames=this._contentItem.frames,s.boundsRect=new egret.Rectangle(0,0,this._contentSourceWidth,this._contentSourceHeight),this.updateLayout()}else this.setErrorState();else this.setErrorState()},r.switchToMovieMode=function(e){e?this._content instanceof t.MovieClip||(this._content=new t.MovieClip):this._content instanceof egret.Bitmap||(this._content=new egret.Bitmap),this._container.addChild(this._content)},r.loadExternal=function(){RES.getResAsync(this._url,this.__getResCompleted,this)},r.freeExternal=function(t){},r.onExternalLoadSuccess=function(t){this._content instanceof egret.Bitmap?this._container.addChild(this._content):(this._content=new egret.Bitmap,this._container.addChild(this._content)),this._content.texture=t,this._content.scale9Grid=null,this._content.fillMode=egret.BitmapFillMode.SCALE,this._contentSourceWidth=t.textureWidth,this._contentSourceHeight=t.textureHeight,this.updateLayout()},r.onExternalLoadFailed=function(){this.setErrorState()},r.__getResCompleted=function(t,e){t instanceof egret.Texture?this.onExternalLoadSuccess(t):this.onExternalLoadFailed()},r.setErrorState=function(){this._showErrorSign&&(null==this._errorSign&&null!=t.UIConfig.loaderErrorSign&&(this._errorSign=i._errorSignPool.getObject(t.UIConfig.loaderErrorSign)),null!=this._errorSign&&(this._errorSign.width=this.width,this._errorSign.height=this.height,this._container.addChild(this._errorSign.displayObject)))},r.clearErrorState=function(){null!=this._errorSign&&(this._container.removeChild(this._errorSign.displayObject),i._errorSignPool.returnObject(this._errorSign),this._errorSign=null)},r.updateLayout=function(){if(null==this._content)return void(this._autoSize&&(this._updatingLayout=!0,this.setSize(50,30),this._updatingLayout=!1));if(this._content.x=0,this._content.y=0,this._content.scaleX=1,this._content.scaleY=1,this._contentWidth=this._contentSourceWidth,this._contentHeight=this._contentSourceHeight,this._autoSize)this._updatingLayout=!0,0==this._contentWidth&&(this._contentWidth=50),0==this._contentHeight&&(this._contentHeight=30),this.setSize(this._contentWidth,this._contentHeight),this._updatingLayout=!1;else{var e=1,i=1;this._fill!=t.LoaderFillType.None&&(e=this.width/this._contentSourceWidth,i=this.height/this._contentSourceHeight,(1!=e||1!=i)&&(this._fill==t.LoaderFillType.ScaleMatchHeight?e=i:this._fill==t.LoaderFillType.ScaleMatchWidth?i=e:this._fill==t.LoaderFillType.Scale&&(e>i?e=i:i=e),this._contentWidth=this._contentSourceWidth*e,this._contentHeight=this._contentSourceHeight*i)),this._content instanceof egret.Bitmap?(this._content.width=this._contentWidth,this._content.height=this._contentHeight):(this._content.scaleX=e,this._content.scaleY=i),this._align==t.AlignType.Center?this._content.x=Math.floor((this.width-this._contentWidth)/2):this._align==t.AlignType.Right&&(this._content.x=this.width-this._contentWidth),this._verticalAlign==t.VertAlignType.Middle?this._content.y=Math.floor((this.height-this._contentHeight)/2):this._verticalAlign==t.VertAlignType.Bottom&&(this._content.y=this.height-this._contentHeight)}},r.clearContent=function(){if(this.clearErrorState(),null!=this._content&&null!=this._content.parent&&this._container.removeChild(this._content),null==this._contentItem&&this._content instanceof egret.Bitmap){var t=this._content.texture;null!=t&&this.freeExternal(t)}this._contentItem=null},r.handleSizeChanged=function(){this._updatingLayout||this.updateLayout(),this._container.hitArea.setTo(0,0,this.width,this.height)},r.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var s;s=i.attributes.url,s&&(this._url=s),s=i.attributes.align,s&&(this._align=t.parseAlignType(s)),s=i.attributes.vAlign,s&&(this._verticalAlign=t.parseVertAlignType(s)),s=i.attributes.fill,s&&(this._fill=t.parseLoaderFillType(s)),this._autoSize="true"==i.attributes.autoSize,s=i.attributes.errorSign,s&&(this._showErrorSign="true"==s),this._playing="false"!=i.attributes.playing,s=i.attributes.color,s&&(this.color=t.ToolSet.convertFromHtmlColor(s)),this._url&&this.loadContent()},i._errorSignPool=new t.GObjectPool,i}(t.GObject);t.GLoader=e,egret.registerClass(e,"fairygui.GLoader",["fairygui.IAnimationGear","fairygui.IColorGear"])}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._sizeImplType=1}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"color",function(){return 0},function(t){}),r.createDisplayObject=function(){this._movieClip=new t.MovieClip,this._movieClip.$owner=this,this._movieClip.touchEnabled=!1,this.setDisplayObject(this._movieClip)},s(r,"playing",function(){return this._movieClip.playing},function(t){this._movieClip.playing!=t&&(this._movieClip.playing=t,this.updateGear(5))}),s(r,"frame",function(){return this._movieClip.currentFrame},function(t){this._movieClip.currentFrame!=t&&(this._movieClip.currentFrame=t,this.updateGear(5))}),r.setPlaySettings=function(t,e,i,s,n,r){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=-1),void 0===n&&(n=null),void 0===r&&(r=null),this._movieClip.setPlaySettings(t,e,i,s,n,r)},r.constructFromResource=function(){this._sourceWidth=this.packageItem.width,this._sourceHeight=this.packageItem.height,this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this.setSize(this._sourceWidth,this._sourceHeight),this.packageItem.load(),this._movieClip.interval=this.packageItem.interval,this._movieClip.swing=this.packageItem.swing,this._movieClip.repeatDelay=this.packageItem.repeatDelay,this._movieClip.frames=this.packageItem.frames,this._movieClip.boundsRect=new egret.Rectangle(0,0,this.sourceWidth,this.sourceHeight)},r.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var s;s=i.attributes.frame,s&&(this._movieClip.currentFrame=parseInt(s)),s=i.attributes.playing,this._movieClip.playing="false"!=s,s=i.attributes.color,s&&(this.color=t.ToolSet.convertFromHtmlColor(s))},i}(t.GObject);t.GMovieClip=e,egret.registerClass(e,"fairygui.GMovieClip",["fairygui.IAnimationGear","fairygui.IColorGear"])}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._max=0,this._value=0,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._barStartX=0,this._barStartY=0,this._tweenValue=0,this._titleType=t.ProgressTitleType.Percent,this._value=50,this._max=100}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"titleType",function(){return this._titleType},function(t){this._titleType!=t&&(this._titleType=t,this.update(this._value))}),s(r,"max",function(){return this._max},function(t){this._max!=t&&(this._max=t,this.update(this._value))}),s(r,"value",function(){return this._value},function(t){null!=this._tweener&&(this._tweener.setPaused(!0),this._tweener=null),this._value!=t&&(this._value=t,this.update(this._value))}),r.tweenValue=function(t,e){return this._value!=t?(this._tweener&&this._tweener.setPaused(!0),this._tweenValue=this._value,this._value=t,this._tweener=egret.Tween.get(this,{onChange:this.onUpdateTween,onChangeObj:this}).to({_tweenValue:t},1e3*e,i.easeLinear),this._tweener):null},r.onUpdateTween=function(){this.update(this._tweenValue)},r.update=function(e){var i=Math.min(e/this._max,1);if(this._titleObject)switch(this._titleType){case t.ProgressTitleType.Percent:this._titleObject.text=Math.round(100*i)+"%";break;case t.ProgressTitleType.ValueAndMax:this._titleObject.text=Math.round(e)+"/"+Math.round(this._max);break;case t.ProgressTitleType.Value:this._titleObject.text=""+Math.round(e);break;case t.ProgressTitleType.Max:this._titleObject.text=""+Math.round(this._max)}var s=this.width-this._barMaxWidthDelta,n=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH.width=s*i,this._barObjectH.x=this._barStartX+(s-this._barObjectH.width)),this._barObjectV&&(this._barObjectV.height=n*i,this._barObjectV.y=this._barStartY+(n-this._barObjectV.height))):(this._barObjectH&&(this._barObjectH.width=s*i),this._barObjectV&&(this._barObjectV.height=n*i)),this._aniObject instanceof t.GMovieClip&&(this._aniObject.frame=Math.round(100*i))},r.constructFromXML=function(i){e.prototype.constructFromXML.call(this,i),i=t.ToolSet.findChildNode(i,"ProgressBar");var s;s=i.attributes.titleType,s&&(this._titleType=t.parseProgressTitleType(s)),this._reverse="true"==i.attributes.reverse,this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y)},r.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update(this._value)},r.setup_afterAdd=function(i){e.prototype.setup_afterAdd.call(this,i),i=t.ToolSet.findChildNode(i,"ProgressBar"),i&&(this._value=parseInt(i.attributes.value),this._max=parseInt(i.attributes.max)),this.update(this._value)},r.dispose=function(){this._tweener&&this._tweener.setPaused(!0),e.prototype.dispose.call(this)},i.easeLinear=egret.Ease.getPowIn(1),i}(t.GComponent);t.GProgressBar=e,egret.registerClass(e,"fairygui.GProgressBar")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function s(){e.call(this),this._fontSize=0,this._leading=0,this._letterSpacing=0,this._textWidth=0,this._textHeight=0,this._fontSize=12,this._align=t.AlignType.Left,this._verticalAlign=t.VertAlignType.Top,this._text="",this._leading=3,this._color=0,this._autoSize=t.AutoSizeType.Both,this._widthAutoSize=!0,this._heightAutoSize=!0,this._bitmapPool=new Array}__extends(s,e);var n=__define,r=s,a=r.prototype;return a.createDisplayObject=function(){this._textField=new egret.TextField,this._textField.$owner=this,this._textField.touchEnabled=!1,this.setDisplayObject(this._textField)},a.switchBitmapMode=function(t){t&&this.displayObject==this._textField?(null==this._bitmapContainer&&(this._bitmapContainer=new egret.Sprite,this._bitmapContainer.$owner=this),this.switchDisplayObject(this._bitmapContainer)):t||this.displayObject!=this._bitmapContainer||this.switchDisplayObject(this._textField)},a.dispose=function(){e.prototype.dispose.call(this),this._bitmapFont=null},n(a,"text",function(){return this._text},function(t){this._text=t,null==this._text&&(this._text=""),this.updateGear(6),this.parent&&this.parent._underConstruct?this.renderNow():this.render()}),a.updateTextFieldText=function(){this._ubbEnabled?this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(t.ToolSet.encodeHTML(this._text))):this._textField.text=this._text},n(a,"font",function(){return this._font},function(t){this._font!=t&&(this._font=t,this.updateTextFormat())}),n(a,"fontSize",function(){return this._fontSize},function(t){0>t||this._fontSize!=t&&(this._fontSize=t,this.updateTextFormat())}),n(a,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this.updateGear(4),this.updateTextFormat())}),n(a,"align",function(){return this._align},function(t){this._align!=t&&(this._align=t,this.updateTextFormat())}),n(a,"verticalAlign",function(){return this._verticalAlign
},function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.doAlign())}),n(a,"leading",function(){return this._leading},function(t){this._leading!=t&&(this._leading=t,this.updateTextFormat())}),n(a,"letterSpacing",function(){return this._letterSpacing},function(t){this._letterSpacing!=t&&(this._letterSpacing=t,this.updateTextFormat())}),n(a,"underline",function(){return!1},function(t){}),n(a,"bold",function(){return this._textField.bold},function(t){this._textField.bold=t}),n(a,"italic",function(){return this._textField.italic},function(t){this._textField.italic=t}),n(a,"singleLine",function(){return!this._textField.multiline},function(t){t=!t,this._textField.multiline!=t&&(this._textField.multiline=t,this.render())}),n(a,"stroke",function(){return this._textField.stroke},function(t){this._textField.stroke=t}),n(a,"strokeColor",function(){return this._textField.strokeColor},function(t){this._textField.strokeColor=t}),n(a,"ubbEnabled",function(){return this._ubbEnabled},function(t){this._ubbEnabled!=t&&(this._ubbEnabled=t,this.render())}),n(a,"autoSize",function(){return this._autoSize},function(e){this._autoSize!=e&&(this._autoSize=e,this._widthAutoSize=e==t.AutoSizeType.Both,this._heightAutoSize=e==t.AutoSizeType.Both||e==t.AutoSizeType.Height,this.render())}),n(a,"textWidth",function(){return this._requireRender&&this.renderNow(),this._textWidth}),a.ensureSizeCorrect=function(){this._sizeDirty&&this._requireRender&&this.renderNow()},a.updateTextFormat=function(){this._textField.size=this._fontSize,t.ToolSet.startsWith(this._font,"ui://")?this._bitmapFont=t.UIPackage.getBitmapFontByURL(this._font):(this._bitmapFont=null,this._font?this._textField.fontFamily=this._font:this._textField.fontFamily=t.UIConfig.defaultFont),this.grayed?this._textField.textColor=11184810:this._textField.textColor=this._color,this._textField.textAlign=t.getAlignTypeString(this._align),this._textField.lineSpacing=this._leading,this._underConstruct||this.render()},a.render=function(){this._requireRender||(this._requireRender=!0,egret.callLater(this.__render,this)),this._sizeDirty||!this._widthAutoSize&&!this._heightAutoSize||(this._sizeDirty=!0,this.dispatchEventWith(t.GObject.SIZE_DELAY_CHANGE))},a.__render=function(){this._requireRender&&this.renderNow()},a.renderNow=function(t){if(void 0===t&&(t=!0),this._requireRender=!1,this._sizeDirty=!1,null!=this._bitmapFont)return void this.renderWithBitmapFont(t);this.switchBitmapMode(!1),this._textField.width=this._widthAutoSize?1e4:Math.ceil(this.width),this.updateTextFieldText(),this._textWidth=Math.ceil(this._textField.textWidth),this._textWidth>0&&(this._textWidth+=4),this._textHeight=Math.ceil(this._textField.textHeight),this._textHeight>0&&(this._textHeight+=4);var e,i=0;this._widthAutoSize?(e=this._textWidth,this._textField.width=e):e=this.width,this._heightAutoSize?(i=this._textHeight,this._widthAutoSize||(this._textField.height=this._textHeight)):(i=this.height,this._textHeight>i&&(this._textHeight=i),this._textField.height=this._textHeight),t&&(this._updatingSize=!0,this.setSize(e,i),this._updatingSize=!1,this.doAlign())},a.renderWithBitmapFont=function(e){this.switchBitmapMode(!0);for(var n=this._bitmapContainer.numChildren,r=0;n>r;r++){var a=this._bitmapContainer.getChildAt(r);this._bitmapPool.push(a)}this._bitmapContainer.removeChildren(),this._lines?i.returnList(this._lines):this._lines=new Array;var h,o=this._letterSpacing,l=this._leading-1,_=this.width-2*s.GUTTER_X,c=0,u=0,d=0,g=0,p=0,f=0,v=0,m=0,y=0,w="",b=s.GUTTER_Y,C=!this._widthAutoSize&&this._textField.multiline,x=this._bitmapFont.resizable?this._fontSize/this._bitmapFont.size:1;this._textWidth=0,this._textHeight=0;for(var T=this._text.length,I=0;T>I;++I){var S=this._text.charAt(I),O=S.charCodeAt(I);if("\n"!=S){if(O>256||32>=O?(f>0&&(m=c),f=0):(0==f&&(v=c),f++)," "==S)g=Math.ceil(this._fontSize/2),p=Math.ceil(this._fontSize);else{var P=this._bitmapFont.glyphs[S];P?(g=Math.ceil(P.advance*x),p=Math.ceil(P.lineHeight*x)):" "==S?(g=Math.ceil(this._bitmapFont.size*x/2),p=Math.ceil(this._bitmapFont.size*x)):(g=0,p=0)}if(p>d&&(d=p),p>u&&(u=p),0!=c&&(c+=o),c+=g,!C||_>=c)w+=S;else{if(h=i.borrow(),h.height=u,h.textHeight=d,0==w.length)h.text=S;else if(f>0&&m>0){w+=S;var L=w.length-f;h.text=t.ToolSet.trimRight(w.substr(0,L)),h.width=m,w=w.substr(L+1),c-=v}else h.text=w,h.width=c-(g+o),w=S,c=g,u=p,d=p;h.y=b,b+=h.height+l,h.width>this._textWidth&&(this._textWidth=h.width),f=0,v=0,m=0,this._lines.push(h)}}else w+=S,h=i.borrow(),h.width=c,0==d&&(0==y&&(y=Math.ceil(this._fontSize*x)),0==u&&(u=y),d=u),h.height=u,y=u,h.textHeight=d,h.text=w,h.y=b,b+=h.height+l,h.width>this._textWidth&&(this._textWidth=h.width),this._lines.push(h),w="",c=0,u=0,d=0,f=0,v=0,m=0}(w.length>0||this._lines.length>0&&t.ToolSet.endsWith(this._lines[this._lines.length-1].text,"\n"))&&(h=i.borrow(),h.width=c,0==u&&(u=y),0==d&&(d=u),h.height=u,h.textHeight=d,h.text=w,h.y=b,h.width>this._textWidth&&(this._textWidth=h.width),this._lines.push(h)),this._textWidth>0&&(this._textWidth+=2*s.GUTTER_X);var E=this._lines.length;0==E?this._textHeight=0:(h=this._lines[this._lines.length-1],this._textHeight=h.y+h.height+s.GUTTER_Y);var A,F=0;if(A=this._widthAutoSize?0==this._textWidth?0:this._textWidth:this.width,F=this._heightAutoSize?0==this._textHeight?0:this._textHeight:this.height,e&&(this._updatingSize=!0,this.setSize(A,F),this._updatingSize=!1,this.doAlign()),0!=A&&0!=F){var j=s.GUTTER_X,B=0,k=0;_=this.width-2*s.GUTTER_X;for(var R=this._lines.length,r=0;R>r;r++){h=this._lines[r],j=s.GUTTER_X,B=this._align==t.AlignType.Center?(_-h.width)/2:this._align==t.AlignType.Right?_-h.width:0,T=h.text.length;for(var M=0;T>M;M++)if(S=h.text.charAt(M),P=this._bitmapFont.glyphs[S],null!=P){k=(h.height+h.textHeight)/2-Math.ceil(P.lineHeight*x);var G;this._bitmapPool.length?G=this._bitmapPool.pop():(G=new egret.Bitmap,G.smoothing=!0),G.x=j+B+Math.ceil(P.offsetX*x),G.y=h.y+k+Math.ceil(P.offsetY*x),G.texture=P.texture,G.scaleX=x,G.scaleY=x,this._bitmapContainer.addChild(G),j+=o+Math.ceil(P.advance*x)}else j+=" "==S?o+Math.ceil(this._bitmapFont.size*x/2):o}}},a.handleSizeChanged=function(){this._updatingSize||(this._widthAutoSize?this.doAlign():this.render())},a.handleGrayedChanged=function(){e.prototype.handleGrayedChanged.call(this),this.updateTextFormat()},a.doAlign=function(){if(this._verticalAlign==t.VertAlignType.Top||0==this._textHeight)this._yOffset=s.GUTTER_Y;else{var e=this.height-this._textHeight;0>e&&(e=0),this._verticalAlign==t.VertAlignType.Middle?this._yOffset=Math.floor(e/2):this._yOffset=Math.floor(e)}this.displayObject.y=this.y+this._yOffset},a.setup_beforeAdd=function(i){e.prototype.setup_beforeAdd.call(this,i);var s;s=i.attributes.font,s&&(this._font=s),s=i.attributes.fontSize,s&&(this._fontSize=parseInt(s)),s=i.attributes.color,s&&(this._color=t.ToolSet.convertFromHtmlColor(s)),s=i.attributes.align,s&&(this._align=t.parseAlignType(s)),s=i.attributes.vAlign,s&&(this._verticalAlign=t.parseVertAlignType(s)),s=i.attributes.leading,s?this._leading=parseInt(s):this._leading=3,s=i.attributes.letterSpacing,s&&(this._letterSpacing=parseInt(s)),this._ubbEnabled="true"==i.attributes.ubb,s=i.attributes.autoSize,s&&(this._autoSize=t.parseAutoSizeType(s),this._widthAutoSize=this._autoSize==t.AutoSizeType.Both,this._heightAutoSize=this._autoSize==t.AutoSizeType.Both||this._autoSize==t.AutoSizeType.Height),this._textField.italic="true"==i.attributes.italic,this._textField.bold="true"==i.attributes.bold,this._textField.multiline="true"!=i.attributes.singleLine,s=i.attributes.strokeColor,s&&(this._textField.strokeColor=t.ToolSet.convertFromHtmlColor(s),s=i.attributes.strokeSize,s?this.stroke=parseInt(s)+1:this.stroke=2)},a.setup_afterAdd=function(t){e.prototype.setup_afterAdd.call(this,t),this.updateTextFormat();var i=t.attributes.text;null!=i&&i.length>0&&(this.text=i),this._sizeDirty=!1},s.GUTTER_X=2,s.GUTTER_Y=2,s}(t.GObject);t.GTextField=e,egret.registerClass(e,"fairygui.GTextField",["fairygui.IColorGear"]);var i=function(){function t(){this.width=0,this.height=0,this.textHeight=0,this.y=0}var e=(__define,t);e.prototype;return t.borrow=function(){if(t.pool.length){var e=t.pool.pop();return e.width=0,e.height=0,e.textHeight=0,e.text=null,e.y=0,e}return new t},t.returns=function(e){t.pool.push(e)},t.returnList=function(e){for(var i=e.length,s=0;i>s;s++){var n=e[s];t.pool.push(n)}e.length=0},t.pool=[],t}();t.LineInfo=i,egret.registerClass(i,"fairygui.LineInfo")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._textField.touchEnabled=!0,this._textField.addEventListener(egret.TextEvent.LINK,this.__clickLink,this)}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"text",function(){return this._text},function(e){this._text=e,null==this._text&&(this._text=""),this._textField.width=this.width,this._ubbEnabled?this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(this._text)):this._textField.textFlow=(new egret.HtmlTextParser).parser(this._text),this.updateGear(6),this.render()}),r.__clickLink=function(t){this.dispatchEvent(new egret.TextEvent(egret.TextEvent.LINK,!1,!1,t.text))},i}(t.GTextField);t.GRichTextField=e,egret.registerClass(e,"fairygui.GRichTextField")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),null==i._inst&&(i._inst=this),this.opaque=!1,this._volumeScale=1,this._popupStack=new Array,this._justClosedPopups=new Array,this.displayObject.addEventListener(egret.Event.ADDED_TO_STAGE,this.__addedToStage,this)}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(i,"inst",function(){return null==i._inst&&new i,i._inst}),s(r,"nativeStage",function(){return this._nativeStage}),r.showWindow=function(t){this.addChild(t),t.requestFocus(),t.x>this.width?t.x=this.width-t.width:t.x+t.width<0&&(t.x=0),t.y>this.height?t.y=this.height-t.height:t.y+t.height<0&&(t.y=0),this.adjustModalLayer()},r.hideWindow=function(t){t.hide()},r.hideWindowImmediately=function(t){t.parent==this&&this.removeChild(t),this.adjustModalLayer()},r.bringToFront=function(e){var i,s=this.numChildren;for(i=null==this._modalLayer.parent||e.modal?s-1:this.getChildIndex(this._modalLayer)-1;i>=0;i--){var n=this.getChildAt(i);if(n==e)return;if(n instanceof t.Window)break}i>=0&&this.setChildIndex(e,i)},r.showModalWait=function(e){void 0===e&&(e=null),null!=t.UIConfig.globalModalWaiting&&(null==this._modalWaitPane&&(this._modalWaitPane=t.UIPackage.createObjectFromURL(t.UIConfig.globalModalWaiting)),this._modalWaitPane.setSize(this.width,this.height),this._modalWaitPane.addRelation(this,t.RelationType.Size),this.addChild(this._modalWaitPane),this._modalWaitPane.text=e)},r.closeModalWait=function(){null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane)},r.closeAllExceptModals=function(){for(var e=this._children.slice(),i=e.length,s=0;i>s;s++){var n=e[s];n instanceof t.Window&&!n.modal&&n.hide()}},r.closeAllWindows=function(){for(var e=this._children.slice(),i=e.length,s=0;i>s;s++){var n=e[s];n instanceof t.Window&&n.hide()}},r.getTopWindow=function(){for(var e=this.numChildren,i=e-1;i>=0;i--){var s=this.getChildAt(i);if(s instanceof t.Window)return s}return null},s(r,"hasModalWindow",function(){return null!=this._modalLayer.parent}),s(r,"modalWaiting",function(){return this._modalWaitPane&&this._modalWaitPane.inContainer}),r.showPopup=function(t,e,s){if(void 0===e&&(e=null),void 0===s&&(s=null),this._popupStack.length>0){var n=this._popupStack.indexOf(t);if(-1!=n)for(var r=this._popupStack.length-1;r>=n;r--)this.removeChild(this._popupStack.pop())}this._popupStack.push(t),this.addChild(t),this.adjustModalLayer();var a,h,o=0;e?(a=e.localToRoot(),h=e.width,o=e.height):a=this.globalToLocal(i.mouseX,i.mouseY);var l,_;l=a.x,l+t.width>this.width&&(l=l+h-t.width),_=a.y+o,(null==s&&_+t.height>this.height||0==s)&&(_=a.y-t.height-1,0>_&&(_=0,l+=h/2)),t.x=l,t.y=_},r.togglePopup=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),-1==this._justClosedPopups.indexOf(t)&&this.showPopup(t,e,i)},r.hidePopup=function(t){if(void 0===t&&(t=null),null!=t){var e=this._popupStack.indexOf(t);if(-1!=e)for(var i=this._popupStack.length-1;i>=e;i--)this.closePopup(this._popupStack.pop())}else{var s=this._popupStack.length;for(i=s-1;i>=0;i--)this.closePopup(this._popupStack[i]);this._popupStack.length=0}},s(r,"hasAnyPopup",function(){return 0!=this._popupStack.length}),r.closePopup=function(e){null!=e.parent&&(e instanceof t.Window?e.hide():this.removeChild(e))},r.showTooltips=function(e){if(null==this._defaultTooltipWin){var i=t.UIConfig.tooltipsWin;if(!i)return void console.error("UIConfig.tooltipsWin not defined");this._defaultTooltipWin=t.UIPackage.createObjectFromURL(i)}this._defaultTooltipWin.text=e,this.showTooltipsWin(this._defaultTooltipWin)},r.showTooltipsWin=function(t,e){void 0===e&&(e=null),this.hideTooltips(),this._tooltipWin=t;var s=0,n=0;null==e?(s=i.mouseX+10,n=i.mouseY+20):(s=e.x,n=e.y);var r=this.globalToLocal(s,n);s=r.x,n=r.y,s+this._tooltipWin.width>this.width&&(s=s-this._tooltipWin.width-1,0>s&&(s=10)),n+this._tooltipWin.height>this.height&&(n=n-this._tooltipWin.height-1,s-this._tooltipWin.width-1>0&&(s=s-this._tooltipWin.width-1),0>n&&(n=10)),this._tooltipWin.x=s,this._tooltipWin.y=n,this.addChild(this._tooltipWin)},r.hideTooltips=function(){null!=this._tooltipWin&&(this._tooltipWin.parent&&this.removeChild(this._tooltipWin),this._tooltipWin=null)},r.getObjectUnderPoint=function(e,i){var s=this._nativeStage.$hitTest(e,i);return s?t.ToolSet.displayObjectToGObject(s):null},s(r,"focus",function(){return this._focusedObject&&!this._focusedObject.onStage&&(this._focusedObject=null),this._focusedObject},function(t){if(t&&(!t.focusable||!t.onStage))throw"invalid focus target";this.setFocus(t)}),r.setFocus=function(t){this._focusedObject!=t&&(this._focusedObject=t,this.dispatchEventWith(i.FOCUS_CHANGED))},s(r,"volumeScale",function(){return this._volumeScale},function(t){this._volumeScale=t}),r.playOneShotSound=function(t,e){void 0===e&&(e=1);var i=this._volumeScale*e,s=t.play(0,1);s.volume=i},r.adjustModalLayer=function(){var e=this.numChildren;null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.setChildIndex(this._modalWaitPane,e-1);for(var i=e-1;i>=0;i--){var s=this.getChildAt(i);if(s instanceof t.Window&&s.modal)return void(null==this._modalLayer.parent?this.addChildAt(this._modalLayer,i):this.setChildIndexBefore(this._modalLayer,i))}null!=this._modalLayer.parent&&this.removeChild(this._modalLayer)},r.__addedToStage=function(e){this.displayObject.removeEventListener(egret.Event.ADDED_TO_STAGE,this.__addedToStage,this),this._nativeStage=this.displayObject.stage,this._nativeStage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__stageMouseDownCapture,this,!0),this._nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__stageMouseUpCapture,this,!0),this._nativeStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__stageMouseMoveCapture,this,!0),this._modalLayer=new t.GGraph,this._modalLayer.setSize(this.width,this.height),this._modalLayer.drawRect(0,0,0,t.UIConfig.modalLayerColor,t.UIConfig.modalLayerAlpha),this._modalLayer.addRelation(this,t.RelationType.Size),this.displayObject.stage.addEventListener(egret.Event.RESIZE,this.__winResize,this),this.__winResize(null)},r.__stageMouseDownCapture=function(t){i.mouseX=t.stageX,i.mouseY=t.stageY,i.touchDown=!0;for(var e=t.target;e!=this.displayObject.stage&&null!=e;){if(e.$owner){var s=e.$owner;if(s.touchable&&s.focusable){this.setFocus(s);break}}e=e.parent}if(null!=this._tooltipWin&&this.hideTooltips(),this._justClosedPopups.length=0,this._popupStack.length>0){for(e=t.target;e!=this.displayObject.stage&&null!=e;){if(e.$owner){var n=this._popupStack.indexOf(e.$owner);if(-1!=n){for(var r=this._popupStack.length-1;r>n;r--){var a=this._popupStack.pop();this.closePopup(a),this._justClosedPopups.push(a)}return}}e=e.parent}var h=this._popupStack.length;for(r=h-1;r>=0;r--)a=this._popupStack[r],this.closePopup(a),this._justClosedPopups.push(a);this._popupStack.length=0}},r.__stageMouseMoveCapture=function(t){i.mouseX=t.stageX,i.mouseY=t.stageY},r.__stageMouseUpCapture=function(t){i.touchDown=!1},r.__winResize=function(t){this.setSize(this._nativeStage.stageWidth,this._nativeStage.stageHeight)},i.contentScaleFactor=1,i.FOCUS_CHANGED="FocusChanged",i}(t.GComponent);t.GRoot=e,egret.registerClass(e,"fairygui.GRoot")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){this.left=0,this.right=0,this.top=0,this.bottom=0}var e=(__define,t),i=e.prototype;return i.parse=function(t){if(!t)return this.left=0,this.right=0,this.top=0,void(this.bottom=0);var e=t.split(",");if(1==e.length){var i=parseInt(e[0]);this.top=i,this.bottom=i,this.left=i,this.right=i}else this.top=parseInt(e[0]),this.bottom=parseInt(e[1]),this.left=parseInt(e[2]),this.right=parseInt(e[3])},i.copy=function(t){this.top=t.top,this.bottom=t.bottom,this.left=t.left,this.right=t.right},t}();t.Margin=e,egret.registerClass(e,"fairygui.Margin")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){this._enumI=0,this._enumCount=0,this._lastTime=0,this._items=new Array,this._itemPool=new Array,this._lastTime=egret.getTimer(),egret.startTick(this.__timer,this)}var e=(__define,t),s=e.prototype;return s.getItem=function(){return this._itemPool.length?this._itemPool.pop():new i},s.findItem=function(t,e){for(var i=this._items.length,s=0;i>s;s++){var n=this._items[s];if(n.callback==t&&n.thisObj==e)return n}return null},s.add=function(t,e,i,s,n){void 0===n&&(n=null);var r=this.findItem(i,s);r||(r=this.getItem(),r.callback=i,r.hasParam=1==i.length,r.thisObj=s,this._items.push(r)),r.delay=t,r.counter=0,r.repeat=e,r.param=n,r.end=!1},s.callLater=function(t,e,i){void 0===i&&(i=null),this.add(1,1,t,e,i)},s.callDelay=function(t,e,i,s){void 0===s&&(s=null),this.add(t,1,e,i,s)},s.callBy24Fps=function(e,i,s){void 0===s&&(s=null),this.add(t.FPS24,0,e,i,s)},s.exists=function(t,e){var i=this.findItem(t,e);return null!=i},s.remove=function(t,e){var i=this.findItem(t,e);if(i){var s=this._items.indexOf(i);this._items.splice(s,1),s<this._enumI&&this._enumI--,this._enumCount--,i.callback=null,i.param=null,this._itemPool.push(i)}},s.__timer=function(t){this._enumI=0,this._enumCount=this._items.length;var e=t-this._lastTime;for(this._lastTime=t;this._enumI<this._enumCount;){var i=this._items[this._enumI];this._enumI++,i.advance(e)&&(i.end&&(this._enumI--,this._enumCount--,this._items.splice(this._enumI,1),this._itemPool.push(i)),i.hasParam?i.callback.call(i.thisObj,i.param):i.callback.call(i.thisObj))}return!1},t.inst=new t,t.FPS24=1e3/24,t}();t.GTimers=e,egret.registerClass(e,"fairygui.GTimers");var i=function(){function t(){this.delay=0,this.counter=0,this.repeat=0}var e=(__define,t),i=e.prototype;return i.advance=function(t){return void 0===t&&(t=0),this.counter+=t,this.counter>=this.delay?(this.counter-=this.delay,this.counter>this.delay&&(this.counter=this.delay),this.repeat>0&&(this.repeat--,0==this.repeat&&(this.end=!0)),!0):!1},t}();egret.registerClass(i,"TimerItem")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._dragOffset=new egret.Point,this._scrollPerc=0}__extends(i,e);var s=__define,n=i,r=n.prototype;return r.setScrollPane=function(t,e){this._target=t,this._vertical=e},s(r,"displayPerc",void 0,function(t){this._vertical?(this._fixedGripSize||(this._grip.height=t*this._bar.height),this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc):(this._fixedGripSize||(this._grip.width=t*this._bar.width),this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc)}),s(r,"scrollPerc",void 0,function(t){this._scrollPerc=t,this._vertical?this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc:this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc}),s(r,"minSize",function(){return this._vertical?(null!=this._arrowButton1?this._arrowButton1.height:0)+(null!=this._arrowButton2?this._arrowButton2.height:0):(null!=this._arrowButton1?this._arrowButton1.width:0)+(null!=this._arrowButton2?this._arrowButton2.width:0)}),r.constructFromXML=function(i){return e.prototype.constructFromXML.call(this,i),i=t.ToolSet.findChildNode(i,"ScrollBar"),null!=i&&(this._fixedGripSize="true"==i.attributes.fixedGripSize),this._grip=this.getChild("grip"),this._grip?(this._bar=this.getChild("bar"),this._bar?(this._arrowButton1=this.getChild("arrow1"),this._arrowButton2=this.getChild("arrow2"),this._grip.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__gripMouseDown,this),this._grip.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripDragging,this),this._arrowButton1&&this._arrowButton1.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__arrowButton1Click,this),this._arrowButton2&&this._arrowButton2.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__arrowButton2Click,this),void this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__barMouseDown,this)):void console.error("bar")):void console.error("grip")},r.__gripMouseDown=function(t){this._bar&&(t.stopPropagation(),this.globalToLocal(t.stageX,t.stageY,this._dragOffset),this._dragOffset.x-=this._grip.x,this._dragOffset.y-=this._grip.y)},r.__gripDragging=function(t){var e=this.globalToLocal(t.stageX,t.stageY,i.sScrollbarHelperPoint);if(this._vertical){var s=e.y-this._dragOffset.y;this._target.setPercY((s-this._bar.y)/(this._bar.height-this._grip.height),!1)}else{var n=e.x-this._dragOffset.x;this._target.setPercX((n-this._bar.x)/(this._bar.width-this._grip.width),!1)}},r.__arrowButton1Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollUp():this._target.scrollLeft()},r.__arrowButton2Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollDown():this._target.scrollRight()},r.__barMouseDown=function(t){var e=this._grip.globalToLocal(t.stageX,t.stageY,i.sScrollbarHelperPoint);this._vertical?e.y<0?this._target.scrollUp(4):this._target.scrollDown(4):e.x<0?this._target.scrollLeft(4):this._target.scrollRight(4)},i.sScrollbarHelperPoint=new egret.Point,i}(t.GComponent);t.GScrollBar=e,egret.registerClass(e,"fairygui.GScrollBar")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._max=0,this._value=0,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._titleType=t.ProgressTitleType.Percent,this._value=50,this._max=100,this._clickPos=new egret.Point}__extends(i,e);var s=__define,n=i,r=n.prototype;return s(r,"titleType",function(){return this._titleType},function(t){this._titleType=t}),s(r,"max",function(){return this._max},function(t){this._max!=t&&(this._max=t,this.update())}),s(r,"value",function(){return this._value},function(t){this._value!=t&&(this._value=t,this.update())}),r.update=function(){var t=Math.min(this._value/this._max,1);this.updateWidthPercent(t)},r.updateWidthPercent=function(e){if(this._titleObject)switch(this._titleType){case t.ProgressTitleType.Percent:this._titleObject.text=Math.round(100*e)+"%";break;case t.ProgressTitleType.ValueAndMax:this._titleObject.text=this._value+"/"+this._max;break;case t.ProgressTitleType.Value:this._titleObject.text=""+this._value;break;case t.ProgressTitleType.Max:this._titleObject.text=""+this._max}this._barObjectH&&(this._barObjectH.width=(this.width-this._barMaxWidthDelta)*e),this._barObjectV&&(this._barObjectV.height=(this.height-this._barMaxHeightDelta)*e),this._aniObject instanceof t.GMovieClip&&(this._aniObject.frame=Math.round(100*e))},r.constructFromXML=function(i){e.prototype.constructFromXML.call(this,i),i=t.ToolSet.findChildNode(i,"Slider");var s;s=i.attributes.titleType,s&&(this._titleType=t.parseProgressTitleType(s)),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._gripObject=this.getChild("grip"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight),this._gripObject&&this._gripObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__gripMouseDown,this)},r.handleSizeChanged=function(){e.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update()},r.setup_afterAdd=function(i){e.prototype.setup_afterAdd.call(this,i),i=t.ToolSet.findChildNode(i,"Slider"),i&&(this._value=parseInt(i.attributes.value),this._max=parseInt(i.attributes.max)),this.update()},r.__gripMouseDown=function(t){this._clickPos=this.globalToLocal(t.stageX,t.stageY),this._clickPercent=this._value/this._max,this._gripObject.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),this._gripObject.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this)},r.__gripMouseMove=function(e){var s,n=this.globalToLocal(e.stageX,e.stageY,i.sSilderHelperPoint),r=n.x-this._clickPos.x,a=n.y-this._clickPos.y;s=this._barObjectH?this._clickPercent+r/this._barMaxWidth:this._clickPercent+a/this._barMaxHeight,s>1?s=1:0>s&&(s=0);var h=Math.round(this._max*s);h!=this._value&&(this._value=h,this.dispatchEvent(new t.StateChangeEvent(t.StateChangeEvent.CHANGED))),this.updateWidthPercent(s)},r.__gripMouseUp=function(t){var e=this._value/this._max;this.updateWidthPercent(e),this._gripObject.displayObject.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),this._gripObject.displayObject.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this)},i.sSilderHelperPoint=new egret.Point,i}(t.GComponent);t.GSlider=e,egret.registerClass(e,"fairygui.GSlider")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._widthAutoSize=!1,this._heightAutoSize=!1,this.displayObject.touchChildren=!0,this._textField.type=egret.TextFieldType.INPUT,this._textField.addEventListener(egret.Event.CHANGE,this.__textChanged,this),this._textField.addEventListener(egret.FocusEvent.FOCUS_IN,this.__focusIn,this),this._textField.addEventListener(egret.FocusEvent.FOCUS_OUT,this.__focusOut,this)}__extends(i,e);var s=__define,n=i,r=n.prototype;return r.dispose=function(){e.prototype.dispose.call(this)},s(r,"editable",function(){return this._textField.type==egret.TextFieldType.INPUT},function(t){t?this._textField.type==egret.TextFieldType.INPUT:this._textField.type==egret.TextFieldType.DYNAMIC}),s(r,"maxLength",function(){return this._textField.maxChars},function(t){this._textField.maxChars=t}),s(r,"promptText",function(){return this._promptText},function(t){this._promptText=t,this.updateTextFieldText()}),s(r,"restrict",function(){return this._textField.restrict},function(t){this._textField.restrict=t}),s(r,"password",function(){return this._password},function(t){this._password!=t&&(this._password=t,this._textField.displayAsPassword=this._password,this.render())}),s(r,"verticalAlign",function(){return this._verticalAlign},function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateVertAlign())}),r.updateVertAlign=function(){switch(this._verticalAlign){case t.VertAlignType.Top:this._textField.verticalAlign=egret.VerticalAlign.TOP;break;case t.VertAlignType.Middle:this._textField.verticalAlign=egret.VerticalAlign.MIDDLE;break;case t.VertAlignType.Bottom:this._textField.verticalAlign=egret.VerticalAlign.BOTTOM}},r.updateTextFieldText=function(){!this._text&&this._promptText?(this._textField.displayAsPassword=!1,this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(this._promptText))):(this._textField.displayAsPassword=this._password,this._ubbEnabled?this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(t.ToolSet.encodeHTML(this._text))):this._textField.text=this._text)},r.handleSizeChanged=function(){this._updatingSize||(this._textField.width=Math.ceil(this.width),this._textField.height=Math.ceil(this.height))},r.doAlign=function(){},r.setup_beforeAdd=function(t){e.prototype.setup_beforeAdd.call(this,t),this._promptText=t.attributes.prompt;var i=t.attributes.maxLength;null!=i&&(this._textField.maxChars=parseInt(i)),i=t.attributes.restrict,null!=i&&(this._textField.restrict=i),i=t.attributes.password,"true"==i&&(this.password=!0),this.updateVertAlign()},r.setup_afterAdd=function(i){e.prototype.setup_afterAdd.call(this,i),!this._text&&this._promptText&&(this._textField.displayAsPassword=!1,this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(t.ToolSet.encodeHTML(this._promptText))))},r.__textChanged=function(t){this._text=this._textField.text},r.__focusIn=function(t){!this._text&&this._promptText&&(this._textField.displayAsPassword=this._password,this._textField.text="")},r.__focusOut=function(e){this._text=this._textField.text,!this._text&&this._promptText&&(this._textField.displayAsPassword=!1,this._textField.textFlow=(new egret.HtmlTextParser).parser(t.ToolSet.parseUBB(t.ToolSet.encodeHTML(this._promptText))))},i}(t.GTextField);t.GTextInput=e,egret.registerClass(e,"fairygui.GTextInput")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function t(){}var e=__define,i=t,s=i.prototype;return e(s,"controller",void 0,function(t){this._controller=t}),e(s,"index",function(){return this._id?this._controller.getPageIndexById(this._id):-1},function(t){this._id=this._controller.getPageId(t)}),e(s,"name",function(){return this._id?this._controller.getPageNameById(this._id):null},function(t){this._id=this._controller.getPageIdByName(t)}),s.clear=function(){this._id=null},e(s,"id",function(){return this._id},function(t){this._id=t}),t}();t.PageOption=e,egret.registerClass(e,"fairygui.PageOption")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(e){if(void 0===e&&(e=null),!e&&(e=t.UIConfig.popupMenu,!e))throw"UIConfig.popupMenu not defined";this._contentPane=t.UIPackage.createObjectFromURL(e).asCom,this._contentPane.addEventListener(egret.Event.ADDED_TO_STAGE,this.__addedToStage,this),this._list=this._contentPane.getChild("list"),this._list.removeChildrenToPool(),this._list.addRelation(this._contentPane,t.RelationType.Width),this._list.removeRelation(this._contentPane,t.RelationType.Height),this._contentPane.addRelation(this._list,t.RelationType.Height),this._list.addEventListener(t.ItemEvent.CLICK,this.__clickItem,this)}var i=__define,s=e,n=s.prototype;return n.dispose=function(){this._contentPane.dispose()},n.addItem=function(t,e){void 0===e&&(e=null);var i=this._list.addItemFromPool().asButton;i.title=t,i.data=e,i.grayed=!1;var s=i.getController("checked");return null!=s&&(s.selectedIndex=0),i},n.addItemAt=function(t,e,i){void 0===i&&(i=null);var s=this._list.getFromPool().asButton;this._list.addChildAt(s,e),s.title=t,s.data=i,s.grayed=!1;var n=s.getController("checked");return null!=n&&(n.selectedIndex=0),s},n.addSeperator=function(){if(null==t.UIConfig.popupMenu_seperator)throw"UIConfig.popupMenu_seperator not defined";this.list.addItemFromPool(t.UIConfig.popupMenu_seperator)},n.getItemName=function(t){var e=this._list.getChildAt(t);return e.name},n.setItemText=function(t,e){var i=this._list.getChild(t).asButton;i.title=e},n.setItemVisible=function(t,e){var i=this._list.getChild(t).asButton;i.visible!=e&&(i.visible=e,this._list.setBoundsChangedFlag())},n.setItemGrayed=function(t,e){var i=this._list.getChild(t).asButton;i.grayed=e},n.setItemCheckable=function(t,e){var i=this._list.getChild(t).asButton,s=i.getController("checked");null!=s&&(e?0==s.selectedIndex&&(s.selectedIndex=1):s.selectedIndex=0)},n.setItemChecked=function(t,e){var i=this._list.getChild(t).asButton,s=i.getController("checked");null!=s&&(s.selectedIndex=e?2:1)
},n.isItemChecked=function(t){var e=this._list.getChild(t).asButton,i=e.getController("checked");return null!=i?2==i.selectedIndex:!1},n.removeItem=function(t){var e=this._list.getChild(t);if(null!=e){var i=this._list.getChildIndex(e);return this._list.removeChildToPoolAt(i),!0}return!1},n.clearItems=function(){this._list.removeChildrenToPool()},i(n,"itemCount",function(){return this._list.numChildren}),i(n,"contentPane",function(){return this._contentPane}),i(n,"list",function(){return this._list}),n.show=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var s=null!=e?e.root:t.GRoot.inst;s.showPopup(this.contentPane,e instanceof t.GRoot?null:e,i)},n.__clickItem=function(e){t.GTimers.inst.add(100,1,this.__clickItem2,this,e)},n.__clickItem2=function(t){var e=t.itemObject.asButton;if(null!=e){if(e.grayed)return void(this._list.selectedIndex=-1);var i=e.getController("checked");null!=i&&0!=i.selectedIndex&&(1==i.selectedIndex?i.selectedIndex=2:i.selectedIndex=1);var s=this._contentPane.parent;s.hidePopup(this.contentPane),null!=e.data&&(1==e.data.length?e.data(t):e.data())}},n.__addedToStage=function(t){this._list.selectedIndex=-1,this._list.resizeToFit(1e5,10)},e}();t.PopupMenu=e,egret.registerClass(e,"fairygui.PopupMenu")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(t){this._owner=t,this._defs=new Array}var s=__define,n=e,r=n.prototype;return s(r,"owner",function(){return this._owner}),s(r,"target",function(){return this._target},function(t){this._target!=t&&(this._target&&this.releaseRefTarget(this._target),this._target=t,this._target&&this.addRefTarget(this._target))}),r.add=function(e,i){if(e==t.RelationType.Size)return this.add(t.RelationType.Width,i),void this.add(t.RelationType.Height,i);for(var s=this._defs.length,n=0;s>n;n++){var r=this._defs[n];if(r.type==e)return}this.internalAdd(e,i)},r.internalAdd=function(e,s){if(e==t.RelationType.Size)return this.internalAdd(t.RelationType.Width,s),void this.internalAdd(t.RelationType.Height,s);var n=new i;n.percent=s,n.type=e,this._defs.push(n),(s||e==t.RelationType.Left_Center||e==t.RelationType.Center_Center||e==t.RelationType.Right_Center||e==t.RelationType.Top_Middle||e==t.RelationType.Middle_Middle||e==t.RelationType.Bottom_Middle)&&(this._owner.pixelSnapping=!0)},r.remove=function(e){if(void 0===e&&(e=0),e==t.RelationType.Size)return this.remove(t.RelationType.Width),void this.remove(t.RelationType.Height);for(var i=this._defs.length,s=0;i>s;s++)if(this._defs[s].type==e){this._defs.splice(s,1);break}},r.copyFrom=function(t){this.target=t.target,this._defs.length=0;for(var e=t._defs.length,s=0;e>s;s++){var n=t._defs[s],r=new i;r.copyFrom(n),this._defs.push(r)}},r.dispose=function(){null!=this._target&&(this.releaseRefTarget(this._target),this._target=null)},s(r,"isEmpty",function(){return 0==this._defs.length}),r.applyOnSelfResized=function(e,i){for(var s=this._owner.x,n=this._owner.y,r=this._defs.length,a=0;r>a;a++){var h=this._defs[a];switch(h.type){case t.RelationType.Center_Center:case t.RelationType.Right_Center:this._owner.x-=e/2;break;case t.RelationType.Right_Left:case t.RelationType.Right_Right:this._owner.x-=e;break;case t.RelationType.Middle_Middle:case t.RelationType.Bottom_Middle:this._owner.y-=i/2;break;case t.RelationType.Bottom_Top:case t.RelationType.Bottom_Bottom:this._owner.y-=i}}if((s!=this._owner.x||n!=this._owner.y)&&(s=this._owner.x-s,n=this._owner.y-n,this._owner.updateGearFromRelations(1,s,n),null!=this._owner.parent)){var o=this._owner.parent._transitions.length;if(o>0)for(var a=0;o>a;++a)this._owner.parent._transitions[a].updateFromRelations(this._owner.id,s,n)}},r.applyOnXYChanged=function(e,i,s){var n;switch(e.type){case t.RelationType.Left_Left:case t.RelationType.Left_Center:case t.RelationType.Left_Right:case t.RelationType.Center_Center:case t.RelationType.Right_Left:case t.RelationType.Right_Center:case t.RelationType.Right_Right:this._owner.x+=i;break;case t.RelationType.Top_Top:case t.RelationType.Top_Middle:case t.RelationType.Top_Bottom:case t.RelationType.Middle_Middle:case t.RelationType.Bottom_Top:case t.RelationType.Bottom_Middle:case t.RelationType.Bottom_Bottom:this._owner.y+=s;break;case t.RelationType.Width:case t.RelationType.Height:break;case t.RelationType.LeftExt_Left:case t.RelationType.LeftExt_Right:n=this._owner.x,this._owner.x+=i,this._owner.width=this._owner._rawWidth-(this._owner.x-n);break;case t.RelationType.RightExt_Left:case t.RelationType.RightExt_Right:this._owner.width=this._owner._rawWidth+i;break;case t.RelationType.TopExt_Top:case t.RelationType.TopExt_Bottom:n=this._owner.y,this._owner.y+=s,this._owner.height=this._owner._rawHeight-(this._owner.y-n);break;case t.RelationType.BottomExt_Top:case t.RelationType.BottomExt_Bottom:this._owner.height=this._owner._rawHeight+s}},r.applyOnSizeChanged=function(e){var i,s;this._target!=this._owner.parent?(i=this._target.x,s=this._target.y):(i=0,s=0);var n,r;switch(e.type){case t.RelationType.Left_Left:break;case t.RelationType.Left_Center:n=this._owner.x-(i+this._targetWidth/2),e.percent&&(n=n/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth/2+n;break;case t.RelationType.Left_Right:n=this._owner.x-(i+this._targetWidth),e.percent&&(n=n/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth+n;break;case t.RelationType.Center_Center:n=this._owner.x+this._owner._rawWidth/2-(i+this._targetWidth/2),e.percent&&(n=n/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth/2+n-this._owner._rawWidth/2;break;case t.RelationType.Right_Left:n=this._owner.x+this._owner._rawWidth-i,e.percent&&(n=n/this._targetWidth*this._target._rawWidth),this._owner.x=i+n-this._owner._rawWidth;break;case t.RelationType.Right_Center:n=this._owner.x+this._owner._rawWidth-(i+this._targetWidth/2),e.percent&&(n=n/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth/2+n-this._owner._rawWidth;break;case t.RelationType.Right_Right:n=this._owner.x+this._owner._rawWidth-(i+this._targetWidth),e.percent&&(n=n/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth+n-this._owner._rawWidth;break;case t.RelationType.Top_Top:break;case t.RelationType.Top_Middle:n=this._owner.y-(s+this._targetHeight/2),e.percent&&(n=n/this._targetHeight*this._target._rawHeight),this._owner.y=s+this._target._rawHeight/2+n;break;case t.RelationType.Top_Bottom:n=this._owner.y-(s+this._targetHeight),e.percent&&(n=n/this._targetHeight*this._target._rawHeight),this._owner.y=s+this._target._rawHeight+n;break;case t.RelationType.Middle_Middle:n=this._owner.y+this._owner._rawHeight/2-(s+this._targetHeight/2),e.percent&&(n=n/this._targetHeight*this._target._rawHeight),this._owner.y=s+this._target._rawHeight/2+n-this._owner._rawHeight/2;break;case t.RelationType.Bottom_Top:n=this._owner.y+this._owner._rawHeight-s,e.percent&&(n=n/this._targetHeight*this._target._rawHeight),this._owner.y=s+n-this._owner._rawHeight;break;case t.RelationType.Bottom_Middle:n=this._owner.y+this._owner._rawHeight-(s+this._targetHeight/2),e.percent&&(n=n/this._targetHeight*this._target._rawHeight),this._owner.y=s+this._target._rawHeight/2+n-this._owner._rawHeight;break;case t.RelationType.Bottom_Bottom:n=this._owner.y+this._owner._rawHeight-(s+this._targetHeight),e.percent&&(n=n/this._targetHeight*this._target._rawHeight),this._owner.y=s+this._target._rawHeight+n-this._owner._rawHeight;break;case t.RelationType.Width:n=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-this._target._initWidth:this._owner._rawWidth-this._targetWidth,e.percent&&(n=n/this._targetWidth*this._target._rawWidth),this._target==this._owner.parent?this._owner.setSize(this._target._rawWidth+n,this._owner._rawHeight,!0):this._owner.width=this._target._rawWidth+n;break;case t.RelationType.Height:n=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-this._target._initHeight:this._owner._rawHeight-this._targetHeight,e.percent&&(n=n/this._targetHeight*this._target._rawHeight),this._target==this._owner.parent?this._owner.setSize(this._owner._rawWidth,this._target._rawHeight+n,!0):this._owner.height=this._target._rawHeight+n;break;case t.RelationType.LeftExt_Left:break;case t.RelationType.LeftExt_Right:n=this._owner.x-(i+this._targetWidth),e.percent&&(n=n/this._targetWidth*this._target._rawWidth),r=this._owner.x,this._owner.x=i+this._target._rawWidth+n,this._owner.width=this._owner._rawWidth-(this._owner.x-r);break;case t.RelationType.RightExt_Left:break;case t.RelationType.RightExt_Right:n=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-(i+this._target._initWidth):this._owner.width-(i+this._targetWidth),this._owner!=this._target.parent&&(n+=this._owner.x),e.percent&&(n=n/this._targetWidth*this._target._rawWidth),this._owner!=this._target.parent?this._owner.width=i+this._target._rawWidth+n-this._owner.x:this._owner.width=i+this._target._rawWidth+n;break;case t.RelationType.TopExt_Top:break;case t.RelationType.TopExt_Bottom:n=this._owner.y-(s+this._targetHeight),e.percent&&(n=n/this._targetHeight*this._target._rawHeight),r=this._owner.y,this._owner.y=s+this._target._rawHeight+n,this._owner.height=this._owner._rawHeight-(this._owner.y-r);break;case t.RelationType.BottomExt_Top:break;case t.RelationType.BottomExt_Bottom:n=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-(s+this._target._initHeight):this._owner._rawHeight-(s+this._targetHeight),this._owner!=this._target.parent&&(n+=this._owner.y),e.percent&&(n=n/this._targetHeight*this._target._rawHeight),this._owner!=this._target.parent?this._owner.height=s+this._target._rawHeight+n-this._owner.y:this._owner.height=s+this._target._rawHeight+n}},r.addRefTarget=function(e){e!=this._owner.parent&&e.addEventListener(t.GObject.XY_CHANGED,this.__targetXYChanged,this),e.addEventListener(t.GObject.SIZE_CHANGED,this.__targetSizeChanged,this),e.addEventListener(t.GObject.SIZE_DELAY_CHANGE,this.__targetSizeWillChange,this),this._targetX=this._target.x,this._targetY=this._target.y,this._targetWidth=this._target._rawWidth,this._targetHeight=this._target._rawHeight},r.releaseRefTarget=function(e){e.removeEventListener(t.GObject.XY_CHANGED,this.__targetXYChanged,this),e.removeEventListener(t.GObject.SIZE_CHANGED,this.__targetSizeChanged,this),e.removeEventListener(t.GObject.SIZE_DELAY_CHANGE,this.__targetSizeWillChange,this)},r.__targetXYChanged=function(t){if(null!=this._owner.relations.handling||null!=this._owner.group&&this._owner.group._updating)return this._targetX=this._target.x,void(this._targetY=this._target.y);this._owner.relations.handling=this._target;for(var e=this._owner.x,i=this._owner.y,s=this._target.x-this._targetX,n=this._target.y-this._targetY,r=this._defs.length,a=0;r>a;a++){var h=this._defs[a];this.applyOnXYChanged(h,s,n)}if(this._targetX=this._target.x,this._targetY=this._target.y,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),null!=this._owner.parent)){var o=this._owner.parent._transitions.length;if(o>0)for(var a=0;o>a;++a)this._owner.parent._transitions[a].updateFromRelations(this._owner.id,e,i)}this._owner.relations.handling=null},r.__targetSizeChanged=function(t){if(null==this._owner.relations.handling){this._owner.relations.handling=this._target;for(var e=this._owner.x,i=this._owner.y,s=this._owner._rawWidth,n=this._owner._rawHeight,r=this._defs.length,a=0;r>a;a++){var h=this._defs[a];this.applyOnSizeChanged(h)}if(this._targetWidth=this._target._rawWidth,this._targetHeight=this._target._rawHeight,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),null!=this._owner.parent)){var o=this._owner.parent._transitions.length;if(o>0)for(var a=0;o>a;++a)this._owner.parent._transitions[a].updateFromRelations(this._owner.id,e,i)}(s!=this._owner._rawWidth||n!=this._owner._rawHeight)&&(s=this._owner._rawWidth-s,n=this._owner._rawHeight-n,this._owner.updateGearFromRelations(2,s,n)),this._owner.relations.handling=null}},r.__targetSizeWillChange=function(t){this._owner.relations.sizeDirty=!0},e}();t.RelationItem=e,egret.registerClass(e,"fairygui.RelationItem");var i=function(){function t(){}var e=(__define,t),i=e.prototype;return i.copyFrom=function(t){this.percent=t.percent,this.type=t.type},t}();t.RelationDef=i,egret.registerClass(i,"fairygui.RelationDef")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(t){this._owner=t,this._items=new Array}var i=__define,s=e,n=s.prototype;return n.add=function(e,i,s){void 0===s&&(s=!1);for(var n=this._items.length,r=0;n>r;r++){var a=this._items[r];if(a.target==e)return void a.add(i,s)}var h=new t.RelationItem(this._owner);h.target=e,h.add(i,s),this._items.push(h)},n.addItems=function(t,i){var s,n,r,a=i.split(",");for(r=0;2>r;r++)if(s=a[r]){"%"==s.charAt(s.length-1)?(s=s.substr(0,s.length-1),n=!0):n=!1;var h=s.indexOf("-");-1==h&&(s=s+"-"+s);var o=e.RELATION_NAMES.indexOf(s);if(-1==o)throw"invalid relation type";this.add(t,o,n)}},n.remove=function(t,e){void 0===e&&(e=0);for(var i=this._items.length,s=0;i>s;){var n=this._items[s];n.target==t?(n.remove(e),n.isEmpty?(n.dispose(),this._items.splice(s,1),i--):s++):s++}},n.contains=function(t){for(var e=this._items.length,i=0;e>i;i++){var s=this._items[i];if(s.target==t)return!0}return!1},n.clearFor=function(t){for(var e=this._items.length,i=0;e>i;){var s=this._items[i];s.target==t?(s.dispose(),this._items.splice(i,1),e--):i++}},n.clearAll=function(){for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.dispose()}this._items.length=0},n.copyFrom=function(e){this.clearAll();for(var i=e._items,s=i.length,n=0;s>n;n++){var r=i[n],a=new t.RelationItem(this._owner);a.copyFrom(r),this._items.push(a)}},n.dispose=function(){this.clearAll()},n.onOwnerSizeChanged=function(t,e){if(0!=this._items.length)for(var i=this._items.length,s=0;i>s;s++){var n=this._items[s];n.applyOnSelfResized(t,e)}},n.ensureRelationsSizeCorrect=function(){if(0!=this._items.length){this.sizeDirty=!1;for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.target.ensureSizeCorrect()}}},i(n,"empty",function(){return 0==this._items.length}),n.setup=function(t){var e=t.children;if(e)for(var i,s,n=e.length,r=0;n>r;r++){var a=e[r];"relation"==a.name&&(i=a.attributes.target,s=this._owner.parent?i?this._owner.parent.getChildById(i):this._owner.parent:this._owner.getChildById(i),s&&this.addItems(s,a.attributes.sidePair))}},e.RELATION_NAMES=["left-left","left-center","left-right","center-center","right-left","right-center","right-right","top-top","top-middle","top-bottom","middle-middle","bottom-top","bottom-middle","bottom-bottom","width-width","height-height","leftext-left","leftext-right","rightext-left","rightext-right","topext-top","topext-bottom","bottomext-top","bottomext-bottom"],e}();t.Relations=e,egret.registerClass(e,"fairygui.Relations")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function s(n,r,a,h,o,l,_){if(e.call(this),this._viewWidth=0,this._viewHeight=0,this._contentWidth=0,this._contentHeight=0,this._scrollType=0,this._scrollSpeed=0,this._mouseWheelSpeed=0,null==s._easeTypeFunc&&(s._easeTypeFunc=egret.Ease.cubicOut),this._throwTween=new i,this._owner=n,this._maskContainer=new egret.DisplayObjectContainer,this._owner._rootContainer.addChild(this._maskContainer),this._container=this._owner._container,this._container.x=0,this._container.y=0,this._maskContainer.addChild(this._container),this._scrollType=r,this._scrollBarMargin=a,this._bouncebackEffect=t.UIConfig.defaultScrollBounceEffect,this._touchEffect=t.UIConfig.defaultScrollTouchEffect,this._scrollSpeed=t.UIConfig.defaultScrollSpeed,this._mouseWheelSpeed=2*this._scrollSpeed,this._displayOnLeft=0!=(1&o),this._snapToItem=0!=(2&o),this._displayInDemand=0!=(4&o),this._pageMode=0!=(8&o),16&o?this._touchEffect=!0:32&o?this._touchEffect=!1:this._touchEffect=t.UIConfig.defaultScrollTouchEffect,64&o?this._bouncebackEffect=!0:128&o?this._bouncebackEffect=!1:this._bouncebackEffect=t.UIConfig.defaultScrollBounceEffect,this._inertiaDisabled=0!=(256&o),0==(512&o)&&(this._maskContainer.scrollRect=new egret.Rectangle),this._xPerc=0,this._yPerc=0,this._xPos=0,this._yPos=0,this._xOverlap=0,this._yOverlap=0,this._aniFlag=0,this._scrollBarVisible=!0,this._mouseWheelEnabled=!1,this._holdAreaPoint=new egret.Point,h==t.ScrollBarDisplayType.Default&&(h=t.UIConfig.defaultScrollBarDisplay),h!=t.ScrollBarDisplayType.Hidden){if(this._scrollType==t.ScrollType.Both||this._scrollType==t.ScrollType.Vertical){var c=l?l:t.UIConfig.verticalScrollBar;if(c){if(this._vtScrollBar=t.UIPackage.createObjectFromURL(c),!this._vtScrollBar)throw"cannot create scrollbar from "+c;this._vtScrollBar.setScrollPane(this,!0),this._owner._rootContainer.addChild(this._vtScrollBar.displayObject)}}if(this._scrollType==t.ScrollType.Both||this._scrollType==t.ScrollType.Horizontal){var c=_?_:t.UIConfig.horizontalScrollBar;if(c){if(this._hzScrollBar=t.UIPackage.createObjectFromURL(c),!this._hzScrollBar)throw"cannot create scrollbar from "+c;this._hzScrollBar.setScrollPane(this,!1),this._owner._rootContainer.addChild(this._hzScrollBar.displayObject)}}this._scrollBarDisplayAuto=h==t.ScrollBarDisplayType.Auto,this._scrollBarDisplayAuto&&(this._scrollBarVisible=!1,this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=!1),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=!1))}this._contentWidth=0,this._contentHeight=0,this.setSize(n.width,n.height),this._owner.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__mouseDown,this)}__extends(s,e);var n=__define,r=s,a=r.prototype;return n(a,"owner",function(){return this._owner}),n(a,"bouncebackEffect",function(){return this._bouncebackEffect},function(t){this._bouncebackEffect=t}),n(a,"touchEffect",function(){return this._touchEffect},function(t){this._touchEffect=t}),n(a,"scrollSpeed",function(){return this._scrollSpeed},function(e){this._scrollSpeed=this.scrollSpeed,0==this._scrollSpeed&&(this._scrollSpeed=t.UIConfig.defaultScrollSpeed),this._mouseWheelSpeed=2*this._scrollSpeed}),n(a,"snapToItem",function(){return this._snapToItem},function(t){this._snapToItem=t}),n(a,"percX",function(){return this._xPerc},function(t){this.setPercX(t,!1)}),a.setPercX=function(e,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),e=t.ToolSet.clamp01(e),e!=this._xPerc&&(this._xPerc=e,this._xPos=this._xPerc*this._xOverlap,this.posChanged(i))},n(a,"percY",function(){return this._yPerc},function(t){this.setPercY(t,!1)}),a.setPercY=function(e,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),e=t.ToolSet.clamp01(e),e!=this._yPerc&&(this._yPerc=e,this._yPos=this._yPerc*this._yOverlap,this.posChanged(i))},n(a,"posX",function(){return this._xPos},function(t){this.setPosX(t,!1)}),a.setPosX=function(e,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),e=t.ToolSet.clamp(e,0,this._xOverlap),e!=this._xPos&&(this._xPos=e,this._xPerc=0==this._xOverlap?0:this._xPos/this._xOverlap,this.posChanged(i))},n(a,"posY",function(){return this._yPos},function(t){this.setPosY(t,!1)}),a.setPosY=function(e,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),e=t.ToolSet.clamp(e,0,this._yOverlap),e!=this._yPos&&(this._yPos=e,this._yPerc=0==this._yOverlap?0:this._yPos/this._yOverlap,this.posChanged(i))},n(a,"isBottomMost",function(){return 1==this._yPerc||0==this._yOverlap}),n(a,"isRightMost",function(){return 1==this._xPerc||0==this._xOverlap}),n(a,"currentPageX",function(){return this._pageMode?Math.floor(this.posX/this._pageSizeH):0},function(t){this._pageMode&&this._xOverlap>0&&this.setPosX(t*this._pageSizeH,!1)}),n(a,"currentPageY",function(){return this._pageMode?Math.floor(this.posY/this._pageSizeV):0},function(t){this._pageMode&&this._yOverlap>0&&this.setPosY(t*this._pageSizeV,!1)}),n(a,"scrollingPosX",function(){return t.ToolSet.clamp(-this._container.x,0,this._xOverlap)}),n(a,"scrollingPosY",function(){return t.ToolSet.clamp(-this._container.y,0,this._yOverlap)}),n(a,"contentWidth",function(){return this._contentWidth}),n(a,"contentHeight",function(){return this._contentHeight}),n(a,"viewWidth",function(){return this._viewWidth},function(t){t=t+this._owner.margin.left+this._owner.margin.right,null!=this._vtScrollBar&&(t+=this._vtScrollBar.width),this._owner.width=t}),n(a,"viewHeight",function(){return this._viewHeight},function(t){t=t+this._owner.margin.top+this._owner.margin.bottom,null!=this._hzScrollBar&&(t+=this._hzScrollBar.height),this._owner.height=t}),a.getDeltaX=function(t){return t/(this._contentWidth-this._viewWidth)},a.getDeltaY=function(t){return t/(this._contentHeight-this._viewHeight)},a.scrollTop=function(t){void 0===t&&(t=!1),this.setPercY(0,t)},a.scrollBottom=function(t){void 0===t&&(t=!1),this.setPercY(1,t)},a.scrollUp=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercY(this._yPerc-this.getDeltaY(this._scrollSpeed*t),e)},a.scrollDown=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercY(this._yPerc+this.getDeltaY(this._scrollSpeed*t),e)},a.scrollLeft=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercX(this._xPerc-this.getDeltaX(this._scrollSpeed*t),e)},a.scrollRight=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercX(this._xPerc+this.getDeltaX(this._scrollSpeed*t),e)},a.scrollToView=function(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),this._owner.ensureBoundsCorrect(),this._needRefresh&&this.refresh();var r;if(e instanceof t.GObject?e.parent!=this._owner?(e.parent.localToGlobalRect(e.x,e.y,e.width,e.height,s.sHelperRect),r=this._owner.globalToLocalRect(s.sHelperRect.x,s.sHelperRect.y,s.sHelperRect.width,s.sHelperRect.height,s.sHelperRect)):(r=s.sHelperRect,r.setTo(e.x,e.y,e.width,e.height)):r=e,this._yOverlap>0){var a=this.posY,h=a+this._viewHeight;n||r.y<a||r.height>=this._viewHeight?this._pageMode?this.setPosY(Math.floor(r.y/this._pageSizeV)*this._pageSizeV,i):this.setPosY(r.y,i):r.y+r.height>h&&(this._pageMode?this.setPosY(Math.floor(r.y/this._pageSizeV)*this._pageSizeV,i):r.height<=this._viewHeight/2?this.setPosY(r.y+2*r.height-this._viewHeight,i):this.setPosY(r.y+r.height-this._viewHeight,i))}if(this._xOverlap>0){var o=this.posX,l=o+this._viewWidth;n||r.x<o||r.width>=this._viewWidth?this._pageMode?this.setPosX(Math.floor(r.x/this._pageSizeH)*this._pageSizeH,i):this.setPosX(r.x,i):r.x+r.width>l&&(this._pageMode?this.setPosX(Math.floor(r.x/this._pageSizeH)*this._pageSizeH,i):r.width<=this._viewWidth/2?this.setPosX(r.x+2*r.width-this._viewWidth,i):this.setPosX(r.x+r.width-this._viewWidth,i))}!i&&this._needRefresh&&this.refresh()},a.isChildInView=function(t){var e;return this._yOverlap>0&&(e=t.y+this._container.y,e<-t.height-20||e>this._viewHeight+20)?!1:this._xOverlap>0&&(e=t.x+this._container.x,e<-t.width-20||e>this._viewWidth+20)?!1:!0},a.cancelDragging=function(){this._owner.displayObject.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__touchMove,this),this._owner.displayObject.removeEventListener(egret.TouchEvent.TOUCH_END,this.__touchEnd,this),this._owner.displayObject.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__touchTap,this),s.draggingPane==this&&(s.draggingPane=null),s._gestureFlag=0,this.isDragged=!1,this._maskContainer.touchChildren=!0},a.onOwnerSizeChanged=function(){this.setSize(this._owner.width,this._owner.height),this.posChanged(!1)},a.adjustMaskContainer=function(){var t,e;t=this._displayOnLeft&&null!=this._vtScrollBar?Math.floor(this._owner.margin.left+this._vtScrollBar.width):Math.floor(this._owner.margin.left),e=Math.floor(this._owner.margin.top),t+=this._owner._alignOffset.x,e+=this._owner._alignOffset.y,this._maskContainer.x=t,this._maskContainer.y=e},a.setSize=function(t,e){this.adjustMaskContainer(),this._hzScrollBar&&(this._hzScrollBar.y=e-this._hzScrollBar.height,this._vtScrollBar&&!this._vScrollNone?(this._hzScrollBar.width=t-this._vtScrollBar.width-this._scrollBarMargin.left-this._scrollBarMargin.right,this._displayOnLeft?this._hzScrollBar.x=this._scrollBarMargin.left+this._vtScrollBar.width:this._hzScrollBar.x=this._scrollBarMargin.left):(this._hzScrollBar.width=t-this._scrollBarMargin.left-this._scrollBarMargin.right,this._hzScrollBar.x=this._scrollBarMargin.left)),this._vtScrollBar&&(this._displayOnLeft||(this._vtScrollBar.x=t-this._vtScrollBar.width),this._hzScrollBar?this._vtScrollBar.height=e-this._hzScrollBar.height-this._scrollBarMargin.top-this._scrollBarMargin.bottom:this._vtScrollBar.height=e-this._scrollBarMargin.top-this._scrollBarMargin.bottom,this._vtScrollBar.y=this._scrollBarMargin.top),this._viewWidth=t,this._viewHeight=e,this._hzScrollBar&&!this._hScrollNone&&(this._viewHeight-=this._hzScrollBar.height),this._vtScrollBar&&!this._vScrollNone&&(this._viewWidth-=this._vtScrollBar.width),this._viewWidth-=this._owner.margin.left+this._owner.margin.right,this._viewHeight-=this._owner.margin.top+this._owner.margin.bottom,this._viewWidth=Math.max(1,this._viewWidth),this._viewHeight=Math.max(1,this._viewHeight),this._pageSizeH=this._viewWidth,this._pageSizeV=this._viewHeight,this.handleSizeChanged()},a.setContentSize=function(t,e){(this._contentWidth!=t||this._contentHeight!=e)&&(this._contentWidth=t,this._contentHeight=e,this.handleSizeChanged())},a.changeContentSizeOnScrolling=function(t,e,i,s){if(this._contentWidth+=t,this._contentHeight+=e,this.isDragged){0!=i&&(this._container.x-=i),0!=s&&(this._container.y-=s),this.validateHolderPos(),this._xOffset+=i,this._yOffset+=s;var n=this._y2-this._y1;this._y1=this._container.y,this._y2=this._y1+n,n=this._x2-this._x1,this._x1=this._container.x,this._x2=this._x1+n,this._yPos=-this._container.y,this._xPos=-this._container.x}else 2==this._tweening&&(0!=i&&(this._container.x-=i,this._throwTween.start.x-=i),0!=s&&(this._container.y-=s,this._throwTween.start.y-=s));this.handleSizeChanged(!0)},a.handleSizeChanged=function(e){void 0===e&&(e=!1),this._displayInDemand&&(this._vtScrollBar&&(this._contentHeight<=this._viewHeight?this._vScrollNone||(this._vScrollNone=!0,this._viewWidth+=this._vtScrollBar.width):this._vScrollNone&&(this._vScrollNone=!1,this._viewWidth-=this._vtScrollBar.width)),this._hzScrollBar&&(this._contentWidth<=this._viewWidth?this._hScrollNone||(this._hScrollNone=!0,this._viewHeight+=this._hzScrollBar.height):this._hScrollNone&&(this._hScrollNone=!1,this._viewHeight-=this._hzScrollBar.height))),this._vtScrollBar&&(this._viewHeight<this._vtScrollBar.minSize?this._vtScrollBar.displayObject.visible=!1:(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone,0==this._contentHeight?this._vtScrollBar.displayPerc=0:this._vtScrollBar.displayPerc=Math.min(1,this._viewHeight/this._contentHeight))),this._hzScrollBar&&(this._viewWidth<this._hzScrollBar.minSize?this._hzScrollBar.displayObject.visible=!1:(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone,0==this._contentWidth?this._hzScrollBar.displayPerc=0:this._hzScrollBar.displayPerc=Math.min(1,this._viewWidth/this._contentWidth)));var i=this._maskContainer.scrollRect;null!=i&&(i.setTo(0,0,this._viewWidth,this._viewHeight),this._maskContainer.scrollRect=i),this._scrollType==t.ScrollType.Horizontal||this._scrollType==t.ScrollType.Both?this._xOverlap=Math.ceil(Math.max(0,this._contentWidth-this._viewWidth)):this._xOverlap=0,this._scrollType==t.ScrollType.Vertical||this._scrollType==t.ScrollType.Both?this._yOverlap=Math.ceil(Math.max(0,this._contentHeight-this._viewHeight)):this._yOverlap=0,0==this._tweening&&e?((0==this._xPerc||1==this._xPerc)&&(this._xPos=this._xPerc*this._xOverlap,this._container.x=-this._xPos),(0==this._yPerc||1==this._yPerc)&&(this._yPos=this._yPerc*this._yOverlap,this._container.y=-this._yPos)):(this._xPos=t.ToolSet.clamp(this._xPos,0,this._xOverlap),this._xPerc=this._xOverlap>0?this._xPos/this._xOverlap:0,this._yPos=t.ToolSet.clamp(this._yPos,0,this._yOverlap),this._yPerc=this._yOverlap>0?this._yPos/this._yOverlap:0),this.validateHolderPos(),null!=this._vtScrollBar&&(this._vtScrollBar.scrollPerc=this._yPerc),null!=this._hzScrollBar&&(this._hzScrollBar.scrollPerc=this._xPerc)},a.validateHolderPos=function(){this._container.x=t.ToolSet.clamp(this._container.x,-this._xOverlap,0),this._container.y=t.ToolSet.clamp(this._container.y,-this._yOverlap,0)},a.posChanged=function(e){0==this._aniFlag?this._aniFlag=e?1:-1:1!=this._aniFlag||e||(this._aniFlag=-1),this._needRefresh=!0,t.GTimers.inst.callLater(this.refresh,this),2==this._tweening&&this.killTween()},a.killTween=function(){1==this._tweening?(this._tweener.setPaused(!0),this._tweening=0,this._tweener=null,this.syncScrollBar(!0)):2==this._tweening&&(this._tweener.setPaused(!0),this._tweener=null,this._tweening=0,this.validateHolderPos(),this.syncScrollBar(!0),this.dispatchEventWith(s.SCROLL_END,!1))},a.refresh=function(){if(this._needRefresh=!1,t.GTimers.inst.remove(this.refresh,this),this._pageMode){var e,i;this._yOverlap>0&&1!=this._yPerc&&0!=this._yPerc&&(e=Math.floor(this._yPos/this._pageSizeV),i=this._yPos-e*this._pageSizeV,i>this._pageSizeV/2&&e++,this._yPos=e*this._pageSizeV,this._yPos>this._yOverlap?(this._yPos=this._yOverlap,this._yPerc=1):this._yPerc=this._yPos/this._yOverlap),this._xOverlap>0&&1!=this._xPerc&&0!=this._xPerc&&(e=Math.floor(this._xPos/this._pageSizeH),i=this._xPos-e*this._pageSizeH,i>this._pageSizeH/2&&e++,this._xPos=e*this._pageSizeH,this._xPos>this._xOverlap?(this._xPos=this._xOverlap,this._xPerc=1):this._xPerc=this._xPos/this._xOverlap)}else if(this._snapToItem){var n=this._owner.getSnappingPosition(1==this._xPerc?0:this._xPos,1==this._yPerc?0:this._yPos,s.sHelperPoint);1!=this._xPerc&&n.x!=this._xPos&&(this._xPos=n.x,this._xPerc=this._xPos/this._xOverlap,this._xPerc>1&&(this._xPerc=1,this._xPos=this._xOverlap)),1!=this._yPerc&&n.y!=this._yPos&&(this._yPos=n.y,this._yPerc=this._yPos/this._yOverlap,this._yPerc>1&&(this._yPerc=1,this._yPos=this._yOverlap))}this.refresh2(),this.dispatchEventWith(s.SCROLL,!1),this._needRefresh&&(this._needRefresh=!1,t.GTimers.inst.remove(this.refresh,this),this.refresh2()),this._aniFlag=0},a.refresh2=function(){var t=Math.floor(this._xPos),e=Math.floor(this._yPos);if(1!=this._aniFlag||this.isDragged)null!=this._tweener&&this.killTween(),this.isDragged&&(this._xOffset+=this._container.x- -t,this._yOffset+=this._container.y- -e),this._container.y=-e,this._container.x=-t,this.isDragged&&(this._y1=this._y2=this._container.y,this._x1=this._x2=this._container.x),this._vtScrollBar&&(this._vtScrollBar.scrollPerc=this._yPerc),this._hzScrollBar&&(this._hzScrollBar.scrollPerc=this._xPerc);else{var i=this._container.x,n=this._container.y;this._yOverlap>0?n=-e:0!=this._container.y&&(this._container.y=0),this._xOverlap>0?i=-t:0!=this._container.x&&(this._container.x=0),(i!=this._container.x||n!=this._container.y)&&(null!=this._tweener&&this.killTween(),this._tweening=1,this._maskContainer.touchChildren=!1,this._tweener=egret.Tween.get(this._container,{onChange:this.__tweenUpdate,onChangeObj:this}).to({x:i,y:n},500,s._easeTypeFunc).call(this.__tweenComplete,this))}},a.syncPos=function(){this._xOverlap>0&&(this._xPos=t.ToolSet.clamp(-this._container.x,0,this._xOverlap),this._xPerc=this._xPos/this._xOverlap),this._yOverlap>0&&(this._yPos=t.ToolSet.clamp(-this._container.y,0,this._yOverlap),this._yPerc=this._yPos/this._yOverlap)},a.syncScrollBar=function(e){void 0===e&&(e=!1),e?(this._vtScrollBar&&this._scrollBarDisplayAuto&&this.showScrollBar(!1),this._hzScrollBar&&this._scrollBarDisplayAuto&&this.showScrollBar(!1),this._maskContainer.touchChildren=!0):(this._vtScrollBar&&(this._vtScrollBar.scrollPerc=0==this._yOverlap?0:t.ToolSet.clamp(-this._container.y,0,this._yOverlap)/this._yOverlap,this._scrollBarDisplayAuto&&this.showScrollBar(!0)),this._hzScrollBar&&(this._hzScrollBar.scrollPerc=0==this._xOverlap?0:t.ToolSet.clamp(-this._container.x,0,this._xOverlap)/this._xOverlap,this._scrollBarDisplayAuto&&this.showScrollBar(!0)))
},a.__mouseDown=function(t){this._touchEffect&&(null!=this._tweener&&this.killTween(),this._maskContainer.globalToLocal(t.stageX,t.stageY,s.sHelperPoint),this._x1=this._x2=this._container.x,this._y1=this._y2=this._container.y,this._xOffset=s.sHelperPoint.x-this._container.x,this._yOffset=s.sHelperPoint.y-this._container.y,this._time1=this._time2=egret.getTimer(),this._holdAreaPoint.x=s.sHelperPoint.x,this._holdAreaPoint.y=s.sHelperPoint.y,this._isHoldAreaDone=!1,this.isDragged=!1,this._owner.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__touchMove,this),this._owner.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.__touchEnd,this),this._owner.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__touchTap,this))},a.__touchMove=function(e){if(null!=this._owner.displayObject.stage&&this._touchEffect&&(null==s.draggingPane||s.draggingPane==this)&&null==t.GObject.draggingObject){var i,n,r,a,h,o=t.UIConfig.touchScrollSensitivity,l=this._maskContainer.globalToLocal(e.stageX,e.stageY,s.sHelperPoint);if(this._scrollType==t.ScrollType.Vertical){if(!this._isHoldAreaDone){if(s._gestureFlag|=1,i=Math.abs(this._holdAreaPoint.y-l.y),o>i)return;if(0!=(2&s._gestureFlag)&&(n=Math.abs(this._holdAreaPoint.x-l.x),n>i))return}r=!0}else if(this._scrollType==t.ScrollType.Horizontal){if(!this._isHoldAreaDone){if(s._gestureFlag|=2,i=Math.abs(this._holdAreaPoint.x-l.x),o>i)return;if(0!=(1&s._gestureFlag)&&(n=Math.abs(this._holdAreaPoint.y-l.y),n>i))return}a=!0}else{if(s._gestureFlag=3,!this._isHoldAreaDone&&(i=Math.abs(this._holdAreaPoint.y-l.y),o>i&&(i=Math.abs(this._holdAreaPoint.x-l.x),o>i)))return;r=a=!0}var _=egret.getTimer();if(_-this._time2>50&&(this._time2=this._time1,this._time1=_,h=!0),r){var c=Math.floor(s.sHelperPoint.y-this._yOffset);c>0?!this._bouncebackEffect||this._inertiaDisabled?this._container.y=0:this._container.y=Math.floor(.5*c):c<-this._yOverlap||this._inertiaDisabled?this._bouncebackEffect?this._container.y=Math.floor(.5*(c-this._yOverlap)):this._container.y=-Math.floor(this._yOverlap):this._container.y=c,h&&(this._y2=this._y1,this._y1=this._container.y)}if(a){var u=Math.floor(s.sHelperPoint.x-this._xOffset);u>0?!this._bouncebackEffect||this._inertiaDisabled?this._container.x=0:this._container.x=Math.floor(.5*u):u<0-this._xOverlap||this._inertiaDisabled?this._bouncebackEffect?this._container.x=Math.floor(.5*(u-this._xOverlap)):this._container.x=-Math.floor(this._xOverlap):this._container.x=u,h&&(this._x2=this._x1,this._x1=this._container.x)}s.draggingPane=this,this._maskContainer.touchChildren=!1,this._isHoldAreaDone=!0,this.isDragged=!0,this.syncPos(),this.syncScrollBar(),this.dispatchEventWith(s.SCROLL,!1)}},a.__touchEnd=function(e){if(e.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__touchMove,this),e.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.__touchEnd,this),e.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__touchTap,this),s.draggingPane==this&&(s.draggingPane=null),s._gestureFlag=0,this.isDragged&&this._touchEffect&&!this._inertiaDisabled&&null!=this._owner.displayObject.stage){var n=(egret.getTimer()-this._time2)/1e3;0==n&&(n=.001);var r=(this._container.y-this._y2)/n*2*t.UIConfig.defaultTouchScrollSpeedRatio,a=(this._container.x-this._x2)/n*2*t.UIConfig.defaultTouchScrollSpeedRatio,h=.3;this._throwTween.start.x=this._container.x,this._throwTween.start.y=this._container.y;var o,l=this._throwTween.change1,_=this._throwTween.change2,c=0,u=0,d=0,g=0,p=0;if(this._scrollType==t.ScrollType.Both||this._scrollType==t.ScrollType.Horizontal?(this._container.x>t.UIConfig.touchDragSensitivity?p=1:this._container.x<-this._xOverlap-t.UIConfig.touchDragSensitivity&&(p=2),l.x=i.calculateChange(a,h),_.x=0,c=this._container.x+l.x,this._pageMode&&0>c&&c>-this._xOverlap&&(d=Math.floor(-c/this._pageSizeH),o=Math.min(this._pageSizeH,this._contentWidth-(d+1)*this._pageSizeH),g=-c-d*this._pageSizeH,Math.abs(l.x)>this._pageSizeH?g>.5*o&&d++:g>o*(l.x<0?.3:.7)&&d++,c=-d*this._pageSizeH,c<-this._xOverlap&&(c=-this._xOverlap),l.x=c-this._container.x)):l.x=_.x=0,this._scrollType==t.ScrollType.Both||this._scrollType==t.ScrollType.Vertical?(this._container.y>t.UIConfig.touchDragSensitivity?p=1:this._container.y<-this._yOverlap-t.UIConfig.touchDragSensitivity&&(p=2),l.y=i.calculateChange(r,h),_.y=0,u=this._container.y+l.y,this._pageMode&&0>u&&u>-this._yOverlap&&(d=Math.floor(-u/this._pageSizeV),o=Math.min(this._pageSizeV,this._contentHeight-(d+1)*this._pageSizeV),g=-u-d*this._pageSizeV,Math.abs(l.y)>this._pageSizeV?g>.5*o&&d++:g>o*(l.y<0?.3:.7)&&d++,u=-d*this._pageSizeV,u<-this._yOverlap&&(u=-this._yOverlap),l.y=u-this._container.y)):l.y=_.y=0,this._snapToItem&&!this._pageMode){c=-c,u=-u;var f=this._owner.getSnappingPosition(c,u,s.sHelperPoint);c=-f.x,u=-f.y,l.x=c-this._container.x,l.y=u-this._container.y}this._bouncebackEffect?(c>0?_.x=0-this._container.x-l.x:c<-this._xOverlap&&(_.x=-this._xOverlap-this._container.x-l.x),u>0?_.y=0-this._container.y-l.y:u<-this._yOverlap&&(_.y=-this._yOverlap-this._container.y-l.y)):(c>0?l.x=0-this._container.x:c<-this._xOverlap&&(l.x=-this._xOverlap-this._container.x),u>0?l.y=0-this._container.y:u<-this._yOverlap&&(l.y=-this._yOverlap-this._container.y)),this._throwTween.value=0,this._throwTween.change1=l,this._throwTween.change2=_,null!=this._tweener&&this.killTween(),this._tweening=2,this._tweener=egret.Tween.get(this._throwTween,{onChange:this.__tweenUpdate2,onChangeObj:this}).to({value:1},1e3*h,s._easeTypeFunc).call(this.__tweenComplete2,this),1==p?this.dispatchEventWith(s.PULL_DOWN_RELEASE):2==p&&this.dispatchEventWith(s.PULL_UP_RELEASE)}},a.__touchTap=function(t){this.isDragged=!1},a.__rollOver=function(t){this.showScrollBar(!0)},a.__rollOut=function(t){this.showScrollBar(!1)},a.showScrollBar=function(e){e?(this.__showScrollBar(!0),t.GTimers.inst.remove(this.__showScrollBar,this)):t.GTimers.inst.add(500,1,this.__showScrollBar,this,e)},a.__showScrollBar=function(t){this._scrollBarVisible=t&&this._viewWidth>0&&this._viewHeight>0,this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone)},a.__tweenUpdate=function(){this.syncScrollBar(),this.dispatchEventWith(s.SCROLL,!1)},a.__tweenComplete=function(){this._tweening=0,this._tweener=null,this.validateHolderPos(),this.syncScrollBar(!0),this.dispatchEventWith(s.SCROLL,!1)},a.__tweenUpdate2=function(){this._throwTween.update(this._container),this.syncPos(),this.syncScrollBar(),this.dispatchEventWith(s.SCROLL,!1)},a.__tweenComplete2=function(){this._tweening=0,this._tweener=null,this.validateHolderPos(),this.syncPos(),this.syncScrollBar(!0),this.dispatchEventWith(s.SCROLL,!1),this.dispatchEventWith(s.SCROLL_END,!1)},s._gestureFlag=0,s.SCROLL="__scroll",s.SCROLL_END="__scrollEnd",s.PULL_DOWN_RELEASE="pullDownRelease",s.PULL_UP_RELEASE="pullUpRelease",s.sHelperRect=new egret.Rectangle,s.sHelperPoint=new egret.Point,s}(egret.EventDispatcher);t.ScrollPane=e,egret.registerClass(e,"fairygui.ScrollPane");var i=function(){function t(){this.start=new egret.Point,this.change1=new egret.Point,this.change2=new egret.Point}var e=(__define,t),i=e.prototype;return i.update=function(t){t.x=Math.floor(this.start.x+this.change1.x*this.value+this.change2.x*this.value*this.value),t.y=Math.floor(this.start.y+this.change1.y*this.value+this.change2.y*this.value*this.value)},t.calculateChange=function(e,i){return i*t.checkpoint*e/t.easeOutCubic(t.checkpoint,0,1,1)},t.easeOutCubic=function(t,e,i,s){return i*((t=t/s-1)*t*t+1)+e},t.checkpoint=.05,t}();egret.registerClass(i,"ThrowTween")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.defaultFont="",e.modalLayerColor=3355443,e.modalLayerAlpha=.2,e.buttonSoundVolumeScale=1,e.defaultScrollSpeed=25,e.defaultTouchScrollSpeedRatio=1,e.defaultScrollBarDisplay=t.ScrollBarDisplayType.Visible,e.defaultScrollTouchEffect=!0,e.defaultScrollBounceEffect=!0,e.defaultComboBoxVisibleItemCount=10,e.touchScrollSensitivity=20,e.touchDragSensitivity=10,e.clickDragSensitivity=2,e.bringWindowToFrontOnClick=!0,e.frameTimeForAsyncUIConstruction=2,e}();t.UIConfig=e,egret.registerClass(e,"fairygui.UIConfig")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.setPackageItemExtension=function(t,i){e.packageItemExtensions[t.substring(5)]=i},e.setLoaderExtension=function(t){e.loaderExtension=t},e.newObject=function(i){switch(i.type){case t.PackageItemType.Image:return new t.GImage;case t.PackageItemType.MovieClip:return new t.GMovieClip;case t.PackageItemType.Component:var s=e.packageItemExtensions[i.owner.id+i.id];if(s)return new s;var n=i.owner.getItemAsset(i),r=n.attributes.extention;if(null==r)return new t.GComponent;switch(r){case"Button":return new t.GButton;case"Label":return new t.GLabel;case"ProgressBar":return new t.GProgressBar;case"Slider":return new t.GSlider;case"ScrollBar":return new t.GScrollBar;case"ComboBox":return new t.GComboBox;default:return new t.GComponent}}return null},e.newObject2=function(i){switch(i){case"image":return new t.GImage;case"movieclip":return new t.GMovieClip;case"component":return new t.GComponent;case"text":return new t.GTextField;case"richtext":return new t.GRichTextField;case"inputtext":return new t.GTextInput;case"group":return new t.GGroup;case"list":return new t.GList;case"graph":return new t.GGraph;case"loader":return null!=e.loaderExtension?new e.loaderExtension:new t.GLoader}return null},e.packageItemExtensions={},e}();t.UIObjectFactory=e,egret.registerClass(e,"fairygui.UIObjectFactory")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(){this._items=new Array,this._sprites={}}var s=__define,n=e,r=n.prototype;return e.getById=function(t){return e._packageInstById[t]},e.getByName=function(t){return e._packageInstByName[t]},e.addPackage=function(t){var i=new e;return i.create(t),e._packageInstById[i.id]=i,e._packageInstByName[i.name]=i,i.customId=t,i},e.removePackage=function(t){var i=e._packageInstById[t];i.dispose(),delete e._packageInstById[i.id],null!=i._customId&&delete e._packageInstById[i._customId],delete e._packageInstByName[i.name]},e.createObject=function(t,i,s){void 0===s&&(s=null);var n=e.getByName(t);return n?n.createObject(i,s):null},e.createObjectFromURL=function(t,i){void 0===i&&(i=null);var s=e.getItemByURL(t);return s?s.owner.internalCreateObject(s,i):null},e.getItemURL=function(t,i){var s=e.getByName(t);if(!s)return null;var n=s._itemsByName[i];return n?"ui://"+s.id+n.id:null},e.getItemByURL=function(i){if(t.ToolSet.startsWith(i,"ui://")){var s=i.substr(5,8),n=i.substr(13),r=e.getById(s);if(r)return r.getItemById(n)}return null},e.getBitmapFontByURL=function(t){return e._bitmapFonts[t]},e.setStringsSource=function(t){e._stringsSource={};for(var i=egret.XML.parse(t),s=i.children,n=s.length,r=0;n>r;r++){var a=s[r];if("string"==a.name){var h=a.attributes.name,o=a.children.length>0?a.children[0].text:"",l=h.indexOf("-");if(-1==l)continue;var _=h.substr(0,l),c=h.substr(l+1),u=e._stringsSource[_];u||(u={},e._stringsSource[_]=u),u[c]=o}}},r.create=function(t){this._resKey=t,this.loadPackage()},r.loadPackage=function(){var s,n,r=RES.getRes(this._resKey);if(r||(r=RES.getRes(this._resKey+"_fui")),!r)throw"Resource '"+this._resKey+"' not found, please check default.res.json!";this.decompressPackage(r),s=this.getDesc("sprites.bytes"),n=s.split(e.sep1);for(var a=n.length,h=1;a>h;h++)if(s=n[h]){var o=s.split(e.sep2),l=new i,_=o[0],c=parseInt(o[1]);if(c>=0)l.atlas="atlas"+c;else{var u=_.indexOf("_");-1==u?l.atlas="atlas_"+_:l.atlas="atlas_"+_.substr(0,u)}l.rect.x=parseInt(o[2]),l.rect.y=parseInt(o[3]),l.rect.width=parseInt(o[4]),l.rect.height=parseInt(o[5]),l.rotated="1"==o[6],this._sprites[_]=l}s=this.getDesc("package.xml");var d=egret.XML.parse(s);this._id=d.attributes.id,this._name=d.attributes.name;var g=d.children[0].children;this._itemsById={},this._itemsByName={};for(var p,f,v=g.length,m=0;v>m;m++){switch(f=g[m],p=new t.PackageItem,p.type=t.parsePackageItemType(f.name),p.id=f.attributes.id,p.name=f.attributes.name,p.file=f.attributes.file,s=f.attributes.size,s&&(n=s.split(e.sep0),p.width=parseInt(n[0]),p.height=parseInt(n[1])),p.type){case t.PackageItemType.Image:s=f.attributes.scale,"9grid"==s?(p.scale9Grid=new egret.Rectangle,s=f.attributes.scale9grid,s&&(n=s.split(e.sep0),p.scale9Grid.x=parseInt(n[0]),p.scale9Grid.y=parseInt(n[1]),p.scale9Grid.width=parseInt(n[2]),p.scale9Grid.height=parseInt(n[3]),s=f.attributes.gridTile,s&&(p.tileGridIndice=parseInt(s)))):"tile"==s&&(p.scaleByTile=!0),s=f.attributes.smoothing,p.smoothing="false"!=s}p.owner=this,this._items.push(p),this._itemsById[p.id]=p,null!=p.name&&(this._itemsByName[p.name]=p)}for(a=this._items.length,h=0;a>h;h++)p=this._items[h],p.type==t.PackageItemType.Font&&(this.loadFont(p),e._bitmapFonts[p.bitmapFont.id]=p.bitmapFont)},r.decompressPackage=function(t){this._resData={};for(var e,i,s=new Zlib.RawInflate(t),n=s.decompress(),r=new egret.ByteArray,a=r.decodeUTF8(n),h=0;;){var o=a.indexOf("|",h);if(-1==o)break;e=a.substring(h,o),h=o+1,o=a.indexOf("|",h),i=parseInt(a.substring(h,o)),h=o+1,this._resData[e]=a.substr(h,i),h+=i}},r.dispose=function(){for(var t=this._items.length,i=0;t>i;i++){var s=this._items[i],n=s.texture;if(null!=n)n.dispose();else if(null!=s.frames)for(var r=s.frames.length,a=0;r>a;a++)n=s.frames[a].texture,null!=n&&n.dispose();else null!=s.bitmapFont&&delete e._bitmapFonts[s.bitmapFont.id]}},s(r,"id",function(){return this._id}),s(r,"name",function(){return this._name}),s(r,"customId",function(){return this._customId},function(t){null!=this._customId&&delete e._packageInstById[this._customId],this._customId=t,null!=this._customId&&(e._packageInstById[this._customId]=this)}),r.createObject=function(t,e){void 0===e&&(e=null);var i=this._itemsByName[t];return i?this.internalCreateObject(i,e):null},r.internalCreateObject=function(i,s){void 0===s&&(s=null);var n;return n=i.type==t.PackageItemType.Component&&null!=s?new s:t.UIObjectFactory.newObject(i),null==n?null:(e._constructing++,n.packageItem=i,n.constructFromResource(),e._constructing--,n)},r.getItemById=function(t){return this._itemsById[t]},r.getItemByName=function(t){return this._itemsByName[t]},r.getItemAssetByName=function(t){var e=this._itemsByName[t];if(null==e)throw"Resource not found -"+t;return this.getItemAsset(e)},r.getItemAsset=function(e){switch(e.type){case t.PackageItemType.Image:if(!e.decoded){e.decoded=!0;var i=this._sprites[e.id];null!=i&&(e.texture=this.createSpriteTexture(i))}return e.texture;case t.PackageItemType.Atlas:if(!e.decoded){e.decoded=!0;var s=null!=e.file&&e.file.length>0?e.file:e.id+".png";e.texture=RES.getRes(this._resKey+"@"+t.ToolSet.getFileName(s)),e.texture||(e.texture=RES.getRes(this._resKey+"@"+s.replace(".","_")))}return e.texture;case t.PackageItemType.Sound:if(!e.decoded){e.decoded=!0;var s=null!=e.file&&e.file.length>0?e.file:e.id+".mp3";e.sound=RES.getRes(this._resKey+"@"+t.ToolSet.getFileName(s)),e.sound||(e.sound=RES.getRes(this._resKey+"@"+s.replace(".","_")))}return e.sound;case t.PackageItemType.Font:return e.decoded||(e.decoded=!0,this.loadFont(e)),e.bitmapFont;case t.PackageItemType.MovieClip:return e.decoded||(e.decoded=!0,this.loadMovieClip(e)),e.frames;case t.PackageItemType.Component:if(!e.decoded){e.decoded=!0;var n=this.getDesc(e.id+".xml"),r=egret.XML.parse(n);e.componentData=r,this.loadComponentChildren(e),this.translateComponent(e)}return e.componentData;default:return RES.getRes(this._resKey+"@"+e.id)}},r.loadComponentChildren=function(i){var s=t.ToolSet.findChildNode(i.componentData,"displayList");if(null!=s){var n=s.children,r=n.length;i.displayList=new Array(r);for(var a,h=0;r>h;h++){var o=n[h],l=o.name,_=o.attributes.src;if(_){var c,u=o.attributes.pkg;c=u&&u!=i.owner.id?e.getById(u):i.owner;var d=null!=c?c.getItemById(_):null;a=null!=d?new t.DisplayListItem(d,null):new t.DisplayListItem(null,l)}else a="text"==l&&"true"==o.attributes.input?new t.DisplayListItem(null,"inputtext"):new t.DisplayListItem(null,l);a.desc=o,i.displayList[h]=a}}else i.displayList=new Array},r.getDesc=function(t){return this._resData[t]},r.translateComponent=function(i){if(null!=e._stringsSource){var s=e._stringsSource[this.id+i.id];if(null!=s){var n,r,a,h,o,l,_,c,u,d,g,p,f=i.displayList.length;for(u=0;f>u;u++)if(a=i.displayList[u].desc,l=a.name,_=a.attributes.id,p=a.attributes.tooltips,p&&(r=s[_+"-tips"],void 0!=r&&(a.attributes.tooltips=r)),h=t.ToolSet.findChildNode(a,"gearText"),h&&(r=s[_+"-texts"],void 0!=r&&(h.attributes.values=r),r=s[_+"-texts_def"],void 0!=r&&(h.attributes["default"]=r)),"text"==l||"richtext"==l)r=s[_],void 0!=r&&(a.attributes.text=r),r=s[_+"-prompt"],void 0!=r&&(a.attributes.prompt=r);else if("list"==l)for(c=a.children,n=c.length,g=0,d=0;n>d;d++)o=c[d],"item"==o.name&&(r=s[_+"-"+g],void 0!=r&&(o.attributes.title=r),g++);else if("component"==l){if(h=t.ToolSet.findChildNode(a,"Button")){r=s[_],void 0!=r&&(h.attributes.title=r),r=s[_+"-0"],void 0!=r&&(h.attributes.selectedTitle=r);continue}if(h=t.ToolSet.findChildNode(a,"Label")){r=s[_],void 0!=r&&(h.attributes.title=r);continue}if(h=t.ToolSet.findChildNode(a,"ComboBox")){for(r=s[_],void 0!=r&&(h.attributes.title=r),c=h.children,n=c.length,g=0,d=0;n>d;d++)o=c[d],"item"==o.name&&(r=s[_+"-"+g],void 0!=r&&(o.attributes.title=r),g++);continue}}}}},r.createSpriteTexture=function(t){var e=this._itemsById[t.atlas];if(null!=e){var i=this.getItemAsset(e);return null==i?null:this.createSubTexture(i,t.rect)}return null},r.createSubTexture=function(t,e){var i=new egret.Texture;return i._bitmapData=t._bitmapData,i.$initData(t._bitmapX+e.x,t._bitmapY+e.y,e.width,e.height,0,0,e.width,e.height,t._sourceWidth,t._sourceHeight),i},r.loadMovieClip=function(i){var s,n,r=egret.XML.parse(this.getDesc(i.id+".xml"));s=r.attributes.interval,null!=s&&(i.interval=parseInt(s)),s=r.attributes.swing,null!=s&&(i.swing="true"==s),s=r.attributes.repeatDelay,null!=s&&(i.repeatDelay=parseInt(s));var a=parseInt(r.attributes.frameCount);i.frames=new Array(a);for(var h=r.children[0].children,o=0;a>o;o++){var l=new t.Frame,_=h[o];if(s=_.attributes.rect,n=s.split(e.sep0),l.rect=new egret.Rectangle(parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])),s=_.attributes.addDelay,s&&(l.addDelay=parseInt(s)),i.frames[o]=l,0!=l.rect.width){s=_.attributes.sprite,s=s?i.id+"_"+s:i.id+"_"+o;var c=this._sprites[s];null!=c&&(l.texture=this.createSpriteTexture(c))}}},r.loadFont=function(i){var s=new t.BitmapFont;s.id="ui://"+this.id+i.id;var n,r,a=this.getDesc(i.id+".fnt"),h=a.split(e.sep1),o=h.length,l=0,_={},c=!1,u=0,d=0,g=!1,p=0,f=0,v=0;for(l=0;o>l;l++)if(a=h[l],0!=a.length){a=t.ToolSet.trim(a);for(var m=a.split(e.sep2),y=1;y<m.length;y++){var w=m[y].split(e.sep3);_[w[0]]=w[1]}if(a=m[0],"char"==a){var b=new t.BMGlyph;b.x=isNaN(_.x)?0:parseInt(_.x),b.y=isNaN(_.y)?0:parseInt(_.y),b.offsetX=isNaN(_.xoffset)?0:parseInt(_.xoffset),b.offsetY=isNaN(_.yoffset)?0:parseInt(_.yoffset),b.width=isNaN(_.width)?0:parseInt(_.width),b.height=isNaN(_.height)?0:parseInt(_.height),b.advance=isNaN(_.xadvance)?0:parseInt(_.xadvance),void 0!=_.chnl&&(b.channel=parseInt(_.chnl),15==b.channel?b.channel=4:1==b.channel?b.channel=3:2==b.channel?b.channel=2:b.channel=1),c?null!=r&&(b.texture=this.createSubTexture(r,new egret.Rectangle(b.x+p,b.y+f,b.width,b.height))):_.img&&(n=this._itemsById[_.img],null!=n&&(n.load(),b.width=n.width,b.height=n.height,b.texture=n.texture)),c?b.lineHeight=v:(0==b.advance&&(0==d?b.advance=b.offsetX+b.width:b.advance=d),b.lineHeight=b.offsetY<0?b.height:b.offsetY+b.height,u>0&&b.lineHeight<u&&(b.lineHeight=u)),s.glyphs[String.fromCharCode(_.id)]=b}else if("info"==a){if(c=null!=_.face,isNaN(_.size)||(u=parseInt(_.size)),g="true"==_.resizable,c){var C=this._sprites[i.id];if(null!=C){p=C.rect.x,f=C.rect.y;var x=this._itemsById[C.atlas];null!=x&&(r=this.getItemAsset(x))}}}else"common"==a&&(isNaN(_.lineHeight)||(v=parseInt(_.lineHeight)),0==u?u=v:0==v&&(v=u),isNaN(_.xadvance)||(d=parseInt(_.xadvance)))}0==u&&b&&(u=b.height),s.ttf=c,s.size=u,s.resizable=g,i.bitmapFont=s},e._constructing=0,e._packageInstById={},e._packageInstByName={},e._bitmapFonts={},e._stringsSource=null,e.sep0=",",e.sep1="\n",e.sep2=" ",e.sep3="=",e}();t.UIPackage=e,egret.registerClass(e,"fairygui.UIPackage");var i=function(){function t(){this.rect=new egret.Rectangle}var e=(__define,t);e.prototype;return t}();egret.registerClass(i,"AtlasSprite")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(e){function i(){e.call(this),this._requestingCmd=0,this.focusable=!0,this._uiSources=new Array,this.bringToFontOnClick=t.UIConfig.bringWindowToFrontOnClick,this.displayObject.addEventListener(egret.Event.ADDED_TO_STAGE,this.__onShown,this),this.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.__onHidden,this),this.displayObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__mouseDown,this,!0)}__extends(i,e);var s=__define,n=i,r=n.prototype;return r.addUISource=function(t){this._uiSources.push(t)},s(r,"contentPane",function(){return this._contentPane},function(e){this._contentPane!=e&&(null!=this._contentPane&&this.removeChild(this._contentPane),this._contentPane=e,null!=this._contentPane&&(this.addChild(this._contentPane),this.setSize(this._contentPane.width,this._contentPane.height),this._contentPane.addRelation(this,t.RelationType.Size),this._frame=this._contentPane.getChild("frame"),null!=this._frame&&(this.closeButton=this._frame.getChild("closeButton"),this.dragArea=this._frame.getChild("dragArea"),this.contentArea=this._frame.getChild("contentArea"))))}),s(r,"frame",function(){return this._frame}),s(r,"closeButton",function(){return this._closeButton},function(t){null!=this._closeButton&&this._closeButton.removeClickListener(this.closeEventHandler,this),this._closeButton=t,null!=this._closeButton&&this._closeButton.addClickListener(this.closeEventHandler,this)}),s(r,"dragArea",function(){return this._dragArea},function(e){this._dragArea!=e&&(null!=this._dragArea&&(this._dragArea.draggable=!1,this._dragArea.removeEventListener(t.DragEvent.DRAG_START,this.__dragStart,this)),this._dragArea=e,null!=this._dragArea&&(this._dragArea instanceof t.GGraph&&null==this._dragArea.displayObject&&this._dragArea.asGraph.drawRect(0,0,0,0,0),this._dragArea.draggable=!0,this._dragArea.addEventListener(t.DragEvent.DRAG_START,this.__dragStart,this)))}),s(r,"contentArea",function(){return this._contentArea},function(t){this._contentArea=t}),r.show=function(){t.GRoot.inst.showWindow(this)},r.showOn=function(t){t.showWindow(this)},r.hide=function(){this.isShowing&&this.doHideAnimation()},r.hideImmediately=function(){var e=this.parent instanceof t.GRoot?this.parent:null;e||(e=t.GRoot.inst),e.hideWindowImmediately(this)},r.centerOn=function(e,i){void 0===i&&(i=!1),this.setXY(Math.round((e.width-this.width)/2),Math.round((e.height-this.height)/2)),i&&(this.addRelation(e,t.RelationType.Center_Center),this.addRelation(e,t.RelationType.Middle_Middle))},r.toggleStatus=function(){this.isTop?this.hide():this.show()},s(r,"isShowing",function(){return null!=this.parent}),s(r,"isTop",function(){return null!=this.parent&&this.parent.getChildIndex(this)==this.parent.numChildren-1}),s(r,"modal",function(){return this._modal},function(t){this._modal=t}),r.bringToFront=function(){this.root.bringToFront(this)},r.showModalWait=function(e){void 0===e&&(e=0),0!=e&&(this._requestingCmd=e),t.UIConfig.windowModalWaiting&&(this._modalWaitPane||(this._modalWaitPane=t.UIPackage.createObjectFromURL(t.UIConfig.windowModalWaiting)),this.layoutModalWaitPane(),this.addChild(this._modalWaitPane))},r.layoutModalWaitPane=function(){if(null!=this._contentArea){var t=this._frame.localToGlobal();t=this.globalToLocal(t.x,t.y,t),this._modalWaitPane.setXY(t.x+this._contentArea.x,t.y+this._contentArea.y),this._modalWaitPane.setSize(this._contentArea.width,this._contentArea.height)}else this._modalWaitPane.setSize(this.width,this.height)},r.closeModalWait=function(t){return void 0===t&&(t=0),0!=t&&this._requestingCmd!=t?!1:(this._requestingCmd=0,this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane),!0)},s(r,"modalWaiting",function(){return this._modalWaitPane&&null!=this._modalWaitPane.parent}),r.init=function(){if(!this._inited&&!this._loading)if(this._uiSources.length>0){this._loading=!1;for(var t=this._uiSources.length,e=0;t>e;e++){var i=this._uiSources[e];i.loaded||(i.load(this.__uiLoadComplete,this),this._loading=!0)}this._loading||this._init()}else this._init()},r.onInit=function(){},r.onShown=function(){},r.onHide=function(){},r.doShowAnimation=function(){this.onShown()},r.doHideAnimation=function(){this.hideImmediately()},r.__uiLoadComplete=function(){for(var t=this._uiSources.length,e=0;t>e;e++){var i=this._uiSources[e];if(!i.loaded)return}this._loading=!1,this._init()},r._init=function(){this._inited=!0,this.onInit(),this.isShowing&&this.doShowAnimation()},r.dispose=function(){this.displayObject.removeEventListener(egret.Event.ADDED_TO_STAGE,this.__onShown,this),this.displayObject.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.__onHidden,this),null!=this.parent&&this.hideImmediately(),e.prototype.dispose.call(this)},r.closeEventHandler=function(t){this.hide()},r.__onShown=function(t){this._inited?this.doShowAnimation():this.init()},r.__onHidden=function(t){this.closeModalWait(),this.onHide()},r.__mouseDown=function(t){this.isShowing&&this.bringToFontOnClick&&this.bringToFront()},r.__dragStart=function(t){t.preventDefault(),this.startDrag(t.touchPointID)},i}(t.GComponent);t.Window=e,egret.registerClass(e,"fairygui.Window")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(){this._agent=new t.GLoader,this._agent.draggable=!0,this._agent.touchable=!1,this._agent.setSize(100,100),this._agent.setPivot(.5,.5,!0),this._agent.align=t.AlignType.Center,this._agent.verticalAlign=t.VertAlignType.Middle,this._agent.sortingOrder=1e6,this._agent.addEventListener(t.DragEvent.DRAG_END,this.__dragEnd,this)}var i=__define,s=e,n=s.prototype;return i(e,"inst",function(){return null==e._inst&&(e._inst=new e),e._inst}),i(n,"dragAgent",function(){return this._agent}),i(n,"dragging",function(){return null!=this._agent.parent}),n.startDrag=function(e,i,s,n){if(void 0===n&&(n=-1),null==this._agent.parent){this._sourceData=s,this._agent.url=i,t.GRoot.inst.addChild(this._agent);var r=t.GRoot.inst.globalToLocal(t.GRoot.mouseX,t.GRoot.mouseY);this._agent.setXY(r.x,r.y),this._agent.startDrag(n)}},n.cancel=function(){null!=this._agent.parent&&(this._agent.stopDrag(),t.GRoot.inst.removeChild(this._agent),this._sourceData=null)},n.__dragEnd=function(e){if(null!=this._agent.parent){t.GRoot.inst.removeChild(this._agent);var i=this._sourceData;this._sourceData=null;for(var s=t.GRoot.inst.getObjectUnderPoint(e.stageX,e.stageY);null!=s;){if(s.hasEventListener(t.DropEvent.DROP)){var n=new t.DropEvent(t.DropEvent.DROP,i);return s.requestFocus(),void s.dispatchEvent(n)}s=s.parent}}},e}();t.DragDropManager=e,egret.registerClass(e,"fairygui.DragDropManager")}(fairygui||(fairygui={}));var fairygui;!function(t){var e=function(){function e(){this._itemList=new Array,this._objectPool=new Array}var i=(__define,e),s=i.prototype;return s.createObject=function(e,i){var s=t.UIPackage.getByName(e);if(!s)throw new Error("package not found: "+e);var n=s.getItemByName(i);if(!n)throw new Error("resource not found: "+i);this.internalCreateObject(n)},s.createObjectFromURL=function(e){var i=t.UIPackage.getItemByURL(e);if(!i)throw new Error("resource not found: "+e);this.internalCreateObject(i)},s.cancel=function(){t.GTimers.inst.remove(this.run,this),this._itemList.length=0;var e=this._objectPool.length;if(e>0){for(var i=0;e>i;i++)this._objectPool[i].dispose();this._objectPool.length=0}},s.internalCreateObject=function(e){this._itemList.length=0,this._objectPool.length=0,this.collectComponentChildren(e),this._itemList.push(new t.DisplayListItem(e,null)),this._index=0,t.GTimers.inst.add(1,0,this.run,this)},s.collectComponentChildren=function(e){e.owner.getItemAsset(e);for(var i=e.displayList.length,s=0;i>s;s++){var n=e.displayList[s];if(null!=n.packageItem&&n.packageItem.type==t.PackageItemType.Component)this.collectComponentChildren(n.packageItem);else if("list"==n.type){var r=null;n.listItemCount=0;for(var a=n.desc.childNodes,h=a.length,o=0;h>o;o++){var l=a[o];if("item"==l.name){var _=l.attributes.url;if(_||(null==r&&(r=n.desc.attributes.defaultItem),_=r)){var c=t.UIPackage.getItemByURL(_);c&&(c.type==t.PackageItemType.Component&&this.collectComponentChildren(c),this._itemList.push(new t.DisplayListItem(c,null)),n.listItemCount++)}}}}this._itemList.push(n)}},s.run=function(){for(var e,i,s,n,r=egret.getTimer(),a=t.UIConfig.frameTimeForAsyncUIConstruction,h=this._itemList.length;this._index<h;){if(i=this._itemList[this._index],null!=i.packageItem)e=t.UIObjectFactory.newObject(i.packageItem),e.packageItem=i.packageItem,this._objectPool.push(e),t.UIPackage._constructing++,i.packageItem.type==t.PackageItemType.Component?(s=this._objectPool.length-i.packageItem.displayList.length-1,e.constructFromResource2(this._objectPool,s),this._objectPool.splice(s,i.packageItem.displayList.length)):e.constructFromResource(),t.UIPackage._constructing--;else if(e=t.UIObjectFactory.newObject2(i.type),this._objectPool.push(e),"list"==i.type&&i.listItemCount>0){for(s=this._objectPool.length-i.listItemCount-1,n=0;n<i.listItemCount;n++)e.itemPool.returnObject(this._objectPool[n+s]);this._objectPool.splice(s,i.listItemCount)}if(this._index++,this._index%5==0&&egret.getTimer()-r>=a)return}t.GTimers.inst.remove(this.run,this);var o=this._objectPool[0];this._itemList.length=0,this._objectPool.length=0,null!=this.callback&&this.callback.call(this.callbackObj,o)},e}();t.AsyncOperation=e,egret.registerClass(e,"fairygui.AsyncOperation")}(fairygui||(fairygui={}));